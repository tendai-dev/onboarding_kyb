;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="175f996e-5f6d-730a-9fc4-dd68af856357")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,618566,(e,t,i)=>{t.exports=e.r(976562)},862873,e=>{"use strict";var t=e.i(843476),i=e.i(271645),r=e.i(618566);e.i(643983);var o=e.i(355569),s=e.i(111977),n=e.i(134590),a=e.i(179243),l=e.i(119192),d=e.i(307124),c=e.i(857692),p=e.i(194741),u=e.i(489312),g=e.i(357441),y=e.i(843011),h=e.i(617029);function m(){let e=(0,r.usePathname)(),m=(0,r.useRouter)(),{condensed:x,setCondensed:f}=(0,h.useSidebar)(),[b,F]=(0,i.useState)("dashboard");(0,i.useEffect)(()=>{"/dashboard"===e?F("dashboard"):e?.startsWith("/work-queue")?F("work-queue"):e?.startsWith("/applications")?F("applications"):e?.startsWith("/review")||e?.startsWith("/risk-review")||e?.startsWith("/approvals")?F("reviews"):e?.startsWith("/documents")?F("documents"):e?.startsWith("/requirements")?F("requirements"):e?.startsWith("/entity-types")?F("entity-types"):e?.startsWith("/checklists")?F("checklists"):e?.startsWith("/wizard-configurations")?F("wizard-configurations"):e?.startsWith("/rules-and-permissions")?F("rules-and-permissions"):e?.startsWith("/audit-log")?F("audit-log"):e?.startsWith("/messages")?F("messages"):e?.startsWith("/notifications")?F("notifications"):e?.startsWith("/data-migration")?F("data-migration"):e?.startsWith("/refreshes")?F("refreshes"):e?.startsWith("/reports")?F("reports"):e?.startsWith("/profile")?F("profile"):e?.startsWith("/settings")&&F("settings")},[e]);let v=(0,i.useMemo)(()=>[{id:"dashboard",label:"Dashboard",icon:(0,t.jsx)(s.ProductIcon,{width:"20",height:"20"}),onClick:()=>{F("dashboard"),m.push("/dashboard")}},{id:"work-queue",label:"Work Queue",icon:(0,t.jsx)(u.FilterIcon,{width:"20",height:"20"}),onClick:()=>{F("work-queue"),m.push("/work-queue")}},{id:"applications",label:"Applications",icon:(0,t.jsx)(c.AppIcon,{width:"20",height:"20"}),onClick:()=>{F("applications"),m.push("/applications")}},{id:"reviews",label:"Reviews",icon:(0,t.jsx)(a.DocumentIcon,{width:"20",height:"20"}),onClick:()=>{F("reviews"),m.push("/review")},subItems:[{id:"risk-review",label:"Risk Review",onClick:()=>{F("reviews"),m.push("/risk-review")}},{id:"approvals",label:"Approvals",onClick:()=>{F("reviews"),m.push("/approvals")}}]},{id:"documents",label:"Documents",icon:(0,t.jsx)(p.FileOpenIcon,{width:"20",height:"20"}),onClick:()=>{F("documents"),m.push("/documents")}},{id:"configuration",label:"Configuration",icon:(0,t.jsx)(l.SettingsIcon,{width:"20",height:"20"}),onClick:()=>{F("configuration"),m.push("/requirements")},subItems:[{id:"requirements",label:"Requirements",onClick:()=>{F("configuration"),m.push("/requirements")}},{id:"entity-types",label:"Entity Types",onClick:()=>{F("configuration"),m.push("/entity-types")}},{id:"checklists",label:"Checklists",onClick:()=>{F("configuration"),m.push("/checklists")}},{id:"wizard-configurations",label:"Wizard Configurations",onClick:()=>{F("configuration"),m.push("/wizard-configurations")}},{id:"rules-and-permissions",label:"Rules & Permissions",onClick:()=>{F("configuration"),m.push("/rules-and-permissions")}}]},{id:"system",label:"System",icon:(0,t.jsx)(g.WarningIcon,{width:"20",height:"20"}),onClick:()=>{F("system"),m.push("/audit-log")},subItems:[{id:"audit-log",label:"Audit Log",onClick:()=>{F("system"),m.push("/audit-log")}},{id:"messages",label:"Messages",onClick:()=>{F("system"),m.push("/messages")}},{id:"notifications",label:"Notifications",onClick:()=>{F("system"),m.push("/notifications")}},{id:"data-migration",label:"Data Migration",onClick:()=>{F("system"),m.push("/data-migration")}},{id:"refreshes",label:"Refreshes",onClick:()=>{F("system"),m.push("/refreshes")}}]},{id:"reports",label:"Reports",icon:(0,t.jsx)(a.DocumentIcon,{width:"20",height:"20"}),onClick:()=>{F("reports"),m.push("/reports")}},{id:"profile",label:"Profile",icon:(0,t.jsx)(n.UserIcon,{width:"20",height:"20"}),onClick:()=>{F("profile"),m.push("/profile")}}],[m]),q={id:"help-centre",label:"Help Centre",icon:(0,t.jsx)(d.HelpIcon,{width:"20",height:"20"}),onClick:()=>{console.log("Help Centre")}};return(0,t.jsx)(y.Box,{position:"fixed",left:"0",top:"0",height:"100vh",width:x?"72px":"280px",borderRight:"1px solid",borderColor:"rgba(55, 58, 54, 0.15)",zIndex:"1000",className:"sidebar-wrapper",bg:"#F9FAFB",overflowY:"auto",transition:"width 0.3s ease",children:(0,t.jsx)(o.PortalNavigationSidebar,{navigationItems:v,helpCentreItem:q,activeItemId:b,condensed:x,onToggleCollapse:f,onLogoClick:()=>{F("dashboard"),m.push("/dashboard")},expandedWidth:"280px",condensedWidth:"72px"})})}e.s(["default",()=>m])},297630,e=>{"use strict";let{withContext:t,PropsProvider:i}=(0,e.i(552887).createRecipeContext)({key:"container"}),r=t("div");e.s(["Container",()=>r])},891825,e=>{"use strict";var t=e.i(843476),i=e.i(271645),r=e.i(441305),o=e.i(95966),s=e.i(920755);let n=(0,i.forwardRef)(function(e,i){var n,a,l;let{columns:d,minChildWidth:c,...p}=e,u=(0,r.useChakraContext)(),g=c?(n=c,a=u,(0,o.mapObject)(n,e=>{let t=a.tokens.getVar(`sizes.${e}`,"number"==typeof e?`${e}px`:e);return null===e?null:`repeat(auto-fit, minmax(${t}, 1fr))`})):(l=d,(0,o.mapObject)(l,e=>null===e?null:`repeat(${e}, minmax(0, 1fr))`));return(0,t.jsx)(s.Grid,{ref:i,templateColumns:g,...p})});e.s(["SimpleGrid",()=>n])},778497,e=>{"use strict";var t=e.i(967079);let i=new class{isDevelopment=!1;isProduction=!0;debug(e,...t){this.isDevelopment&&console.debug(`[DEBUG] ${e}`,...t)}info(e,...i){this.isDevelopment&&console.info(`[INFO] ${e}`,...i),this.isProduction&&(0,t.addBreadcrumb)(e,"info","info",{args:i})}warn(e,i){console.warn(`[WARN] ${e}`),this.isProduction&&(0,t.reportWarning)(e,{tags:i?.tags,extra:i?.extra})}error(e,i,r){let o=i||(e instanceof Error?e.message:String(e));console.error(`[ERROR] ${o}`,e);let s=r?.level==="warn"?"warning":r?.level==="error"?"error":r?.level==="info"?"info":"error";(0,t.reportError)(e,{tags:r?.tags,extra:r?.extra,level:s})}log(e,i,r="info"){if(this.isDevelopment&&console.log(`[${r.toUpperCase()}] ${e}`,i||""),this.isProduction&&"debug"!==r){let o="warn"===r?"warning":"error"===r?"error":"info";(0,t.addBreadcrumb)(e,"log",o,i)}}};e.s(["logger",0,i])},337880,e=>{"use strict";e.i(247167).default.env.NEXT_PUBLIC_ENTITY_CONFIG_API_BASE_URL;let t=new class{async getAuthHeaders(){let t={"Content-Type":"application/json"};try{let e=await fetch("/api/auth/session"),i=await e.json();i?.user?.email&&(t["X-User-Email"]=i.user.email),i?.user?.name&&(t["X-User-Name"]=i.user.name)}catch(t){{let{clientSentry:i}=await e.A(661405);i.reportError(t,{tags:{error_type:"entity_config_api",operation:"get_session"},level:"warning"})}}return t}async request(e,t){let i,r;e.startsWith("/requirements")?(i="/api/requirements",r=""):(e.startsWith("/wizardconfigurations")||e.startsWith("/entity-types"),i="/api/rules-and-permissions",r=e);let o=`${i}${r}`,s=await this.getAuthHeaders();try{let e=new Promise((e,t)=>{setTimeout(()=>t(Error("Request timeout")),1e4)}),i=fetch(o,{...t,headers:{...s,...t?.headers}}),r=await Promise.race([i,e]);if(!r.ok){let e=await r.text(),t=`Entity Config API request failed: ${r.status} ${r.statusText}`;try{let i=JSON.parse(e);i.message?t=i.message:i.error&&(t=i.error)}catch{e&&e.trim().length>0&&(t=e.length>200?e.substring(0,200)+"...":e)}throw Error(t)}if(204===r.status)return null;return r.json()}catch(e){if(e instanceof TypeError||e instanceof Error&&e.message.includes("timeout"))throw Error("Unable to connect to Entity Configuration service");throw e}}async getEntityTypes(e=!1,t=!0){let i=new URLSearchParams;e&&i.append("includeInactive","true"),t&&i.append("includeRequirements","true");let r=i.toString();return(await this.request(`/entity-types${r?`?${r}`:""}`)).map(e=>{let t=e.requirements||e.Requirements||[];return Array.isArray(t)&&t.length>0&&(t=t.map(e=>({id:e.id||e.Id,requirementId:e.requirementId||e.RequirementId||e.requirement_id,isRequired:void 0!==e.isRequired?e.isRequired:void 0!==e.IsRequired?e.IsRequired:void 0!==e.is_required&&e.is_required,displayOrder:e.displayOrder||e.DisplayOrder||e.display_order||0,requirement:e.requirement||e.Requirement}))),{id:e.id||e.Id,code:e.code||e.Code,displayName:e.displayName||e.DisplayName||e.display_name||e.code||"Unnamed",description:e.description||e.Description||e.description||"",icon:e.icon||e.Icon,isActive:void 0!==e.isActive?e.isActive:void 0!==e.IsActive?e.IsActive:void 0===e.is_active||e.is_active,createdAt:e.createdAt||e.CreatedAt||e.created_at||"",updatedAt:e.updatedAt||e.UpdatedAt||e.updated_at||"",requirements:t}})}async getEntityType(e,t=!0){let i=t?`/entity-types/${e}?includeRequirements=true`:`/entity-types/${e}`;return this.request(i)}async getEntityTypeByCode(t,i=!0){let r=t.trim();console.log("[EntityConfigAPI] Fetching entity type by code (as-is from application):",r);try{let e=await this.request(`/entity-types/by-code/${encodeURIComponent(r)}`);return console.log("[EntityConfigAPI] ✅ Successfully fetched entity type:",e?.code),e}catch(t){{let{clientSentry:i}=await e.A(661405);i.reportError(t,{tags:{error_type:"entity_config_api",operation:"fetch_entity_type_by_code"},extra:{code:r},level:"error"})}return null}}async createEntityType(e){return this.request("/entity-types",{method:"POST",body:JSON.stringify(e)})}async updateEntityType(e,t){return this.request(`/entity-types/${e}`,{method:"PUT",body:JSON.stringify(t)})}async deleteEntityType(e){return this.request(`/entity-types/${e}`,{method:"DELETE"})}async getRequirements(e=!1){return(await this.request(`/requirements${e?"?includeInactive=true":""}`)).map(e=>({id:e.id||e.Id,code:e.code||e.Code,displayName:e.displayName||e.DisplayName||e.display_name||e.code||"Unnamed",description:e.description||e.Description||e.description||"",type:e.type||e.Type||e.type||"",fieldType:e.fieldType||e.FieldType||e.field_type||"",validationRules:e.validationRules||e.ValidationRules||e.validation_rules,helpText:e.helpText||e.HelpText||e.help_text,isActive:void 0!==e.isActive?e.isActive:void 0!==e.IsActive?e.IsActive:void 0===e.is_active||e.is_active,createdAt:e.createdAt||e.CreatedAt||e.created_at||"",updatedAt:e.updatedAt||e.UpdatedAt||e.updated_at||"",options:e.options||e.Options||[]}))}async getRequirement(e){return this.request(`/requirements/${e}`)}async createRequirement(e){return this.request("/requirements",{method:"POST",body:JSON.stringify(e)})}async updateRequirement(e,t){return this.request(`/requirements/${e}`,{method:"PUT",body:JSON.stringify(t)})}async deleteRequirement(e){return this.request(`/requirements/${e}`,{method:"DELETE"})}async getRequirementsMetadata(){return this.request("/requirements/metadata")}async getRequirementOptions(e){return this.request(`/requirements/${e}/options`)}async addRequirementOption(e,t){return this.request(`/requirements/${e}/options`,{method:"POST",body:JSON.stringify(t)})}async updateRequirementOption(e,t,i){return this.request(`/requirements/${e}/options/${t}`,{method:"PUT",body:JSON.stringify(i)})}async deleteRequirementOption(e,t){return this.request(`/requirements/${e}/options/${t}`,{method:"DELETE"})}async addRequirementToEntityType(e,t){return this.request(`/entity-types/${e}/requirements`,{method:"POST",body:JSON.stringify(t)})}async removeRequirementFromEntityType(e,t){return this.request(`/entity-types/${e}/requirements/${t}`,{method:"DELETE"})}async getWizardConfigurations(e=!1){return(await this.request(`/wizardconfigurations${e?"?includeInactive=true":""}`)).map(e=>({id:e.id,entityTypeId:e.entity_type_id||e.entityTypeId,entityTypeDisplayName:e.entity_type_display_name||e.entityTypeDisplayName,isActive:void 0!==e.is_active?e.is_active:e.isActive,createdAt:e.created_at||e.createdAt,updatedAt:e.updated_at||e.updatedAt,steps:(e.steps||[]).map(e=>({id:e.id,title:e.title,subtitle:e.subtitle,requirementTypes:e.requirement_types||e.requirementTypes||[],checklistCategory:e.checklist_category||e.checklistCategory||"",stepNumber:e.step_number||e.stepNumber||0,isActive:void 0!==e.is_active?e.is_active:e.isActive}))}))}async getWizardConfiguration(e){let t=await this.request(`/wizardconfigurations/${e}`);return{id:t.id,entityTypeId:t.entity_type_id||t.entityTypeId,entityTypeDisplayName:t.entity_type_display_name||t.entityTypeDisplayName,isActive:void 0!==t.is_active?t.is_active:t.isActive,createdAt:t.created_at||t.createdAt,updatedAt:t.updated_at||t.updatedAt,steps:(t.steps||[]).map(e=>({id:e.id,title:e.title,subtitle:e.subtitle,requirementTypes:e.requirement_types||e.requirementTypes||[],checklistCategory:e.checklist_category||e.checklistCategory||"",stepNumber:e.step_number||e.stepNumber||0,isActive:void 0!==e.is_active?e.is_active:e.isActive}))}}async getWizardConfigurationByEntityType(t){try{return this.request(`/wizardconfigurations/by-entity-type/${t}`)}catch(i){{let{clientSentry:r}=await e.A(661405);r.reportError(i,{tags:{error_type:"entity_config_api",operation:"fetch_wizard_config"},extra:{entityTypeId:t},level:"error"})}return null}}async createWizardConfiguration(e){return this.request("/wizardconfigurations",{method:"POST",body:JSON.stringify(e)})}async updateWizardConfiguration(e,t){return this.request(`/wizardconfigurations/${e}`,{method:"PUT",body:JSON.stringify(t)})}async deleteWizardConfiguration(e){return this.request(`/wizardconfigurations/${e}`,{method:"DELETE"})}};e.s(["FieldType",0,{Text:"Text",Email:"Email",Phone:"Phone",Number:"Number",Date:"Date",Select:"Select",MultiSelect:"MultiSelect",Radio:"Radio",Checkbox:"Checkbox",Textarea:"Textarea",File:"File",Country:"Country",Currency:"Currency",Address:"Address"},"RequirementType",0,{Information:1,Document:2,ProofOfIdentity:3,ProofOfAddress:4,OwnershipStructure:5,BoardDirectors:6,AuthorizedSignatories:7},"entityConfigApiService",0,t])},948170,e=>{"use strict";var t=e.i(843476),i=e.i(843011),r=e.i(297630),o=e.i(53545),s=e.i(361035),n=e.i(880572),a=e.i(761869),l=e.i(857557),d=e.i(300713),c=e.i(891825),p=e.i(152602);e.i(643983);var u=e.i(554646),g=e.i(191348),y=e.i(44999),h=e.i(927561),m=e.i(419511),x=e.i(192199),f=e.i(862873),b=e.i(271645),F=e.i(618566),v=e.i(337880),q=e.i(778497);function C({requirementId:e,requirementDisplayName:r,requirementDescription:n,isChecked:a,stepIndex:l,onToggle:d}){let c=t=>{let i=t?.checked===!0||!0===t;q.logger.debug("RequirementCheckbox handleChange",{requirementId:e,stepIndex:l,checked:i,isChecked:a,hasDetails:!!t}),d()};return(0,t.jsx)(i.Box,{w:"100%",py:"1",position:"relative","data-requirement-id":e,"data-step-index":l,style:{position:"relative",zIndex:1,isolation:"isolate",cursor:"pointer"},onClick:t=>{t.stopPropagation(),q.logger.debug("Box clicked",{requirementId:e,stepIndex:l}),c({checked:!a})},children:(0,t.jsxs)(s.HStack,{gap:"3",align:"flex-start",children:[(0,t.jsx)(i.Box,{onClick:e=>{e.stopPropagation()},style:{flexShrink:0,paddingTop:"2px"},children:(0,t.jsx)(p.Checkbox.Root,{checked:a,onCheckedChange:c,id:`checkbox-${e}-${l}`,name:`checkbox-${e}-${l}`,value:e,style:{cursor:"pointer"},children:(0,t.jsx)(p.Checkbox.Control,{style:{backgroundColor:a?"#F05423":"white",borderColor:a?"#F05423":"#D1D5DB",borderWidth:"2px",width:"20px",height:"20px",borderRadius:"4px",cursor:"pointer"},children:(0,t.jsx)(p.Checkbox.Indicator,{style:{color:"white",fontSize:"14px",fontWeight:"bold"},children:"✓"})})})}),(0,t.jsxs)(o.VStack,{align:"start",gap:"0",flex:"1",onClick:t=>{t.stopPropagation(),q.logger.debug("Text area clicked",{requirementId:e,stepIndex:l}),c({checked:!a})},style:{cursor:"pointer",minWidth:0},children:[(0,t.jsx)(u.Typography,{fontSize:"sm",fontWeight:"600",color:"#111827",style:{color:"#111827",lineHeight:"20px"},children:r}),n&&(0,t.jsx)(u.Typography,{fontSize:"xs",color:"#6B7280",fontWeight:"400",style:{color:"#6B7280"},mt:"1",children:n})]})]})})}function j(){let e=(0,F.useRouter)(),[p,q]=(0,b.useState)({entityTypeId:"",isActive:!0}),[j,T]=(0,b.useState)([{title:"",subtitle:"",requirementTypes:[],requirementIds:[],checklistCategory:"",stepNumber:1,isActive:!0}]),[w,S]=(0,b.useState)([]),[A,k]=(0,b.useState)(null),[I,R]=(0,b.useState)(null),[W,_]=(0,b.useState)([]),[B,z]=(0,b.useState)(!0),[E,N]=(0,b.useState)(!1),[$,D]=(0,b.useState)(null);(0,b.useEffect)(()=>{P()},[]),(0,b.useEffect)(()=>{console.log("useEffect triggered - entityTypeId:",p.entityTypeId),p.entityTypeId?(console.log("Loading requirements for entity type:",p.entityTypeId),O(p.entityTypeId)):(console.log("No entity type selected, clearing requirements"),R(null),_([]))},[p.entityTypeId]);let P=async()=>{try{z(!0);let[e,t]=await Promise.all([v.entityConfigApiService.getEntityTypes(!1,!1),v.entityConfigApiService.getRequirementsMetadata()]);S(e),k(t),console.log("Loaded entity types:",e.length,e),e.length>0&&(console.log("First entity type structure:",e[0]),console.log("First entity type displayName:",e[0].displayName),console.log("First entity type keys:",Object.keys(e[0])))}catch(e){D(e instanceof Error?e.message:"Failed to load data"),console.error("Error loading data:",e)}finally{z(!1)}},O=async e=>{try{console.log("Loading requirements for entity type ID:",e);let t=await v.entityConfigApiService.getEntityTypes(!1,!0);console.log("All entity types with requirements:",t.length);let i=t.find(t=>t.id===e||t.id?.toString()===e?.toString());if(i||(i=t.find(t=>t.id?.toLowerCase()===e?.toLowerCase()||t.id?.replace(/-/g,"")===e?.replace(/-/g,""))),console.log("Found entity type:",i?i.displayName:"NOT FOUND"),console.log("Entity type requirements:",i?.requirements?.length||0),i)if(R(i),console.log("Entity type requirements structure:",JSON.stringify(i.requirements,null,2)),i.requirements&&i.requirements.length>0){let e=i.requirements.map(e=>{let t=e.requirementId||e.RequirementId||e.requirement_id||e.requirement?.id||e.Requirement?.Id||e.id||e.Id;return console.log("Extracted requirement ID:",t,"from:",e),t}).filter(Boolean);console.log("Requirement IDs to fetch:",e);let t=await v.entityConfigApiService.getRequirements(!1);console.log("All available requirements:",t.length),console.log("Sample requirement IDs:",t.slice(0,3).map(e=>e.id));let r=t.filter(t=>e.some(e=>{let i=t.id?.toString()||"",r=e?.toString()||"";return i===r||i.toLowerCase()===r.toLowerCase()||i.replace(/-/g,"")===r.replace(/-/g,"")}));console.log("Filtered entity requirements:",r.length),console.log("Matched requirements:",r.map(e=>({id:e.id,name:e.displayName}))),0===r.length&&e.length>0&&(console.error("⚠️ Requirements not found!"),console.error("Looking for IDs:",e),console.error("Available requirement IDs:",t.map(e=>e.id))),_(r)}else console.log("No requirements found for this entity type"),_([]);else console.error("Entity type not found for ID:",e),R(null),_([])}catch(e){console.error("Error loading entity type requirements:",e),R(null),_([])}},L=(e,t)=>{T(i=>{let r=[...i],o="up"===t?e-1:e+1;return o<0||o>=r.length?i:([r[e],r[o]]=[r[o],r[e]],r.map((e,t)=>({...e,stepNumber:t+1})))})},U=(e,t,i)=>{T(r=>r.map((r,o)=>o===e?{...r,[t]:i}:r))},H=(0,b.useCallback)((e,t)=>{console.log("=== toggleRequirement START ==="),console.log("toggleRequirement called:",{stepIndex:e,requirementId:t,timestamp:Date.now()}),T(i=>(console.log("Current steps state:",i.map(e=>({stepNumber:e.stepNumber,requirementIds:e.requirementIds}))),i.map((i,r)=>{let o,s;if(r!==e)return i;let n=W.find(e=>e.id===t);if(!n)return console.warn("Requirement not found:",t),i;let a=i.requirementIds.includes(t);return console.log("Requirement selection state:",{requirementId:t,isSelected:a,currentIds:i.requirementIds}),a?(o=i.requirementIds.filter(e=>e!==t),s=0===W.filter(e=>e.type===n.type&&e.id!==t&&o.includes(e.id)).length?i.requirementTypes.filter(e=>e!==n.type):i.requirementTypes):(o=[...i.requirementIds,t],s=i.requirementTypes.includes(n.type)?i.requirementTypes:[...i.requirementTypes,n.type]),console.log("Updated requirement IDs:",o),{...i,requirementIds:o,requirementTypes:s}})))},[W]),V=async()=>{if(D(null),!p.entityTypeId)return void D("Please select an entity type");if(0===j.length)return void D("Please add at least one step");for(let e=0;e<j.length;e++){let t=j[e];if(!t.title||!t.title.trim())return void D(`Step ${e+1}: Title is required`);if(!t.subtitle||!t.subtitle.trim())return void D(`Step ${e+1}: Subtitle is required`);if(0===t.requirementIds.length)return void D(`Step ${e+1}: Please select at least one requirement`)}try{N(!0),D(null);let t={entityTypeId:p.entityTypeId,isActive:p.isActive,steps:j.map(e=>({title:e.title.trim(),subtitle:e.subtitle.trim(),requirementTypes:e.requirementTypes,checklistCategory:e.checklistCategory.trim()||"",stepNumber:e.stepNumber,isActive:e.isActive}))};console.log("Creating wizard configuration with payload:",JSON.stringify(t,null,2));let i=await v.entityConfigApiService.createWizardConfiguration(t);console.log("Wizard configuration created successfully:",i),e.push("/wizard-configurations")}catch(t){let e="Failed to create wizard configuration";t instanceof Error||t?.message?e=t.message:"string"==typeof t&&(e=t),D(e),console.error("Error creating wizard configuration:",t),window.scrollTo({top:0,behavior:"smooth"})}finally{N(!1)}};if(B)return(0,t.jsxs)(a.Flex,{minH:"100vh",bg:"gray.50",children:[(0,t.jsx)(f.default,{}),(0,t.jsx)(i.Box,{flex:"1",ml:"280px",display:"flex",alignItems:"center",justifyContent:"center",children:(0,t.jsxs)(o.VStack,{gap:"4",children:[(0,t.jsx)(d.Spinner,{size:"xl",color:"orange.500"}),(0,t.jsx)(u.Typography,{color:"gray.600",children:"Loading form..."})]})})]});let J=["Basic Information","Business Details","Legal Documents","Financial Information","Ownership Structure","Compliance","Additional Documents"];return(0,t.jsxs)(a.Flex,{minH:"100vh",bg:"gray.50",children:[(0,t.jsx)(f.default,{}),(0,t.jsxs)(i.Box,{flex:"1",ml:"280px",children:[(0,t.jsx)(i.Box,{bg:"linear-gradient(135deg, #FFF5F0 0%, #FFFFFF 100%)",borderBottom:"1px",borderColor:"gray.200",py:"8",boxShadow:"0 1px 3px rgba(0,0,0,0.05)",children:(0,t.jsx)(r.Container,{maxW:"95%",px:"8",children:(0,t.jsxs)(o.VStack,{align:"start",gap:"2",children:[(0,t.jsx)(u.Typography,{as:"h1",fontSize:"4xl",fontWeight:"800",color:"#111827",style:{color:"#111827",letterSpacing:"-0.5px"},children:"Create Wizard Configuration"}),(0,t.jsx)(u.Typography,{color:"#6B7280",fontSize:"md",fontWeight:"400",style:{color:"#6B7280"},children:"Configure a multi-step wizard for entity type applications"})]})})}),$&&(0,t.jsx)(r.Container,{maxW:"95%",px:"8",py:"4",children:(0,t.jsx)(h.AlertBar,{status:"error",title:"Error!",description:$})}),(0,t.jsx)(r.Container,{maxW:"95%",px:"8",py:"8",children:(0,t.jsxs)(o.VStack,{gap:"6",align:"stretch",children:[(0,t.jsx)(i.Box,{bg:"white",borderRadius:"xl",border:"1px",borderColor:"gray.100",p:"8",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)",position:"relative",className:"basic-information-section",_hover:{boxShadow:"0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)"},transition:"all 0.3s ease",_before:{content:'""',position:"absolute",left:0,top:0,bottom:0,width:"5px",bg:"linear-gradient(180deg, #F05423 0%, #FF6B35 100%)",borderTopLeftRadius:"xl",borderBottomLeftRadius:"xl"},children:(0,t.jsxs)(o.VStack,{align:"stretch",gap:"6",children:[(0,t.jsxs)(i.Box,{children:[(0,t.jsx)(u.Typography,{fontSize:"lg",fontWeight:"700",color:"#111827",textTransform:"uppercase",letterSpacing:"1px",style:{color:"#111827"},mb:"1",children:"Basic Information"}),(0,t.jsx)(i.Box,{h:"3px",w:"60px",bg:"linear-gradient(90deg, #F05423 0%, #FF6B35 100%)",borderRadius:"full"})]}),(0,t.jsx)(i.Box,{className:"mukuru-dropdown-wrapper",children:B?(0,t.jsx)(i.Box,{children:(0,t.jsx)(u.Typography,{color:"#111827",style:{color:"#111827"},children:"Loading entity types..."})}):0===w.length?(0,t.jsx)(i.Box,{children:(0,t.jsx)(u.Typography,{color:"red.500",style:{color:"#DC2626"},children:"No entity types available. Please check the backend connection."})}):(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(m.Dropdown,{label:"Entity Type",placeholder:"Select an entity type",helpText:"Please select the entity type for this wizard configuration",items:w.map(e=>({label:e.displayName||e.code||"Unnamed",value:e.id||""})),defaultValue:p.entityTypeId||void 0,onSelectionChange:e=>{console.log("Entity type selected:",e),console.log("Selected entity type object:",w.find(t=>t.id===e)),q(t=>({...t,entityTypeId:e||""})),e&&setTimeout(()=>{O(e)},100)}},`entity-dropdown-${p.entityTypeId||"none"}`)})}),(0,t.jsxs)(s.HStack,{justify:"space-between",align:"center",pt:"4",borderTop:"1px",borderColor:"gray.100",bg:"gray.50",p:"4",borderRadius:"lg",mt:"2",children:[(0,t.jsxs)(o.VStack,{align:"start",gap:"0",children:[(0,t.jsx)(u.Typography,{fontSize:"sm",fontWeight:"600",color:"#111827",style:{color:"#111827"},children:"Configuration Status"}),(0,t.jsx)(u.Typography,{fontSize:"xs",color:"#6B7280",style:{color:"#6B7280"},children:"Make this wizard available for use"})]}),(0,t.jsx)(g.Button,{onClick:()=>q(e=>({...e,isActive:!e.isActive})),variant:p.isActive?"primary":"secondary",size:"sm",fontWeight:"600",style:{backgroundColor:p.isActive?"#F05423":"transparent",borderColor:(p.isActive,"#F05423"),color:p.isActive?"#FFFFFF":"#F05423",display:"flex",alignItems:"center",justifyContent:"center",textAlign:"center",padding:"8px 16px",minWidth:"auto"},children:(0,t.jsx)(u.Typography,{as:"span",fontWeight:"600",className:p.isActive?"active-button-text":"",style:{color:p.isActive?"#FFFFFF":"#F05423",WebkitTextFillColor:p.isActive?"#FFFFFF":"#F05423",textAlign:"center"},children:p.isActive?"Active":"Inactive"})})]})]})}),(0,t.jsx)(i.Box,{bg:"white",borderRadius:"xl",border:"1px",borderColor:"gray.100",p:"8",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)",position:"relative",_hover:{boxShadow:"0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)"},transition:"all 0.3s ease",_before:{content:'""',position:"absolute",left:0,top:0,bottom:0,width:"5px",bg:"linear-gradient(180deg, #F05423 0%, #FF6B35 100%)",borderTopLeftRadius:"xl",borderBottomLeftRadius:"xl"},children:(0,t.jsxs)(o.VStack,{align:"stretch",gap:"6",children:[(0,t.jsxs)(s.HStack,{justify:"space-between",align:"center",mb:"2",children:[(0,t.jsxs)(i.Box,{children:[(0,t.jsx)(u.Typography,{fontSize:"lg",fontWeight:"700",color:"#111827",textTransform:"uppercase",letterSpacing:"1px",style:{color:"#111827"},mb:"1",children:"Wizard Steps"}),(0,t.jsx)(i.Box,{h:"3px",w:"60px",bg:"linear-gradient(90deg, #F05423 0%, #FF6B35 100%)",borderRadius:"full"})]}),(0,t.jsxs)(g.Button,{onClick:()=>{T(e=>[...e,{title:"",subtitle:"",requirementTypes:[],requirementIds:[],checklistCategory:"",stepNumber:e.length+1,isActive:!0}])},size:"md",variant:"primary",fontWeight:"600",style:{backgroundColor:"#F05423",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",textAlign:"center"},children:[(0,t.jsx)(y.IconWrapper,{style:{color:"#FFFFFF",fill:"#FFFFFF"},children:(0,t.jsx)(x.FiPlus,{size:18,style:{color:"#FFFFFF",fill:"#FFFFFF"}})}),(0,t.jsx)(u.Typography,{as:"span",fontWeight:"600",style:{color:"#FFFFFF",WebkitTextFillColor:"#FFFFFF",textAlign:"center"},children:"Add Step"})]})]}),j.map((e,r)=>(0,t.jsx)(i.Box,{border:"1px",borderColor:"gray.100",borderRadius:"xl",p:"8",bg:"white",boxShadow:"0 2px 4px rgba(0,0,0,0.05)",position:"relative",_hover:{boxShadow:"0 8px 16px rgba(0,0,0,0.1)",borderColor:"#F05423",transform:"translateY(-2px)"},transition:"all 0.3s ease",mb:"6",children:(0,t.jsxs)(o.VStack,{align:"stretch",gap:"6",children:[(0,t.jsxs)(s.HStack,{justify:"space-between",align:"center",mb:"2",children:[(0,t.jsxs)(s.HStack,{gap:"3",align:"center",children:[(0,t.jsxs)(i.Box,{bg:"linear-gradient(135deg, #F05423 0%, #FF6B35 100%)",color:"white",fontWeight:"700",px:"5",py:"2",borderRadius:"lg",fontSize:"13px",letterSpacing:"0.5px",boxShadow:"0 2px 4px rgba(240, 84, 35, 0.3)",children:["Step ",e.stepNumber]}),e.title&&(0,t.jsx)(u.Typography,{fontSize:"md",fontWeight:"600",color:"#111827",style:{color:"#111827"},children:e.title})]}),(0,t.jsxs)(s.HStack,{gap:"2",children:[(0,t.jsx)(g.Button,{size:"sm",variant:"ghost",onClick:()=>L(r,"up"),disabled:0===r,_hover:{bg:"orange.50",transform:"scale(1.1)"},_disabled:{opacity:.3,cursor:"not-allowed"},borderRadius:"md",transition:"all 0.2s",children:(0,t.jsx)(y.IconWrapper,{color:"orange.500",children:(0,t.jsx)(x.FiArrowUp,{size:18})})}),(0,t.jsx)(g.Button,{size:"sm",variant:"ghost",onClick:()=>L(r,"down"),disabled:r===j.length-1,_hover:{bg:"orange.50",transform:"scale(1.1)"},_disabled:{opacity:.3,cursor:"not-allowed"},borderRadius:"md",transition:"all 0.2s",children:(0,t.jsx)(y.IconWrapper,{color:"orange.500",children:(0,t.jsx)(x.FiArrowDown,{size:18})})}),j.length>1&&(0,t.jsx)(g.Button,{size:"sm",variant:"ghost",onClick:()=>{T(e=>e.filter((e,t)=>t!==r).map((e,t)=>({...e,stepNumber:t+1})))},_hover:{bg:"red.50",transform:"scale(1.1)"},borderRadius:"md",transition:"all 0.2s",children:(0,t.jsx)(y.IconWrapper,{color:"red.500",children:(0,t.jsx)(x.FiTrash2,{size:18})})})]})]}),(0,t.jsxs)(c.SimpleGrid,{columns:2,gap:"4",children:[(0,t.jsxs)(l.Field.Root,{children:[(0,t.jsx)(l.Field.Label,{fontSize:"sm",fontWeight:"600",color:"#111827",mb:"2",style:{color:"#111827"},children:"Title *"}),(0,t.jsx)(n.Input,{value:e.title,onChange:e=>U(r,"title",e.target.value),placeholder:"e.g., Business Information",bg:"white",borderColor:"gray.200",color:"#111827",fontWeight:"500",borderRadius:"lg",h:"44px",_focus:{borderColor:"#F05423",boxShadow:"0 0 0 3px rgba(240, 84, 35, 0.1)"},_placeholder:{color:"gray.400"},_hover:{borderColor:"gray.300"},transition:"all 0.2s",required:!0})]}),(0,t.jsxs)(l.Field.Root,{children:[(0,t.jsx)(l.Field.Label,{fontSize:"sm",fontWeight:"600",color:"#111827",mb:"2",style:{color:"#111827"},children:"Subtitle *"}),(0,t.jsx)(n.Input,{value:e.subtitle,onChange:e=>U(r,"subtitle",e.target.value),placeholder:"e.g., Enter your business details",bg:"white",borderColor:"gray.200",color:"#111827",fontWeight:"500",borderRadius:"lg",h:"44px",_focus:{borderColor:"#F05423",boxShadow:"0 0 0 3px rgba(240, 84, 35, 0.1)"},_placeholder:{color:"gray.400"},_hover:{borderColor:"gray.300"},transition:"all 0.2s",required:!0})]})]}),(0,t.jsx)(i.Box,{className:"mukuru-dropdown-wrapper",style:{color:"#111827"},children:(0,t.jsx)(m.Dropdown,{label:"Checklist Category",placeholder:"Select category (optional)",items:J.map(e=>({label:e,value:e})),defaultValue:e.checklistCategory||void 0,onSelectionChange:e=>{U(r,"checklistCategory",e||"")}})}),(0,t.jsxs)(l.Field.Root,{children:[(0,t.jsx)(l.Field.Label,{fontSize:"sm",fontWeight:"bold",color:"#111827",mb:"3",style:{color:"#111827"},children:"Requirements * (Select individual requirements)"}),I?0===W.length?(0,t.jsx)(i.Box,{bg:"gray.50",border:"1px",borderColor:"gray.300",borderRadius:"lg",p:"4",children:(0,t.jsx)(u.Typography,{fontSize:"sm",color:"#6B7280",fontWeight:"500",textAlign:"center",style:{color:"#6B7280"},children:"No requirements configured for this entity type yet"})}):(0,t.jsx)(i.Box,{bg:"white",border:"1px",borderColor:"gray.100",borderRadius:"xl",p:"6",maxH:"450px",overflowY:"auto",boxShadow:"0 2px 4px rgba(0,0,0,0.05)",_hover:{borderColor:"gray.200"},transition:"all 0.2s",children:(()=>{let s=new Set;for(let e=0;e<r;e++)j[e].requirementIds.forEach(e=>s.add(e));let n=W.filter(e=>!s.has(e.id)),a={};return(n.forEach(e=>{let t=e.type||"Other";a[t]||(a[t]=[]),a[t].push(e)}),0===n.length)?(0,t.jsx)(i.Box,{bg:"gray.50",border:"1px",borderColor:"gray.200",borderRadius:"lg",p:"4",textAlign:"center",children:(0,t.jsx)(u.Typography,{fontSize:"sm",color:"#6B7280",fontWeight:"500",style:{color:"#6B7280"},children:"All available requirements have been selected in previous steps"})}):(0,t.jsx)(o.VStack,{align:"stretch",gap:"4",children:Object.entries(a).map(([s,n])=>(0,t.jsxs)(i.Box,{border:"1px",borderColor:"gray.100",borderRadius:"xl",p:"5",bg:"linear-gradient(135deg, #F9FAFB 0%, #FFFFFF 100%)",_hover:{bg:"linear-gradient(135deg, #FFF5F0 0%, #FFFFFF 100%)",borderColor:"#F05423",transform:"translateY(-1px)",boxShadow:"0 4px 6px rgba(0,0,0,0.05)"},transition:"all 0.3s ease",mb:"3",children:[(0,t.jsx)(u.Typography,{fontSize:"xs",fontWeight:"700",color:"#F05423",mb:"4",style:{color:"#F05423",textTransform:"uppercase",letterSpacing:"1px"},children:s.replace(/_/g," ")}),(0,t.jsx)(o.VStack,{align:"stretch",gap:"3",children:n.map((i,o)=>{let s=String(i.id),n=Number(r),a=e.requirementIds.includes(s),l=i.displayName||i.code||"Unnamed",d=i.description||"";return(0,t.jsx)(C,{requirementId:s,requirementDisplayName:l,requirementDescription:d,isChecked:a,stepIndex:n,onToggle:()=>{console.log("=== handleToggle START ==="),console.log("reqId:",s,"type:",typeof s),console.log("stepIdx:",n,"type:",typeof n),console.log("reqIdx:",o),console.log("req object:",{id:i.id,displayName:i.displayName,code:i.code,description:i.description,fullReq:i}),console.log("Calling toggleRequirement with:",{stepIdx:n,reqId:s}),H(n,s),console.log("=== handleToggle END ===")}},`req-${s}-step-${n}-idx-${o}`)})})]},s))},`requirements-list-${r}`)})()}):(0,t.jsx)(i.Box,{bg:"gray.50",border:"1px",borderColor:"gray.300",borderRadius:"lg",p:"4",children:(0,t.jsx)(u.Typography,{fontSize:"sm",color:"#6B7280",fontWeight:"500",textAlign:"center",style:{color:"#6B7280"},children:"Please select an entity type first to see available requirements"})}),e.requirementIds.length>0&&(0,t.jsxs)(u.Typography,{fontSize:"xs",color:"#6B7280",fontWeight:"500",mt:"3",style:{color:"#6B7280"},children:[e.requirementIds.length," requirement",1!==e.requirementIds.length?"s":""," selected"]})]}),(0,t.jsxs)(l.Field.Root,{children:[(0,t.jsx)(l.Field.Label,{fontSize:"sm",fontWeight:"bold",color:"#111827",mb:"2",style:{color:"#111827"},children:"Requirement Types (Auto-selected based on requirements above)"}),(0,t.jsx)(i.Box,{bg:"linear-gradient(135deg, #F9FAFB 0%, #FFFFFF 100%)",border:"1px",borderColor:"gray.100",borderRadius:"xl",p:"5",_hover:{borderColor:"#F05423",transform:"translateY(-1px)"},transition:"all 0.3s ease",children:e.requirementTypes.length>0?(0,t.jsx)(s.HStack,{gap:"2",flexWrap:"wrap",children:e.requirementTypes.map(e=>(0,t.jsx)(i.Box,{bg:"linear-gradient(135deg, #F05423 0%, #FF6B35 100%)",color:"white",fontWeight:"600",px:"4",py:"2",borderRadius:"lg",fontSize:"11px",textTransform:"uppercase",letterSpacing:"0.5px",boxShadow:"0 2px 4px rgba(240, 84, 35, 0.3)",_hover:{transform:"scale(1.05)"},transition:"all 0.2s",children:e.replace(/_/g," ")},`${r}-${e}`))}):(0,t.jsx)(u.Typography,{fontSize:"sm",color:"#6B7280",fontWeight:"400",style:{color:"#6B7280"},children:"Select requirements above to see requirement types"})})]}),(0,t.jsxs)(s.HStack,{justify:"space-between",align:"center",pt:"4",borderTop:"1px",borderColor:"gray.100",bg:"gray.50",p:"4",borderRadius:"lg",mt:"2",children:[(0,t.jsxs)(o.VStack,{align:"start",gap:"0",children:[(0,t.jsx)(u.Typography,{fontSize:"sm",fontWeight:"600",color:"#111827",style:{color:"#111827"},children:"Step Status"}),(0,t.jsx)(u.Typography,{fontSize:"xs",color:"#6B7280",style:{color:"#6B7280"},children:"Enable or disable this step"})]}),(0,t.jsx)(g.Button,{onClick:()=>U(r,"isActive",!e.isActive),variant:e.isActive?"primary":"secondary",size:"sm",fontWeight:"600",style:{backgroundColor:e.isActive?"#F05423":"transparent",borderColor:(e.isActive,"#F05423"),color:e.isActive?"#FFFFFF":"#F05423",display:"flex",alignItems:"center",justifyContent:"center",textAlign:"center",padding:"8px 16px",minWidth:"auto"},children:(0,t.jsx)(u.Typography,{as:"span",fontWeight:"600",className:e.isActive?"active-button-text":"",style:{color:e.isActive?"#FFFFFF":"#F05423",WebkitTextFillColor:e.isActive?"#FFFFFF":"#F05423",textAlign:"center"},children:e.isActive?"Active":"Inactive"})})]})]})},r))]})}),(0,t.jsxs)(a.Flex,{gap:"4",justify:"flex-end",pt:"6",borderTop:"1px",borderColor:"gray.100",children:[(0,t.jsxs)(g.Button,{onClick:()=>{e.push("/wizard-configurations")},variant:"secondary",size:"md",disabled:E||B,fontWeight:"600",children:[(0,t.jsx)(y.IconWrapper,{children:(0,t.jsx)(x.FiX,{size:18})}),(0,t.jsx)(u.Typography,{as:"span",fontWeight:"600",children:"Cancel"})]}),(0,t.jsxs)(g.Button,{onClick:V,variant:"primary",size:"md",disabled:B||E||!A||!p.entityTypeId,loading:E,loadingText:"Creating...",fontWeight:"600",style:{backgroundColor:"#F05423",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",textAlign:"center"},children:[(0,t.jsx)(y.IconWrapper,{style:{color:"#FFFFFF",fill:"#FFFFFF"},children:!E&&(0,t.jsx)(x.FiSettings,{size:18,style:{color:"#FFFFFF",fill:"#FFFFFF"}})}),(0,t.jsx)(u.Typography,{as:"span",fontWeight:"600",style:{color:"#FFFFFF",WebkitTextFillColor:"#FFFFFF",textAlign:"center"},children:E?"Creating...":"Create Configuration"})]})]})]})})]})]})}e.s(["default",()=>j])},661405,e=>{e.v(t=>Promise.all(["static/chunks/f478692b842c0428.js"].map(t=>e.l(t))).then(()=>t(819252)))}]);

//# debugId=175f996e-5f6d-730a-9fc4-dd68af856357
//# sourceMappingURL=8caf58f22f8468eb.js.map