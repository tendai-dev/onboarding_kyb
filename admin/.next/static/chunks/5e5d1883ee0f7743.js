;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="a292a899-a9d0-5707-5d3b-d51c991c860e")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,948379,e=>{"use strict";var r=e.i(843476),i=e.i(843011),t=e.i(297630),s=e.i(53545),a=e.i(361035),o=e.i(761869),n=e.i(891825),l=e.i(571798),c=e.i(147513),d=e.i(612644),p=e.i(300713),h=e.i(857557),g=e.i(192199),x=e.i(846932),y=e.i(522016),u=e.i(618566),m=e.i(271645),j=e.i(862873),f=e.i(278398);e.i(670357);var k=e.i(571408),S=e.i(778497),v=e.i(526732),w=e.i(54010),b=e.i(856459);e.i(643983);var C=e.i(554646),T=e.i(191348),I=e.i(827296),B=e.i(404372),F=e.i(927561),z=e.i(613056),A=e.i(44999);let W=(0,x.motion)(i.Box);function L(){let e=(0,u.useParams)(),x=(0,u.useRouter)(),{data:L}=(0,v.useSession)(),M=e?.id,[R,H]=(0,m.useState)(null),[N,D]=(0,m.useState)(!0),[E,O]=(0,m.useState)(null),[_,V]=(0,m.useState)(1),[$,q]=(0,m.useState)(""),[U,P]=(0,m.useState)(""),[J,K]=(0,m.useState)([]),[G,Y]=(0,m.useState)([]),[Q,X]=(0,m.useState)(""),[Z,ee]=(0,m.useState)(!1),[er,ei]=(0,m.useState)(!1),[et,es]=(0,m.useState)(!1),[ea,eo]=(0,m.useState)(!1),[en,el]=(0,m.useState)(!1),[ec,ed]=(0,m.useState)(!1),[ep,eh]=(0,m.useState)(!1),[eg,ex]=(0,m.useState)(null),[ey,eu]=(0,m.useState)(""),[em,ej]=(0,m.useState)(void 0),[ef,ek]=(0,m.useState)(void 0),[eS,ev]=(0,m.useState)([]),[ew,eb]=(0,m.useState)(!1),[eC,eT]=(0,m.useState)(null),[eI,eB]=(0,m.useState)(null),[eF,ez]=(0,m.useState)(null),[eA,eW]=(0,m.useState)(new Map),[eL,eM]=(0,m.useState)(null),[eR,eH]=(0,m.useState)(!1),[eN,eD]=(0,m.useState)(""),[eE,eO]=(0,m.useState)(""),[e_,eV]=(0,m.useState)(!1),[e$,eq]=(0,m.useState)(!1),[eU,eP]=(0,m.useState)(null),eJ=(e,r,i="info",t=5e3)=>{eP({title:e,description:r,type:i}),setTimeout(()=>eP(null),t)};(0,m.useEffect)(()=>{M&&(eK(),eG(),eY())},[M]),(0,m.useEffect)(()=>{R&&e6()},[R]),(0,m.useEffect)(()=>{2===_&&R&&e2()},[_,R,eI,eA]),(0,m.useEffect)(()=>{3===_&&R&&e3()},[_,R]);let eK=async()=>{try{D(!0),O(null);let e=(await (0,k.fetchMyWorkItems)(1,1e3)).items.find(e=>e.workItemId===M||e.id===M);if(e)H(e);else{let e=(await (0,k.fetchWorkItems)({pageSize:1e3})).items.find(e=>e.workItemId===M||e.id===M);if(!e)return void O("Work item not found");H(e)}}catch(e){console.error("Error loading work item:",e),O(e instanceof Error?e.message:"Failed to load work item")}finally{D(!1)}},eG=async()=>{try{let e=await (0,k.fetchWorkItemComments)(M);K(e)}catch(e){S.logger.error(e,"Error loading comments",{tags:{error_type:"comments_load_error"}}),K([])}},eY=async()=>{try{let e=await (0,k.fetchWorkItemHistory)(M);Y(e)}catch(e){S.logger.error(e,"Error loading history",{tags:{error_type:"history_load_error"}}),Y([])}},eQ=async()=>{if(R){eq(!0);try{await (0,k.approveWorkItemUseCase)(R.workItemId||R.id,$),eJ("Approved","Work item has been approved successfully","success",3e3),ee(!1),q(""),await eK(),x.push("/work-queue")}catch(e){eJ("Approval failed",e instanceof Error?e.message:"Failed to approve work item","error",5e3)}finally{eq(!1)}}},eX=async()=>{if(R&&U.trim()){eq(!0);try{await (0,k.declineWorkItemUseCase)(R.workItemId||R.id,U),eJ("Declined","Work item has been declined","success",3e3),ei(!1),P(""),await eK(),x.push("/work-queue")}catch(e){eJ("Decline failed",e instanceof Error?e.message:"Failed to decline work item","error",5e3)}finally{eq(!1)}}},eZ=async()=>{if(R){eq(!0);try{await (0,k.completeWorkItemUseCase)(R.workItemId||R.id,$),eJ("Completed","Work item has been completed successfully","success",3e3),es(!1),q(""),await eK(),x.push("/work-queue")}catch(e){eJ("Completion failed",e instanceof Error?e.message:"Failed to complete work item","error",5e3)}finally{eq(!1)}}},e0=async()=>{if(R){eq(!0);try{await (0,k.submitForApprovalUseCase)(R.workItemId||R.id,$),eJ("Submitted","Work item has been submitted for approval","success",3e3),eo(!1),q(""),await eK(),x.push("/work-queue")}catch(e){eJ("Submission failed",e instanceof Error?e.message:"Failed to submit for approval","error",5e3)}finally{eq(!1)}}},e1=async()=>{if(Q.trim()&&R){eq(!0);try{await (0,k.addCommentUseCase)(R.workItemId||R.id,Q),eJ("Comment added","Your comment has been added","success",3e3),X(""),await eG()}catch(e){eJ("Comment failed",e instanceof Error?e.message:"Failed to add comment","error",5e3)}finally{eq(!1)}}},e6=async()=>{if(R)try{let e=R.applicationId||R.id;if(!e)return;let r=await fetch(`/api/applications/${e}`);if(r.ok){let e=await r.json();eB(e);let i=e.metadataJson?JSON.parse(e.metadataJson):{},t=i.entity_type_code||i.entityTypeCode;if(t&&("string"==typeof t&&t.includes(",")&&(t=t.split(",")[0].trim()),t=String(t).trim()),S.logger.debug("[Review Page] Extracted entity type code",{entityTypeCode:t}),t){let r=await (0,w.fetchEntitySchema)(t,e);if(r){ez(r);let e=new Map;r.sections.forEach(r=>{r.fields.forEach(r=>{("file"===r.type||"File"===r.type)&&e.set(r.code,r.label)})}),eW(e)}}}}catch(e){S.logger.error(e,"Error loading application data",{tags:{error_type:"application_data_load_error"}})}},e2=async()=>{if(R)try{eb(!0),eT(null);let e=R.applicationId||R.id;if(!e)return void eT("No application ID found");let r=await fetch(`/api/proxy/api/v1/documents/case/${e}`);if(!r.ok){if(404===r.status)return void ev([]);throw Error(`Failed to fetch documents: ${r.status}`)}let i=await r.json(),t=[];if(Array.isArray(i)?t=i:i.items&&Array.isArray(i.items)&&(t=i.items),eI&&eA.size>0){let e=eI.metadataJson?JSON.parse(eI.metadataJson):{};S.logger.debug("[Document Mapping] Application metadata keys",{keys:Object.keys(e)}),S.logger.debug("[Document Mapping] Requirement map",{entries:Array.from(eA.entries())}),S.logger.debug("[Document Mapping] Documents to map",{docs:t.map(e=>({id:e.id,fileName:e.fileName,documentNumber:e.documentNumber,storageKey:e.storageKey,type:e.type}))}),t=t.map(r=>{let i=null,t=(r.fileName||"").toLowerCase(),s=(r.documentNumber||"").toLowerCase(),a=r.id?String(r.id).toLowerCase():"",o=(r.storageKey||"").toLowerCase();for(let[t,s]of eA.entries()){let n=`${t}_document_id`,l=`${t}_storage_key`,c=[n,n.toLowerCase(),n.toUpperCase(),n.replace(/_/g,""),n.replace(/_/g,"-")],d=[l,l.toLowerCase(),l.toUpperCase(),l.replace(/_/g,""),l.replace(/_/g,"-")];for(let t of c){let o=e[t];if(o){let e=String(o).toLowerCase();if(e===a||a===e){i=s,S.logger.debug(`[Document Mapping] âœ… Matched ${r.fileName} to ${s} via ${t}`);break}}}if(i)break;for(let t of d){let a=e[t];if(a){let e=String(a).toLowerCase();if(e===o||o.includes(e)){i=s,console.log(`[Document Mapping] âœ… Matched ${r.fileName} to ${s} via storage key ${t}`);break}}}if(i)break}if(!i)for(let[n,l]of eA.entries()){for(let c of[n,n.toLowerCase(),n.toUpperCase(),n.replace(/_/g,""),n.replace(/_/g,"-"),n.replace(/_/g," ")]){let n=e[c];if(n){let e=String(n).toLowerCase();if(e.includes(t)||e.includes(s)||e.includes(a)||e.includes(o)||t.includes(e)||s.includes(e)){i=l,S.logger.debug(`[Document Mapping] âœ… Matched ${r.fileName} to ${l} via ${c}`);break}try{let e="string"==typeof n?JSON.parse(n):n;if("object"==typeof e&&null!==e){let n=JSON.stringify(e).toLowerCase();if(n.includes(t)||n.includes(s)||n.includes(a)||n.includes(o)){i=l,console.log(`[Document Mapping] âœ… Matched ${r.fileName} to ${l} via JSON in ${c}`);break}}}catch{}}}if(i)break}if(!i)for(let[n,l]of Object.entries(e)){if(!l)continue;let e=String(l).toLowerCase();if(e.includes(t)||e.includes(s)||e.includes(a)||e.includes(o)){for(let[e,t]of eA.entries())if(n.toLowerCase().includes(e.toLowerCase())||e.toLowerCase().includes(n.toLowerCase())){i=t,console.log(`[Document Mapping] âœ… Matched ${r.fileName} to ${t} via metadata key ${n}`);break}if(i)break}}return i||S.logger.debug(`[Document Mapping] âš ï¸ Could not match ${r.fileName} to any requirement`),{...r,requirementName:i||null}})}ev(t)}catch(e){S.logger.error(e,"Error loading documents",{tags:{error_type:"documents_load_error"}}),eT(e instanceof Error?e.message:"Failed to load documents"),ev([])}finally{eb(!1)}},e4=async e=>{try{if(!e||!e.storageKey)return void eJ("Document error","Document storage key not found","error",3e3);let r=`/api/proxy-document?storageKey=${encodeURIComponent(e.storageKey)}`;ex(r),eu(e.fileName||e.documentNumber||"Document"),ej(e.type?String(e.type):void 0),ek(e.sizeBytes),eh(!0)}catch(e){S.logger.error(e,"Error viewing document",{tags:{error_type:"document_view_error"}}),eJ("View failed",e instanceof Error?e.message:"Failed to view document","error",5e3)}},e3=async()=>{if(R)try{eH(!0);let e=R.applicationId||R.id;if(!e)return void eM(null);let r=await b.riskApiService.getRiskAssessmentByCase(e);if(r){let e={id:r.id,caseId:r.caseId,partnerId:"",overallRiskLevel:r.riskLevel,riskScore:r.riskScore,status:r.status,createdAt:r.submittedDate,completedAt:r.reviewDate,assessedBy:r.reviewer,notes:r.recommendations?.join(", ")||"",factors:r.riskFactors?.map((e,i)=>({id:`factor-${i}`,type:"General",level:r.riskLevel,score:r.riskScore,description:e,createdAt:r.submittedDate}))||[]};if(eM(e),eD(r.riskLevel),e.notes&&e.notes.includes("MANUAL CLASSIFICATION:")){let r=e.notes.split("MANUAL CLASSIFICATION:")[1]?.trim()||"";eO(r)}}else eM(null),R.riskLevel&&eD(R.riskLevel.toUpperCase())}catch(e){S.logger.error(e,"Error loading risk assessment",{tags:{error_type:"risk_assessment_load_error"}}),eM(null)}finally{eH(!1)}},e5=async()=>{if(!R||!eN||!eE.trim())return void eJ("Validation Error","Please select a risk level and provide a justification","error",5e3);try{eV(!0);let e=R.applicationId||R.id;if(!e)throw Error("Case ID not found");let r=eL?.id;if(!r){let i=await b.riskApiService.getRiskAssessmentByCase(e);if(i)r=i.id;else throw Error("Risk assessment not found. Please create one first through the Risk Review page.")}await b.riskApiService.setManualRiskLevel(r,eN,eE),eJ("Risk Assessment Saved","Manual risk level has been saved successfully","success",3e3),await e3(),await eK()}catch(e){S.logger.error(e,"Error saving risk assessment",{tags:{error_type:"risk_assessment_save_error"}}),eJ("Save Failed",e instanceof Error?e.message:"Failed to save risk assessment","error",5e3)}finally{eV(!1)}},e9=e=>({SUBMITTED:"blue","IN PROGRESS":"orange","RISK REVIEW":"red",COMPLETE:"green",DECLINED:"red",INCOMPLETE:"gray"})[e]||"gray",e7=e=>{let r=e?.toLowerCase()||"low";return r.includes("high")||r.includes("critical")?"red":r.includes("medium")?"orange":"green"};if(N)return(0,r.jsxs)(o.Flex,{minH:"100vh",bg:"gray.50",children:[(0,r.jsx)(j.default,{}),(0,r.jsx)(i.Box,{flex:"1",ml:"240px",display:"flex",alignItems:"center",justifyContent:"center",children:(0,r.jsx)(s.VStack,{gap:"4",children:(0,r.jsx)(C.Typography,{color:"gray.600",children:"Loading work item..."})})})]});if(E||!R)return(0,r.jsxs)(o.Flex,{minH:"100vh",bg:"gray.50",children:[(0,r.jsx)(j.default,{}),(0,r.jsx)(i.Box,{flex:"1",ml:"240px",display:"flex",alignItems:"center",justifyContent:"center",children:(0,r.jsxs)(s.VStack,{gap:"4",children:[(0,r.jsx)(F.AlertBar,{status:"error",title:"Error",description:E||"Work item not found"}),(0,r.jsx)(y.default,{href:"/work-queue",children:(0,r.jsx)(T.Button,{variant:"secondary",children:"Back to Work Queue"})})]})})]});let e8=[{id:1,title:"Overview",icon:g.FiFileText},{id:2,title:"Documents",icon:g.FiFolder},{id:3,title:"Risk Assessment",icon:g.FiShield},{id:4,title:"Review & Decision",icon:g.FiCheckSquare}];return(0,r.jsxs)(o.Flex,{minH:"100vh",bg:"gray.50",children:[(0,r.jsx)(j.default,{}),(0,r.jsxs)(i.Box,{flex:"1",ml:"240px",children:[(0,r.jsx)(i.Box,{bg:"white",borderBottom:"1px",borderColor:"gray.200",py:"4",px:"6",boxShadow:"sm",children:(0,r.jsxs)(a.HStack,{justify:"space-between",align:"center",children:[(0,r.jsxs)(s.VStack,{align:"start",gap:"1",children:[(0,r.jsxs)(a.HStack,{gap:"3",children:[(0,r.jsx)(C.Typography,{fontSize:"2xl",fontWeight:"bold",color:"gray.900",children:"Review Work Item"}),(0,r.jsx)(z.Tag,{variant:"green"===e9(R.status)?"success":"red"===e9(R.status)?"danger":"info",children:R.status}),R.riskLevel&&(0,r.jsxs)(z.Tag,{variant:"red"===e7(R.riskLevel)?"danger":"orange"===e7(R.riskLevel)?"warning":"info",children:[R.riskLevel," Risk"]})]}),(0,r.jsxs)(C.Typography,{color:"gray.600",fontSize:"sm",children:[R.workItemNumber||R.id," â€¢ ",R.legalName]})]}),(0,r.jsx)(a.HStack,{gap:"2",children:(0,r.jsx)(y.default,{href:"/work-queue",children:(0,r.jsxs)(T.Button,{variant:"secondary",size:"sm",children:[(0,r.jsx)(A.IconWrapper,{children:(0,r.jsx)(g.FiArrowLeft,{size:16})}),"Back to Queue"]})})})]})}),(0,r.jsx)(t.Container,{maxW:"8xl",py:"6",children:(0,r.jsxs)(s.VStack,{gap:"6",align:"stretch",children:[(0,r.jsx)(i.Box,{bg:"white",p:"4",borderRadius:"lg",boxShadow:"sm",children:(0,r.jsx)(a.HStack,{gap:"2",justify:"space-between",children:e8.map((e,t)=>(0,r.jsxs)(o.Flex,{align:"center",gap:"2",flex:"1",children:[(0,r.jsx)(i.Box,{w:"40px",h:"40px",borderRadius:"full",bg:_>=e.id?"orange.500":"gray.200",color:_>=e.id?"white":"gray.600",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",onClick:()=>V(e.id),children:(0,r.jsx)(A.IconWrapper,{children:(0,r.jsx)(e.icon,{size:16})})}),(0,r.jsx)(C.Typography,{fontSize:"sm",fontWeight:_===e.id?"bold":"medium",color:_>=e.id?"gray.900":"gray.600",children:e.title}),t<e8.length-1&&(0,r.jsx)(i.Box,{flex:"1",h:"2px",bg:_>e.id?"orange.500":"gray.200",ml:"2"})]},e.id))})}),(0,r.jsxs)(W,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:[1===_&&(0,r.jsxs)(n.SimpleGrid,{columns:{base:1,md:2},gap:"6",children:[(0,r.jsxs)(I.Card,{bg:"white",boxShadow:"md",p:"6",children:[(0,r.jsx)(C.Typography,{fontWeight:"bold",fontSize:"lg",mb:"4",children:"Work Item Details"}),(0,r.jsx)(i.Box,{children:(0,r.jsxs)(s.VStack,{align:"stretch",gap:"3",children:[(0,r.jsxs)(a.HStack,{justify:"space-between",children:[(0,r.jsx)(C.Typography,{color:"gray.600",children:"Work Item #"}),(0,r.jsx)(C.Typography,{fontWeight:"semibold",children:R.workItemNumber||R.id})]}),(0,r.jsxs)(a.HStack,{justify:"space-between",children:[(0,r.jsx)(C.Typography,{color:"gray.600",children:"Applicant Name"}),(0,r.jsx)(C.Typography,{fontWeight:"semibold",children:R.legalName})]}),(0,r.jsxs)(a.HStack,{justify:"space-between",children:[(0,r.jsx)(C.Typography,{color:"gray.600",children:"Entity Type"}),(0,r.jsx)(C.Typography,{fontWeight:"semibold",children:R.entityType})]}),(0,r.jsxs)(a.HStack,{justify:"space-between",children:[(0,r.jsx)(C.Typography,{color:"gray.600",children:"Country"}),(0,r.jsx)(C.Typography,{fontWeight:"semibold",children:R.country})]}),(0,r.jsxs)(a.HStack,{justify:"space-between",children:[(0,r.jsx)(C.Typography,{color:"gray.600",children:"Priority"}),(0,r.jsx)(z.Tag,{variant:R.priority?.toLowerCase()==="high"?"danger":"warning",children:R.priority||"Medium"})]}),R.dueDate&&(0,r.jsxs)(a.HStack,{justify:"space-between",children:[(0,r.jsx)(C.Typography,{color:"gray.600",children:"Due Date"}),(0,r.jsx)(C.Typography,{fontWeight:"semibold",children:new Date(R.dueDate).toLocaleDateString()})]}),R.assignedToName&&(0,r.jsxs)(a.HStack,{justify:"space-between",children:[(0,r.jsx)(C.Typography,{color:"gray.600",children:"Assigned To"}),(0,r.jsx)(C.Typography,{fontWeight:"semibold",children:R.assignedToName})]})]})})]}),(0,r.jsxs)(I.Card,{bg:"white",boxShadow:"md",p:"6",children:[(0,r.jsx)(C.Typography,{fontWeight:"bold",fontSize:"lg",mb:"4",children:"Quick Actions"}),(0,r.jsxs)(s.VStack,{align:"stretch",gap:"3",children:[(0,r.jsx)(T.Button,{variant:"primary",onClick:()=>el(!0),children:(0,r.jsxs)(a.HStack,{gap:"2",children:[(0,r.jsx)(A.IconWrapper,{children:(0,r.jsx)(g.FiMessageSquare,{size:16})}),(0,r.jsxs)(C.Typography,{children:["View Comments (",J.length,")"]})]})}),(0,r.jsx)(T.Button,{variant:"secondary",onClick:()=>ed(!0),children:(0,r.jsxs)(a.HStack,{gap:"2",children:[(0,r.jsx)(A.IconWrapper,{children:(0,r.jsx)(g.FiClock,{size:16})}),(0,r.jsx)(C.Typography,{children:"View History"})]})}),(0,r.jsx)(y.default,{href:`/applications/${R.applicationId||R.id}`,children:(0,r.jsx)(T.Button,{variant:"secondary",w:"full",children:(0,r.jsxs)(a.HStack,{gap:"2",children:[(0,r.jsx)(A.IconWrapper,{children:(0,r.jsx)(g.FiEye,{size:16})}),(0,r.jsx)(C.Typography,{children:"View Full Application"})]})})})]})]})]}),2===_&&(0,r.jsxs)(I.Card,{bg:"white",boxShadow:"md",p:"6",children:[(0,r.jsxs)(a.HStack,{justify:"space-between",align:"center",w:"full",mb:"4",children:[(0,r.jsx)(C.Typography,{fontWeight:"bold",fontSize:"lg",children:"Documents"}),(0,r.jsx)(T.Button,{size:"sm",variant:"secondary",onClick:e2,children:(0,r.jsxs)(a.HStack,{gap:"1",children:[(0,r.jsx)(A.IconWrapper,{children:(0,r.jsx)(g.FiRefreshCw,{size:16})}),(0,r.jsx)(C.Typography,{children:"Refresh"})]})})]}),(0,r.jsx)(i.Box,{children:ew?(0,r.jsxs)(s.VStack,{gap:"4",py:"8",children:[(0,r.jsx)(p.Spinner,{size:"lg",color:"orange.500"}),(0,r.jsx)(C.Typography,{color:"gray.600",children:"Loading documents..."})]}):eC?(0,r.jsx)(F.AlertBar,{status:"error",title:"Error loading documents",description:eC}):0===eS.length?(0,r.jsxs)(s.VStack,{gap:"4",py:"8",children:[(0,r.jsx)(A.IconWrapper,{children:(0,r.jsx)(g.FiFolder,{size:48,color:"#9CA3AF"})}),(0,r.jsx)(C.Typography,{color:"gray.600",fontSize:"md",children:"No documents found for this application"}),(0,r.jsx)(y.default,{href:`/applications/${R.applicationId||R.id}`,children:(0,r.jsx)(T.Button,{variant:"secondary",children:"View Full Application"})})]}):(0,r.jsxs)(s.VStack,{align:"stretch",gap:"3",children:[(0,r.jsxs)(C.Typography,{color:"gray.600",fontSize:"sm",mb:"2",children:[eS.length," document",1!==eS.length?"s":""," found"]}),(0,r.jsx)(n.SimpleGrid,{columns:{base:1,md:2},gap:"3",children:eS.map((e,t)=>(0,r.jsx)(i.Box,{p:"4",border:"1px",borderColor:"gray.200",borderRadius:"lg",_hover:{borderColor:"orange.400",boxShadow:"md",transform:"translateY(-2px)"},transition:"all 0.2s",cursor:"pointer",onClick:()=>e4(e),children:(0,r.jsxs)(a.HStack,{gap:"3",align:"start",children:[(0,r.jsx)(i.Box,{p:"2",borderRadius:"md",bg:"orange.100",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,children:(0,r.jsx)(A.IconWrapper,{children:(0,r.jsx)(g.FiFileText,{size:20,color:"#DD6B20"})})}),(0,r.jsxs)(s.VStack,{align:"start",gap:"1",flex:"1",minW:"0",children:[(0,r.jsx)(z.Tag,{variant:e.requirementName?"warning":"info",title:e.requirementName?`Requirement: ${e.requirementName}`:void 0,children:e.requirementName?e.requirementName:e.type?({1:"Passport Copy",2:"Drivers License",3:"National ID",4:"Proof of Address",5:"Bank Statement",6:"Tax Document",7:"Business Registration",8:"Articles of Incorporation",9:"Shareholder Registry",10:"Financial Statements",99:"Other"})[e.type]||`Type ${e.type}`:"Unknown"}),(0,r.jsx)(C.Typography,{fontWeight:"semibold",fontSize:"sm",color:"gray.900",style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"100%"},children:e.fileName||e.documentNumber||`Document ${t+1}`}),(0,r.jsx)(a.HStack,{gap:"2",wrap:"wrap",children:e.sizeBytes&&(0,r.jsx)(C.Typography,{fontSize:"xs",color:"gray.500",children:(e=>{if(!e)return"";if(0===e)return"0 Bytes";let r=Math.floor(Math.log(e)/Math.log(1024));return Math.round(e/Math.pow(1024,r)*100)/100+" "+["Bytes","KB","MB","GB"][r]})(e.sizeBytes)})}),e.requirementName&&(0,r.jsxs)(C.Typography,{fontSize:"xs",color:"orange.600",fontWeight:"medium",mt:"1",children:["ðŸ“‹ ",e.requirementName]}),e.uploadedAt&&(0,r.jsxs)(C.Typography,{fontSize:"xs",color:"gray.500",children:["Uploaded: ",new Date(e.uploadedAt).toLocaleDateString()]})]}),(0,r.jsx)(T.Button,{size:"sm",variant:"secondary",onClick:r=>{r.stopPropagation(),e4(e)},children:(0,r.jsxs)(a.HStack,{gap:"1",children:[(0,r.jsx)(A.IconWrapper,{children:(0,r.jsx)(g.FiEye,{size:16})}),(0,r.jsx)(C.Typography,{children:"View"})]})})]})},e.id||t))}),(0,r.jsx)(d.Separator,{mt:"4"}),(0,r.jsx)(y.default,{href:`/applications/${R.applicationId||R.id}`,children:(0,r.jsxs)(T.Button,{variant:"secondary",w:"full",mt:"2",children:[(0,r.jsx)(A.IconWrapper,{children:(0,r.jsx)(g.FiArrowRight,{size:16})}),"View Full Application Details"]})})]})})]}),3===_&&(0,r.jsxs)(I.Card,{bg:"white",boxShadow:"md",p:"6",children:[(0,r.jsxs)(a.HStack,{justify:"space-between",align:"center",w:"full",mb:"4",children:[(0,r.jsx)(C.Typography,{fontWeight:"bold",fontSize:"lg",children:"Manual Risk Assessment"}),eL&&(0,r.jsx)(z.Tag,{variant:"success",children:(0,r.jsxs)(a.HStack,{gap:"1",children:[(0,r.jsx)(A.IconWrapper,{children:(0,r.jsx)(g.FiCheck,{size:14})}),(0,r.jsx)(C.Typography,{fontSize:"sm",children:"Assessed"})]})})]}),(0,r.jsx)(i.Box,{children:eR?(0,r.jsxs)(s.VStack,{gap:"4",py:"8",children:[(0,r.jsx)(p.Spinner,{size:"lg",color:"orange.500"}),(0,r.jsx)(C.Typography,{color:"gray.600",children:"Loading risk assessment..."})]}):(0,r.jsxs)(s.VStack,{align:"stretch",gap:"6",children:[eL&&(0,r.jsx)(i.Box,{p:"4",bg:"gray.50",borderRadius:"md",border:"1px",borderColor:"gray.200",children:(0,r.jsxs)(s.VStack,{align:"stretch",gap:"3",children:[(0,r.jsxs)(a.HStack,{justify:"space-between",children:[(0,r.jsx)(C.Typography,{fontWeight:"semibold",fontSize:"sm",color:"gray.700",children:"Current Risk Level"}),(0,r.jsx)(z.Tag,{variant:"red"===e7(eL.overallRiskLevel)?"danger":"orange"===e7(eL.overallRiskLevel)?"warning":"info",children:eL.overallRiskLevel})]}),void 0!==eL.riskScore&&(0,r.jsxs)(i.Box,{children:[(0,r.jsxs)(a.HStack,{justify:"space-between",mb:"2",children:[(0,r.jsx)(C.Typography,{fontSize:"sm",color:"gray.600",children:"Risk Score"}),(0,r.jsxs)(C.Typography,{fontWeight:"bold",fontSize:"sm",children:[eL.riskScore,"%"]})]}),(0,r.jsx)(c.Progress.Root,{value:eL.riskScore,colorScheme:e7(eL.overallRiskLevel),children:(0,r.jsx)(c.Progress.Track,{children:(0,r.jsx)(c.Progress.Range,{})})})]}),eL.assessedBy&&(0,r.jsxs)(a.HStack,{gap:"2",children:[(0,r.jsx)(C.Typography,{fontSize:"xs",color:"gray.500",children:"Assessed by:"}),(0,r.jsx)(C.Typography,{fontSize:"xs",fontWeight:"medium",children:eL.assessedBy}),eL.completedAt&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(C.Typography,{fontSize:"xs",color:"gray.400",children:"â€¢"}),(0,r.jsx)(C.Typography,{fontSize:"xs",color:"gray.500",children:new Date(eL.completedAt).toLocaleDateString()})]})]}),eL.notes&&eL.notes.includes("MANUAL CLASSIFICATION:")&&(0,r.jsxs)(i.Box,{mt:"2",children:[(0,r.jsx)(C.Typography,{fontSize:"xs",fontWeight:"semibold",color:"gray.600",mb:"1",children:"Justification:"}),(0,r.jsx)(C.Typography,{fontSize:"xs",color:"gray.700",fontStyle:"italic",children:eL.notes.split("MANUAL CLASSIFICATION:")[1]?.trim()||eL.notes})]})]})}),(0,r.jsx)(d.Separator,{}),(0,r.jsxs)(s.VStack,{align:"stretch",gap:"4",children:[(0,r.jsx)(C.Typography,{fontWeight:"semibold",fontSize:"md",color:"gray.900",children:"Determine Risk Level"}),(0,r.jsxs)(h.Field.Root,{required:!0,children:[(0,r.jsx)(h.Field.Label,{children:"Risk Level"}),(0,r.jsx)(h.Field.HelperText,{children:"Select the appropriate risk level based on your manual assessment"}),(0,r.jsxs)("select",{value:eN,onChange:e=>eD(e.target.value),style:{width:"100%",padding:"8px 12px",border:"1px solid #e2e8f0",borderRadius:"6px",fontSize:"14px",backgroundColor:"white"},children:[(0,r.jsx)("option",{value:"",children:"Select Risk Level"}),(0,r.jsx)("option",{value:"LOW",children:"Low"}),(0,r.jsx)("option",{value:"MEDIUMLOW",children:"Medium Low"}),(0,r.jsx)("option",{value:"MEDIUM",children:"Medium"}),(0,r.jsx)("option",{value:"MEDIUMHIGH",children:"Medium High"}),(0,r.jsx)("option",{value:"HIGH",children:"High"}),(0,r.jsx)("option",{value:"CRITICAL",children:"Critical"})]})]}),(0,r.jsxs)(h.Field.Root,{required:!0,children:[(0,r.jsx)(h.Field.Label,{children:"Justification"}),(0,r.jsx)(h.Field.HelperText,{children:"Provide a detailed justification for the selected risk level. This is required for audit and compliance purposes."}),(0,r.jsx)(l.Textarea,{value:eE,onChange:e=>eO(e.target.value),placeholder:"Enter your justification for the risk level determination. Include specific factors, concerns, or observations that led to this assessment...",rows:6,resize:"vertical"})]}),(0,r.jsxs)(a.HStack,{gap:"3",justify:"flex-end",pt:"2",children:[(0,r.jsx)(T.Button,{variant:"secondary",onClick:()=>{eD(eL?.overallRiskLevel||R?.riskLevel?.toUpperCase()||""),eO("")},children:"Reset"}),(0,r.jsx)(T.Button,{colorScheme:"orange",onClick:e5,loading:e_,disabled:!eN||!eE.trim(),children:(0,r.jsxs)(a.HStack,{gap:"2",children:[(0,r.jsx)(A.IconWrapper,{children:(0,r.jsx)(g.FiSave,{size:16})}),(0,r.jsx)(C.Typography,{children:"Save Risk Assessment"})]})})]})]}),(0,r.jsx)(d.Separator,{}),(0,r.jsx)(s.VStack,{align:"stretch",gap:"2",children:(0,r.jsx)(y.default,{href:`/risk-review?search=${R.id}`,children:(0,r.jsx)(T.Button,{variant:"secondary",w:"full",children:(0,r.jsxs)(a.HStack,{gap:"2",children:[(0,r.jsx)(A.IconWrapper,{children:(0,r.jsx)(g.FiShield,{size:16})}),(0,r.jsx)(C.Typography,{children:"View Detailed Risk Assessment"}),(0,r.jsx)(A.IconWrapper,{children:(0,r.jsx)(g.FiArrowRight,{size:16})})]})})})})]})})]}),4===_&&(0,r.jsxs)(I.Card,{bg:"white",boxShadow:"md",p:"6",children:[(0,r.jsx)(C.Typography,{fontWeight:"bold",fontSize:"lg",mb:"4",children:"Review & Decision"}),(0,r.jsx)(i.Box,{children:(0,r.jsxs)(s.VStack,{align:"stretch",gap:"4",children:[(0,r.jsxs)(h.Field.Root,{children:[(0,r.jsx)(h.Field.Label,{children:"Review Notes"}),(0,r.jsx)(l.Textarea,{value:$,onChange:e=>q(e.target.value),placeholder:"Enter your review notes...",rows:6})]}),(0,r.jsx)(d.Separator,{}),(0,r.jsxs)(n.SimpleGrid,{columns:{base:1,md:2},gap:"3",children:["IN PROGRESS"===R.status&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(T.Button,{variant:"primary",onClick:()=>es(!0),size:"md",children:(0,r.jsxs)(a.HStack,{gap:"2",children:[(0,r.jsx)(A.IconWrapper,{children:(0,r.jsx)(g.FiCheck,{size:16})}),(0,r.jsx)(C.Typography,{children:"Complete Review"})]})}),R.requiresApproval&&(0,r.jsx)(T.Button,{variant:"primary",onClick:()=>eo(!0),size:"md",children:(0,r.jsxs)(a.HStack,{gap:"2",children:[(0,r.jsx)(A.IconWrapper,{children:(0,r.jsx)(g.FiSend,{size:16})}),(0,r.jsx)(C.Typography,{children:"Submit for Approval"})]})})]}),"RISK REVIEW"===R.status&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(T.Button,{variant:"primary",onClick:()=>ee(!0),size:"md",children:(0,r.jsxs)(a.HStack,{gap:"2",children:[(0,r.jsx)(A.IconWrapper,{children:(0,r.jsx)(g.FiCheck,{size:16})}),(0,r.jsx)(C.Typography,{children:"Approve"})]})}),(0,r.jsx)(T.Button,{variant:"primary",onClick:()=>ei(!0),size:"md",children:(0,r.jsxs)(a.HStack,{gap:"2",children:[(0,r.jsx)(A.IconWrapper,{children:(0,r.jsx)(g.FiX,{size:16})}),(0,r.jsx)(C.Typography,{children:"Decline"})]})})]})]})]})})]})]},_),(0,r.jsxs)(a.HStack,{justify:"space-between",mt:"4",children:[(0,r.jsx)(T.Button,{variant:"secondary",onClick:()=>V(Math.max(1,_-1)),disabled:1===_,children:(0,r.jsxs)(a.HStack,{gap:"2",children:[(0,r.jsx)(A.IconWrapper,{children:(0,r.jsx)(g.FiArrowLeft,{size:16})}),(0,r.jsx)(C.Typography,{children:"Previous"})]})}),(0,r.jsx)(T.Button,{variant:"primary",onClick:()=>V(Math.min(e8.length,_+1)),disabled:_===e8.length,children:(0,r.jsxs)(a.HStack,{gap:"2",children:[(0,r.jsx)(C.Typography,{children:"Next"}),(0,r.jsx)(A.IconWrapper,{children:(0,r.jsx)(g.FiArrowRight,{size:16})})]})})]})]})})]}),(0,r.jsxs)(B.Modal,{isOpen:Z,onClose:()=>ee(!1),title:"Approve Work Item",size:"small",closeOnBackdropClick:!0,closeOnEsc:!0,children:[(0,r.jsx)(B.ModalHeader,{children:(0,r.jsx)(C.Typography,{fontSize:"lg",fontWeight:"700",color:"gray.900",children:"Approve Work Item"})}),(0,r.jsx)(B.ModalBody,{children:(0,r.jsx)(s.VStack,{align:"stretch",gap:"4",children:(0,r.jsxs)(h.Field.Root,{children:[(0,r.jsx)(h.Field.Label,{children:"Notes (Optional)"}),(0,r.jsx)(l.Textarea,{value:$,onChange:e=>q(e.target.value),placeholder:"Add approval notes...",rows:4})]})})}),(0,r.jsx)(B.ModalFooter,{children:(0,r.jsxs)(a.HStack,{gap:"2",children:[(0,r.jsx)(T.Button,{variant:"secondary",onClick:()=>ee(!1),children:"Cancel"}),(0,r.jsx)(T.Button,{variant:"primary",onClick:eQ,disabled:e$,children:"Approve"})]})})]}),(0,r.jsxs)(B.Modal,{isOpen:er,onClose:()=>ei(!1),title:"Decline Work Item",size:"small",closeOnBackdropClick:!0,closeOnEsc:!0,children:[(0,r.jsx)(B.ModalHeader,{children:(0,r.jsx)(C.Typography,{fontSize:"lg",fontWeight:"700",color:"gray.900",children:"Decline Work Item"})}),(0,r.jsx)(B.ModalBody,{children:(0,r.jsx)(s.VStack,{align:"stretch",gap:"4",children:(0,r.jsxs)(h.Field.Root,{required:!0,children:[(0,r.jsx)(h.Field.Label,{children:"Reason for Decline"}),(0,r.jsx)(l.Textarea,{value:U,onChange:e=>P(e.target.value),placeholder:"Please provide a reason for declining...",rows:4})]})})}),(0,r.jsx)(B.ModalFooter,{children:(0,r.jsxs)(a.HStack,{gap:"2",children:[(0,r.jsx)(T.Button,{variant:"secondary",onClick:()=>ei(!1),children:"Cancel"}),(0,r.jsx)(T.Button,{variant:"primary",onClick:eX,disabled:e$||!U.trim(),children:"Decline"})]})})]}),(0,r.jsxs)(B.Modal,{isOpen:et,onClose:()=>es(!1),title:"Complete Work Item",size:"small",closeOnBackdropClick:!0,closeOnEsc:!0,children:[(0,r.jsx)(B.ModalHeader,{children:(0,r.jsx)(C.Typography,{fontSize:"lg",fontWeight:"700",color:"gray.900",children:"Complete Work Item"})}),(0,r.jsx)(B.ModalBody,{children:(0,r.jsx)(s.VStack,{align:"stretch",gap:"4",children:(0,r.jsxs)(h.Field.Root,{children:[(0,r.jsx)(h.Field.Label,{children:"Notes (Optional)"}),(0,r.jsx)(l.Textarea,{value:$,onChange:e=>q(e.target.value),placeholder:"Add completion notes...",rows:4})]})})}),(0,r.jsx)(B.ModalFooter,{children:(0,r.jsxs)(a.HStack,{gap:"2",children:[(0,r.jsx)(T.Button,{variant:"secondary",onClick:()=>es(!1),children:"Cancel"}),(0,r.jsx)(T.Button,{variant:"primary",onClick:eZ,disabled:e$,children:"Complete"})]})})]}),(0,r.jsxs)(B.Modal,{isOpen:ea,onClose:()=>eo(!1),title:"Submit for Approval",size:"small",closeOnBackdropClick:!0,closeOnEsc:!0,children:[(0,r.jsx)(B.ModalHeader,{children:(0,r.jsx)(C.Typography,{fontSize:"lg",fontWeight:"700",color:"gray.900",children:"Submit for Approval"})}),(0,r.jsx)(B.ModalBody,{children:(0,r.jsx)(s.VStack,{align:"stretch",gap:"4",children:(0,r.jsxs)(h.Field.Root,{children:[(0,r.jsx)(h.Field.Label,{children:"Notes (Optional)"}),(0,r.jsx)(l.Textarea,{value:$,onChange:e=>q(e.target.value),placeholder:"Add notes for approval...",rows:4})]})})}),(0,r.jsx)(B.ModalFooter,{children:(0,r.jsxs)(a.HStack,{gap:"2",children:[(0,r.jsx)(T.Button,{variant:"secondary",onClick:()=>eo(!1),children:"Cancel"}),(0,r.jsx)(T.Button,{variant:"primary",onClick:e0,disabled:e$,children:"Submit"})]})})]}),(0,r.jsxs)(B.Modal,{isOpen:en,onClose:()=>el(!1),title:"Comments",size:"large",closeOnBackdropClick:!0,closeOnEsc:!0,children:[(0,r.jsx)(B.ModalHeader,{children:(0,r.jsx)(C.Typography,{fontSize:"lg",fontWeight:"700",color:"gray.900",children:"Comments"})}),(0,r.jsx)(B.ModalBody,{children:(0,r.jsxs)(s.VStack,{align:"stretch",gap:"4",children:[(0,r.jsx)(i.Box,{maxH:"400px",overflowY:"auto",children:0===J.length?(0,r.jsx)(C.Typography,{color:"gray.600",children:"No comments yet"}):(0,r.jsx)(s.VStack,{align:"stretch",gap:"3",children:J.map((e,t)=>(0,r.jsxs)(i.Box,{p:"3",bg:"gray.50",borderRadius:"md",children:[(0,r.jsxs)(a.HStack,{justify:"space-between",mb:"2",children:[(0,r.jsx)(C.Typography,{fontWeight:"semibold",fontSize:"sm",children:e.createdBy||e.authorName||"Unknown"}),(0,r.jsx)(C.Typography,{fontSize:"xs",color:"gray.600",children:new Date(e.createdAt||e.timestamp).toLocaleString()})]}),(0,r.jsx)(C.Typography,{fontSize:"sm",color:"gray.700",children:e.text||e.comment})]},t))})}),(0,r.jsx)(d.Separator,{}),(0,r.jsxs)(s.VStack,{align:"stretch",gap:"2",children:[(0,r.jsxs)(h.Field.Root,{children:[(0,r.jsx)(h.Field.Label,{children:"Add Comment"}),(0,r.jsx)(l.Textarea,{value:Q,onChange:e=>X(e.target.value),placeholder:"Enter your comment...",rows:3})]}),(0,r.jsx)(T.Button,{variant:"primary",onClick:e1,disabled:e$||!Q.trim(),children:(0,r.jsxs)(a.HStack,{gap:"2",children:[(0,r.jsx)(A.IconWrapper,{children:(0,r.jsx)(g.FiMessageSquare,{size:16})}),(0,r.jsx)(C.Typography,{children:"Add Comment"})]})})]})]})}),(0,r.jsx)(B.ModalFooter,{children:(0,r.jsx)(T.Button,{variant:"secondary",onClick:()=>el(!1),children:"Close"})})]}),(0,r.jsxs)(B.Modal,{isOpen:ec,onClose:()=>ed(!1),title:"History",size:"large",closeOnBackdropClick:!0,closeOnEsc:!0,children:[(0,r.jsx)(B.ModalHeader,{children:(0,r.jsx)(C.Typography,{fontSize:"lg",fontWeight:"700",color:"gray.900",children:"History"})}),(0,r.jsx)(B.ModalBody,{children:(0,r.jsx)(i.Box,{maxH:"500px",overflowY:"auto",children:0===G.length?(0,r.jsx)(C.Typography,{color:"gray.600",children:"No history available"}):(0,r.jsx)(s.VStack,{align:"stretch",gap:"2",children:G.map((e,t)=>(0,r.jsxs)(i.Box,{p:"3",borderLeft:"3px",borderColor:"orange.500",bg:"gray.50",borderRadius:"md",children:[(0,r.jsxs)(a.HStack,{justify:"space-between",mb:"1",children:[(0,r.jsx)(C.Typography,{fontWeight:"semibold",fontSize:"sm",children:e.action||e.description||e.eventType}),(0,r.jsx)(C.Typography,{fontSize:"xs",color:"gray.600",children:new Date(e.timestamp||e.createdAt).toLocaleString()})]}),e.performedBy&&(0,r.jsxs)(C.Typography,{fontSize:"xs",color:"gray.600",children:["By: ",e.performedBy]})]},t))})})}),(0,r.jsx)(B.ModalFooter,{children:(0,r.jsx)(T.Button,{variant:"secondary",onClick:()=>ed(!1),children:"Close"})})]}),(0,r.jsx)(f.DocumentViewer,{isOpen:ep,onClose:()=>{eh(!1),ex(null),eu(""),ej(void 0),ek(void 0)},documentUrl:eg,fileName:ey,documentType:em,fileSize:ef,onDownload:()=>{eg&&window.open(eg,"_blank")}})]})}e.s(["default",()=>L])}]);

//# debugId=a292a899-a9d0-5707-5d3b-d51c991c860e
//# sourceMappingURL=4f9ef17896c3094d.js.map