;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="553c1987-339f-1b1b-07a1-ed36af71202a")}catch(e){}}();
module.exports=[918622,(e,t,r)=>{t.exports=e.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},556704,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},832319,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},120635,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/action-async-storage.external.js",()=>require("next/dist/server/app-render/action-async-storage.external.js"))},324725,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/after-task-async-storage.external.js",()=>require("next/dist/server/app-render/after-task-async-storage.external.js"))},224361,(e,t,r)=>{t.exports=e.x("util",()=>require("util"))},814747,(e,t,r)=>{t.exports=e.x("path",()=>require("path"))},492709,e=>{"use strict";var t=e.i(747909),r=e.i(174017),a=e.i(996250),s=e.i(759756),n=e.i(561916),i=e.i(114444),o=e.i(837092),l=e.i(869741),d=e.i(316795),p=e.i(487718),u=e.i(995169),c=e.i(47587),m=e.i(666012),h=e.i(570101),g=e.i(626937),_=e.i(10372),f=e.i(193695);e.i(52474);var b=e.i(600220),v=e.i(89171),x=e.i(79832),R=e.i(50377);async function y(e,{params:t}){let{id:r}=t;if(!r)return v.NextResponse.json({error:"Application ID is required"},{status:400});try{let t=await (0,x.auth)(),a={"Content-Type":"application/json"};if(t?.user){let e=t.user;e.email&&(a["X-User-Email"]=e.email),e.name&&(a["X-User-Name"]=e.name),e.id&&(a["X-User-Id"]=e.id),e.role&&(a["X-User-Role"]=e.role)}let s=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(r),n=`/api/proxy/projections/v1/cases?searchTerm=${encodeURIComponent(r)}&take=10`,i=new URL(n,e.url);R.logger.debug("[Admin Application Details] Searching projections API via proxy",{url:i.toString()});let o=await fetch(i.toString(),{method:"GET",headers:a,cache:"no-store",signal:AbortSignal.timeout(5e3)}),l=!1,d=null;if(o.ok){let e=await o.json();if(e.items&&Array.isArray(e.items)&&e.items.length>0){let t=e.items.find(e=>e.caseId===r||e.id===r||e.id?.toLowerCase()===r.toLowerCase());t||(t=e.items.find(e=>e.caseId?.toLowerCase()===r.toLowerCase()||e.id?.toLowerCase()===r.toLowerCase())),t&&(l=!0,d=t)}}if(l&&d)return v.NextResponse.json(d);if(s)try{R.logger.debug("[Admin Application Details] Not found in projections, trying onboarding API",{path:`/api/proxy/api/v1/cases/${r}`});let t=`/api/proxy/api/v1/cases/${r}`,s=new URL(t,e.url),n=await fetch(s.toString(),{method:"GET",headers:a,cache:"no-store",signal:AbortSignal.timeout(1e4)});if(n.ok){let e=await n.json();R.logger.debug("[Admin Application Details] Found in onboarding API, transforming data");let t={id:e.id||r,caseId:e.case_number||e.caseNumber||"",type:e.type||"",status:e.status||"",partnerId:e.partner_id||e.partnerId||"",partnerName:e.partner_name||e.partnerName||"",partnerReferenceId:e.partner_reference_id||e.partnerReferenceId||"",applicantFirstName:e.applicant?.first_name||e.applicant?.firstName||"",applicantLastName:e.applicant?.last_name||e.applicant?.lastName||"",applicantEmail:e.applicant?.email||"",applicantPhone:e.applicant?.phone_number||e.applicant?.phoneNumber||"",applicantDateOfBirth:e.applicant?.date_of_birth||e.applicant?.dateOfBirth,applicantNationality:e.applicant?.nationality||"",applicantAddress:e.applicant?.residential_address?.street||e.applicant?.residentialAddress?.street||"",applicantCity:e.applicant?.residential_address?.city||e.applicant?.residentialAddress?.city||"",applicantCountry:e.applicant?.residential_address?.country||e.applicant?.residentialAddress?.country||"",businessLegalName:e.business?.legal_name||e.business?.legalName||"",businessRegistrationNumber:e.business?.registration_number||e.business?.registrationNumber||"",businessTaxId:e.business?.tax_id||e.business?.taxId||"",businessCountryOfRegistration:e.business?.country_of_registration||e.business?.countryOfRegistration||"",businessAddress:e.business?.registered_address?.street||e.business?.registeredAddress?.street||"",businessCity:e.business?.registered_address?.city||e.business?.registeredAddress?.city||"",businessIndustry:e.business?.industry||"",businessNumberOfEmployees:e.business?.number_of_employees||e.business?.numberOfEmployees,businessAnnualRevenue:e.business?.annual_revenue||e.business?.annualRevenue,businessWebsite:e.business?.website||"",createdAt:e.created_at||e.createdAt||new Date().toISOString(),updatedAt:e.updated_at||e.updatedAt||new Date().toISOString(),progressPercentage:0,totalSteps:0,completedSteps:0,checklistStatus:"",checklistCompletionPercentage:0,checklistTotalItems:0,checklistCompletedItems:0,checklistRequiredItems:0,checklistCompletedRequiredItems:0,riskLevel:"Medium",riskScore:0,riskStatus:"",riskFactorCount:0,documentCount:0,verifiedDocumentCount:0,pendingDocumentCount:0,rejectedDocumentCount:0,requiresManualReview:!1,hasComplianceIssues:!1,metadataJson:JSON.stringify(e.metadata||{})};return R.logger.debug("[Admin Application Details] Successfully transformed and returning data"),v.NextResponse.json(t)}{let e=await n.text();R.logger.error(Error(`Onboarding API returned ${n.status}`),"[Admin Application Details] Onboarding API error",{tags:{error_type:"api_backend_error"},extra:{status:n.status,errorText:e}})}}catch(e){R.logger.error(e,"[Admin Application Details] Error fetching from onboarding API",{tags:{error_type:"api_fetch_error"}})}return v.NextResponse.json({error:"Application not found"},{status:404})}catch(r){R.logger.error(r,"[Admin Application Details] Error",{tags:{error_type:"api_route_error"}});let e=r instanceof Error?r.message:"Unknown error",t=e.includes("fetch failed")||e.includes("ECONNREFUSED")||e.includes("timeout");return v.NextResponse.json({error:"Failed to fetch application details",message:e,details:t?"Cannot connect to backend services. Please ensure they are running.":void 0},{status:500})}}e.s(["GET",()=>y],666271);var A=e.i(666271);let w=new t.AppRouteRouteModule({definition:{kind:r.RouteKind.APP_ROUTE,page:"/api/applications/[id]/route",pathname:"/api/applications/[id]",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/src/app/api/applications/[id]/route.ts",nextConfigOutput:"",userland:A}),{workAsyncStorage:C,workUnitAsyncStorage:E,serverHooks:N}=w;function I(){return(0,a.patchFetch)({workAsyncStorage:C,workUnitAsyncStorage:E})}async function k(e,t,a){w.isDev&&(0,s.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let v="/api/applications/[id]/route";v=v.replace(/\/index$/,"")||"/";let x=await w.prepare(e,t,{srcPage:v,multiZoneDraftMode:!1});if(!x)return t.statusCode=400,t.end("Bad Request"),null==a.waitUntil||a.waitUntil.call(a,Promise.resolve()),null;let{buildId:R,params:y,nextConfig:A,parsedUrl:C,isDraftMode:E,prerenderManifest:N,routerServerContext:I,isOnDemandRevalidate:k,revalidateOnlyGenerated:P,resolvedPathname:S,clientReferenceManifest:j,serverActionsManifest:O}=x,T=(0,l.normalizeAppPath)(v),D=!!(N.dynamicRoutes[T]||N.routes[S]),q=async()=>((null==I?void 0:I.render404)?await I.render404(e,t,C,!1):t.end("This page could not be found"),null);if(D&&!E){let e=!!N.routes[S],t=N.dynamicRoutes[T];if(t&&!1===t.fallback&&!e){if(A.experimental.adapterPath)return await q();throw new f.NoFallbackError}}let U=null;!D||w.isDev||E||(U="/index"===(U=S)?"/":U);let M=!0===w.isDev||!D,H=D&&!M;O&&j&&(0,i.setReferenceManifestsSingleton)({page:v,clientReferenceManifest:j,serverActionsManifest:O,serverModuleMap:(0,o.createServerModuleMap)({serverActionsManifest:O})});let L=e.method||"GET",$=(0,n.getTracer)(),F=$.getActiveScopeSpan(),K={params:y,prerenderManifest:N,renderOpts:{experimental:{authInterrupts:!!A.experimental.authInterrupts},cacheComponents:!!A.cacheComponents,supportsDynamicResponse:M,incrementalCache:(0,s.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:A.cacheLife,waitUntil:a.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,r,a)=>w.onRequestError(e,t,a,I)},sharedContext:{buildId:R}},B=new d.NodeNextRequest(e),X=new d.NodeNextResponse(t),G=p.NextRequestAdapter.fromNodeNextRequest(B,(0,p.signalFromNodeResponse)(t));try{let i=async e=>w.handle(G,K).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let r=$.getRootSpanAttributes();if(!r)return;if(r.get("next.span_type")!==u.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${r.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let a=r.get("next.route");if(a){let t=`${L} ${a}`;e.setAttributes({"next.route":a,"http.route":a,"next.span_name":t}),e.updateName(t)}else e.updateName(`${L} ${v}`)}),o=!!(0,s.getRequestMeta)(e,"minimalMode"),l=async s=>{var n,l;let d=async({previousCacheEntry:r})=>{try{if(!o&&k&&P&&!r)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let n=await i(s);e.fetchMetrics=K.renderOpts.fetchMetrics;let l=K.renderOpts.pendingWaitUntil;l&&a.waitUntil&&(a.waitUntil(l),l=void 0);let d=K.renderOpts.collectedTags;if(!D)return await (0,m.sendResponse)(B,X,n,K.renderOpts.pendingWaitUntil),null;{let e=await n.blob(),t=(0,h.toNodeOutgoingHttpHeaders)(n.headers);d&&(t[_.NEXT_CACHE_TAGS_HEADER]=d),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let r=void 0!==K.renderOpts.collectedRevalidate&&!(K.renderOpts.collectedRevalidate>=_.INFINITE_CACHE)&&K.renderOpts.collectedRevalidate,a=void 0===K.renderOpts.collectedExpire||K.renderOpts.collectedExpire>=_.INFINITE_CACHE?void 0:K.renderOpts.collectedExpire;return{value:{kind:b.CachedRouteKind.APP_ROUTE,status:n.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:r,expire:a}}}}catch(t){throw(null==r?void 0:r.isStale)&&await w.onRequestError(e,t,{routerKind:"App Router",routePath:v,routeType:"route",revalidateReason:(0,c.getRevalidateReason)({isStaticGeneration:H,isOnDemandRevalidate:k})},I),t}},p=await w.handleResponse({req:e,nextConfig:A,cacheKey:U,routeKind:r.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:N,isRoutePPREnabled:!1,isOnDemandRevalidate:k,revalidateOnlyGenerated:P,responseGenerator:d,waitUntil:a.waitUntil,isMinimalMode:o});if(!D)return null;if((null==p||null==(n=p.value)?void 0:n.kind)!==b.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==p||null==(l=p.value)?void 0:l.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});o||t.setHeader("x-nextjs-cache",k?"REVALIDATED":p.isMiss?"MISS":p.isStale?"STALE":"HIT"),E&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let u=(0,h.fromNodeOutgoingHttpHeaders)(p.value.headers);return o&&D||u.delete(_.NEXT_CACHE_TAGS_HEADER),!p.cacheControl||t.getHeader("Cache-Control")||u.get("Cache-Control")||u.set("Cache-Control",(0,g.getCacheControlHeader)(p.cacheControl)),await (0,m.sendResponse)(B,X,new Response(p.value.body,{headers:u,status:p.value.status||200})),null};F?await l(F):await $.withPropagatedContext(e.headers,()=>$.trace(u.BaseServerSpan.handleRequest,{spanName:`${L} ${v}`,kind:n.SpanKind.SERVER,attributes:{"http.method":L,"http.target":e.url}},l))}catch(t){if(t instanceof f.NoFallbackError||await w.onRequestError(e,t,{routerKind:"App Router",routePath:T,routeType:"route",revalidateReason:(0,c.getRevalidateReason)({isStaticGeneration:H,isOnDemandRevalidate:k})}),D)throw t;return await (0,m.sendResponse)(B,X,new Response(null,{status:500})),null}}e.s(["handler",()=>k,"patchFetch",()=>I,"routeModule",()=>w,"serverHooks",()=>N,"workAsyncStorage",()=>C,"workUnitAsyncStorage",()=>E],492709)},234177,e=>{e.v(t=>Promise.all(["server/chunks/[externals]_node:inspector_7a4283c6._.js"].map(t=>e.l(t))).then(()=>t(237221)))},171374,e=>{e.v(t=>Promise.all(["server/chunks/a9bf9_@opentelemetry_resources_build_esm_detectors_platform_node_machine-id_5fd8c034._.js"].map(t=>e.l(t))).then(()=>t(993759)))},556544,e=>{e.v(t=>Promise.all(["server/chunks/0bf35_build_esm_detectors_platform_node_machine-id_getMachineId-linux_6b4e949a.js"].map(t=>e.l(t))).then(()=>t(231934)))},247753,e=>{e.v(t=>Promise.all(["server/chunks/a9bf9_@opentelemetry_resources_build_esm_detectors_platform_node_machine-id_559309af._.js"].map(t=>e.l(t))).then(()=>t(380191)))},110998,e=>{e.v(t=>Promise.all(["server/chunks/a9bf9_@opentelemetry_resources_build_esm_detectors_platform_node_machine-id_3c882e41._.js"].map(t=>e.l(t))).then(()=>t(403191)))},748044,e=>{e.v(t=>Promise.all(["server/chunks/0bf35_build_esm_detectors_platform_node_machine-id_getMachineId-unsupported_c81aba5d.js"].map(t=>e.l(t))).then(()=>t(404141)))}];

//# debugId=553c1987-339f-1b1b-07a1-ed36af71202a
//# sourceMappingURL=%5Broot-of-the-server%5D__bc38d5e0._.js.map