;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="2f702be3-bdb9-5d3a-b713-867976e56af3")}catch(e){}}();
module.exports=[959171,a=>{"use strict";var b=a.i(187924),c=a.i(247290),d=a.i(566701),e=a.i(480916),f=a.i(688294),g=a.i(332938),h=a.i(397225),i=a.i(154462),j=a.i(601167);a.i(525985);var k=a.i(790355),l=a.i(831551),m=a.i(492180),n=a.i(259580),o=a.i(652167),p=a.i(832141),q=a.i(138340),r=a.i(898799),s=a.i(200610),t=a.i(937859),u=a.i(155668),v=a.i(727348),w=a.i(572131),x=a.i(992539),y=a.i(305856),z=a.i(173029);a.i(95688);var A=a.i(775424),B=a.i(257759),C=a.i(255145),D=a.i(151342);function E(a){let b="PENDING";"Approved"===a.status?b="APPROVED":"Declined"===a.status?b="REJECTED":"PendingApproval"===a.status&&(b="PENDING");let c=a.riskLevel.toUpperCase(),d="MEDIUM";return"Urgent"===a.priority?d="URGENT":"High"===a.priority?d="HIGH":"Low"===a.priority&&(d="LOW"),{id:a.id,applicationId:a.applicationId,companyName:a.applicantName||"Unknown",entityType:a.entityType||"Unknown",riskLevel:c,status:b,requestedBy:a.assignedToName||"System",requestedDate:a.createdAt,dueDate:a.dueDate,approver:a.approvedByName,approvedDate:a.approvedAt,comments:a.rejectionReason,reason:a.requiresApproval?`Requires approval due to ${a.riskLevel} risk level`:"Approval required",priority:d,workItemNumber:a.workItemNumber}}function F(){let{condensed:a}=(0,z.useSidebar)(),[F,G]=(0,w.useState)([]),[H,I]=(0,w.useState)([]),[J,K]=(0,w.useState)(!1),[L,M]=(0,w.useState)(null),[N,O]=(0,w.useState)(""),[P,Q]=(0,w.useState)("ALL"),[R,S]=(0,w.useState)(null),[T,U]=(0,w.useState)(""),[V,W]=(0,w.useState)(!1),[X,Y]=(0,w.useState)(0),Z=(0,w.useCallback)(async()=>{try{K(!0),M(null),C.logger.debug("[Approvals Page] Loading approvals...");let a=(await (0,A.fetchPendingApprovals)(1,100)).items.map(E),[b,c,d]=await Promise.all([(0,B.getWorkItems)({page:1,pageSize:100}),(0,B.getWorkItems)({status:"Completed",page:1,pageSize:100}),(0,B.getWorkItems)({status:"Declined",page:1,pageSize:100})]),e=[...a,...b.items.map(E),...c.items.map(E),...d.items.map(E)],f=Array.from(new Map(e.map(a=>[a.id,a])).values());I(f),G(f),C.logger.debug("[Approvals Page] Approvals loaded",{count:f.length})}catch(a){M(a instanceof Error?a.message:"Failed to load approvals"),C.logger.error(a,"[Approvals Page] Error loading approvals",{tags:{error_type:"approvals_load_error"}})}finally{K(!1)}},[]);(0,w.useEffect)(()=>{Z()},[Z,X]);let $=(0,w.useCallback)(a=>{O(a)},[]),_=a=>{switch(a){case"PENDING":return"orange";case"APPROVED":return"green";case"REJECTED":return"red";case"REQUIRES_CHANGES":return"yellow";default:return"gray"}},aa=a=>{switch(a){case"LOW":return"green";case"MEDIUM":return"orange";case"HIGH":case"CRITICAL":return"red";default:return"gray"}},ab=async(a,b)=>{if(R)try{W(!0),D.SweetAlert.loading("APPROVED"===b?"Approving...":"Rejecting...","Please wait while we process your request."),"APPROVED"===b?await (0,A.approveWorkItemUseCase)(a,T||void 0):await (0,A.declineWorkItemUseCase)(a,T||"Rejected by approver"),D.SweetAlert.close(),await D.SweetAlert.success("APPROVED"===b?"Approved!":"Rejected!",`The approval request has been ${"APPROVED"===b?"approved":"rejected"} successfully.`),Y(a=>a+1),S(null),U("")}catch(c){D.SweetAlert.close();let a=c instanceof Error?c.message:`Failed to ${"APPROVED"===b?"approve":"reject"} approval`;M(a),C.logger.error(c,`[Approvals Page] Error ${"APPROVED"===b?"approving":"rejecting"} approval`,{tags:{error_type:"approval_action_error",action:b}}),await D.SweetAlert.error("APPROVED"===b?"Approval Failed":"Rejection Failed",a)}finally{W(!1)}},ac=F.filter(a=>{let b=a.companyName.toLowerCase().includes(N.toLowerCase())||a.applicationId.toLowerCase().includes(N.toLowerCase())||a.workItemNumber&&a.workItemNumber.toLowerCase().includes(N.toLowerCase()),c="ALL"===P||a.status===P;return b&&c}),ad=H.filter(a=>"PENDING"===a.status).length,ae=H.filter(a=>"APPROVED"===a.status).length,af=H.filter(a=>"REJECTED"===a.status).length,ag=H.filter(a=>"REQUIRES_CHANGES"===a.status).length,ah=H.filter(a=>"URGENT"===a.priority&&"PENDING"===a.status).length,ai=H.filter(a=>"PENDING"===a.status&&new Date(a.dueDate)<new Date).length,aj=[{field:"companyName",header:"Company Name",width:"200px",minWidth:"200px",render:(a,c)=>(0,b.jsx)(l.Typography,{fontWeight:"medium",color:"gray.800",children:c.companyName})},{field:"applicationId",header:"Application ID",width:"200px",minWidth:"200px",render:(a,c)=>(0,b.jsxs)(l.Typography,{color:"gray.600",fontSize:"xs",children:[c.applicationId,c.workItemNumber&&` • ${c.workItemNumber}`]})},{field:"riskLevel",header:"Risk Level",width:"120px",minWidth:"120px",render:(a,c)=>(0,b.jsx)(n.Tag,{variant:"red"===aa(c.riskLevel)?"danger":"orange"===aa(c.riskLevel)?"warning":"info",children:c.riskLevel})},{field:"status",header:"Status",width:"120px",minWidth:"120px",render:(a,c)=>(0,b.jsx)(n.Tag,{variant:"green"===_(c.status)?"success":"red"===_(c.status)?"danger":"orange"===_(c.status)?"warning":"info",children:c.status.replace("_"," ")})},{field:"dueDate",header:"Due Date",width:"120px",minWidth:"120px",render:(a,c)=>(0,b.jsxs)(l.Typography,{fontSize:"xs",fontWeight:"medium",color:new Date(c.dueDate)<new Date&&"PENDING"===c.status?"red.600":"gray.600",children:[new Date(c.dueDate).toLocaleDateString(),new Date(c.dueDate)<new Date&&"PENDING"===c.status&&(0,b.jsx)(l.Typography,{as:"span",color:"red.500",ml:"1",fontSize:"xs",children:"⚠"})]})}];return(0,b.jsxs)(h.Flex,{minH:"100vh",bg:"gray.50",children:[(0,b.jsx)(x.default,{}),(0,b.jsxs)(c.Box,{ml:a?"72px":"280px",mt:"90px",minH:"calc(100vh - 90px)",width:a?"calc(100% - 72px)":"calc(100% - 280px)",bg:"gray.50",overflowX:"hidden",transition:"margin-left 0.3s ease, width 0.3s ease",children:[(0,b.jsx)(y.default,{}),(0,b.jsx)(d.Container,{maxW:"100%",px:"8",py:"6",width:"full",children:(0,b.jsxs)(e.VStack,{gap:"4",align:"stretch",children:[(0,b.jsxs)(h.Flex,{justify:"space-between",align:"center",mb:"4",children:[(0,b.jsxs)(e.VStack,{align:"start",gap:"1",children:[(0,b.jsx)(l.Typography,{fontSize:"3xl",fontWeight:"bold",color:"gray.800",children:"Approvals"}),(0,b.jsx)(l.Typography,{color:"gray.600",children:"Senior management approval workflow"})]}),(0,b.jsxs)(m.Button,{variant:"secondary",size:"sm",onClick:()=>Y(a=>a+1),className:"mukuru-primary-button",children:[(0,b.jsx)(q.IconWrapper,{children:(0,b.jsx)(v.FiFilter,{size:16})}),"Refresh"]})]}),L&&(0,b.jsx)(o.AlertBar,{status:"error",title:"Error loading approvals",children:L}),(ah>0||ai>0)&&(0,b.jsxs)(o.AlertBar,{status:"warning",title:"Urgent Approvals Required",children:[ah," urgent and ",ai," overdue approvals need immediate attention"]}),(0,b.jsxs)(g.SimpleGrid,{columns:{base:1,md:4},gap:"4",children:[(0,b.jsx)(r.Card,{bg:"white",p:"4",children:(0,b.jsxs)(h.Flex,{gap:"4",align:"center",children:[(0,b.jsx)(j.Avatar.Root,{bg:"orange.100",size:"md",display:"flex",alignItems:"center",justifyContent:"center",children:(0,b.jsx)(q.IconWrapper,{children:(0,b.jsx)(v.FiClock,{size:20,color:"#DD6B20"})})}),(0,b.jsxs)(e.VStack,{align:"start",gap:"0",flex:"1",children:[(0,b.jsx)(l.Typography,{fontSize:"sm",color:"gray.600",children:"Pending Approval"}),(0,b.jsx)(l.Typography,{fontSize:"30px",fontWeight:"bold",color:"orange.600",fontFamily:"Madera, sans-serif",children:ad})]}),(0,b.jsx)(u.ChevronRightIcon,{})]})}),(0,b.jsx)(r.Card,{bg:"white",p:"4",children:(0,b.jsxs)(h.Flex,{gap:"4",align:"center",children:[(0,b.jsx)(j.Avatar.Root,{bg:"green.100",size:"md",display:"flex",alignItems:"center",justifyContent:"center",children:(0,b.jsx)(q.IconWrapper,{children:(0,b.jsx)(v.FiCheckCircle,{size:20,color:"#38A169"})})}),(0,b.jsxs)(e.VStack,{align:"start",gap:"0",flex:"1",children:[(0,b.jsx)(l.Typography,{fontSize:"sm",color:"gray.600",children:"Approved"}),(0,b.jsx)(l.Typography,{fontSize:"30px",fontWeight:"bold",color:"green.600",fontFamily:"Madera, sans-serif",children:ae})]}),(0,b.jsx)(u.ChevronRightIcon,{})]})}),(0,b.jsx)(r.Card,{bg:"white",p:"4",children:(0,b.jsxs)(h.Flex,{gap:"4",align:"center",children:[(0,b.jsx)(j.Avatar.Root,{bg:"red.100",size:"md",display:"flex",alignItems:"center",justifyContent:"center",children:(0,b.jsx)(q.IconWrapper,{children:(0,b.jsx)(v.FiXCircle,{size:20,color:"#E53E3E"})})}),(0,b.jsxs)(e.VStack,{align:"start",gap:"0",flex:"1",children:[(0,b.jsx)(l.Typography,{fontSize:"sm",color:"gray.600",children:"Rejected"}),(0,b.jsx)(l.Typography,{fontSize:"30px",fontWeight:"bold",color:"red.600",fontFamily:"Madera, sans-serif",children:af})]}),(0,b.jsx)(u.ChevronRightIcon,{})]})}),(0,b.jsx)(r.Card,{bg:"white",p:"4",children:(0,b.jsxs)(h.Flex,{gap:"4",align:"center",children:[(0,b.jsx)(j.Avatar.Root,{bg:"blue.100",size:"md",display:"flex",alignItems:"center",justifyContent:"center",children:(0,b.jsx)(q.IconWrapper,{children:(0,b.jsx)(v.FiEdit,{size:20,color:"#3182CE"})})}),(0,b.jsxs)(e.VStack,{align:"start",gap:"0",flex:"1",children:[(0,b.jsx)(l.Typography,{fontSize:"sm",color:"gray.600",children:"Requires Changes"}),(0,b.jsx)(l.Typography,{fontSize:"30px",fontWeight:"bold",color:"blue.600",fontFamily:"Madera, sans-serif",children:ag})]}),(0,b.jsx)(u.ChevronRightIcon,{})]})})]}),(0,b.jsx)(f.HStack,{gap:"2",mb:"2",children:["ALL","PENDING","APPROVED","REJECTED","REQUIRES_CHANGES"].map(a=>(0,b.jsx)(m.Button,{variant:"primary",onClick:()=>Q(a),className:"mukuru-primary-button",style:{opacity:P===a?1:.7},children:"ALL"===a?"All":"REQUIRES_CHANGES"===a?"Requires Changes":a},a))}),(0,b.jsx)(c.Box,{width:"100%",maxW:"800px",children:(0,b.jsx)(k.Search,{placeholder:"Search by company name or application ID...",onSearchChange:$})}),(0,b.jsx)(c.Box,{className:"work-queue-table-wrapper",width:"100%",children:(0,b.jsx)(s.DataTable,{data:ac,columns:aj,actionColumn:{header:"Actions",width:"200px",render:a=>(0,b.jsxs)(f.HStack,{gap:"2",children:[(0,b.jsx)(t.Tooltip,{content:"View Application",children:(0,b.jsxs)("button",{onClick:()=>window.location.href=`/applications/${a.applicationId}`,style:{padding:"6px 12px",borderRadius:"6px",border:"1px solid #E5E7EB",backgroundColor:"white",color:"#111827",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},children:[(0,b.jsx)(q.IconWrapper,{children:(0,b.jsx)(v.FiUser,{size:14})}),"View"]})}),"PENDING"===a.status&&(0,b.jsx)(t.Tooltip,{content:"Review & Approve",children:(0,b.jsx)("button",{onClick:()=>S(a),style:{padding:"6px 12px",borderRadius:"6px",border:"none",backgroundColor:"#F05423",color:"white",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},children:"Review & Approve"})})]})},loading:J})})]})})]}),(0,b.jsxs)(p.Modal,{isOpen:!!R,onClose:()=>{S(null),U("")},title:"Review Approval Request",size:"small",closeOnBackdropClick:!0,closeOnEsc:!0,children:[(0,b.jsx)(p.ModalHeader,{children:(0,b.jsx)(l.Typography,{fontSize:"lg",fontWeight:"bold",color:"gray.800",children:"Review Approval Request"})}),(0,b.jsx)(p.ModalBody,{children:(0,b.jsxs)(e.VStack,{gap:"4",align:"stretch",children:[(0,b.jsxs)(c.Box,{children:[(0,b.jsxs)(l.Typography,{fontSize:"sm",fontWeight:"medium",color:"gray.700",mb:"2",children:["Company: ",R?.companyName]}),(0,b.jsxs)(l.Typography,{fontSize:"sm",fontWeight:"medium",color:"gray.700",mb:"2",children:["Application: ",R?.applicationId]}),(0,b.jsxs)(l.Typography,{fontSize:"sm",fontWeight:"medium",color:"gray.700",mb:"2",children:["Reason: ",R?.reason]})]}),(0,b.jsx)(i.Textarea,{placeholder:"Add your comments...",value:T,onChange:a=>U(a.target.value),rows:3})]})}),(0,b.jsx)(p.ModalFooter,{children:(0,b.jsxs)(f.HStack,{justify:"space-between",w:"full",children:[(0,b.jsx)(m.Button,{variant:"secondary",onClick:()=>{S(null),U("")},disabled:V,children:"Cancel"}),(0,b.jsxs)(f.HStack,{gap:"2",children:[(0,b.jsxs)(m.Button,{variant:"primary",className:"mukuru-primary-button",onClick:()=>R&&ab(R.id,"REJECTED"),disabled:V,children:[(0,b.jsx)(q.IconWrapper,{children:(0,b.jsx)(v.FiXCircle,{size:16})}),"Reject"]}),(0,b.jsxs)(m.Button,{variant:"primary",className:"mukuru-primary-button",onClick:()=>R&&ab(R.id,"APPROVED"),disabled:V,children:[(0,b.jsx)(q.IconWrapper,{children:(0,b.jsx)(v.FiCheckCircle,{size:16})}),"Approve"]})]})]})})]})]})}a.s(["default",()=>F])}];

//# debugId=2f702be3-bdb9-5d3a-b713-867976e56af3
//# sourceMappingURL=src_app_approvals_page_tsx_008285f5._.js.map