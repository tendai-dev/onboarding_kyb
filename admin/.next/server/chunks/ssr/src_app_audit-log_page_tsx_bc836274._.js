;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="a727725e-dcf3-bf6a-ad31-0dbabc05d5ef")}catch(e){}}();
module.exports=[214586,a=>{"use strict";var b=a.i(187924),c=a.i(247290),d=a.i(480916),e=a.i(688294),f=a.i(332938),g=a.i(397225),h=a.i(15631);a.i(525985);var i=a.i(790355),j=a.i(831551),k=a.i(138340),l=a.i(572131),m=a.i(992539),n=a.i(727348),o=a.i(718402);let p=new class{async getAuthHeaders(){let a=await (0,o.getSession)(),b={"Content-Type":"application/json"};return a?.user?.email&&(b["X-User-Email"]=a.user.email),a?.user?.name&&(b["X-User-Name"]=a.user.name),b}async request(a,b){let c=`http://localhost:8011${a}`,d=await this.getAuthHeaders();try{let a=new Promise((a,b)=>{setTimeout(()=>b(Error("Request timeout")),1e4)}),e=fetch(c,{...b,headers:{...d,...b?.headers}}),f=await Promise.race([e,a]);if(!f.ok){let a=await f.text(),b=`Audit Log API request failed: ${f.status} ${f.statusText}`;try{let c=JSON.parse(a);c.message?b=c.message:c.error&&(b=c.error)}catch{a&&a.trim().length>0&&(b=a.length>200?a.substring(0,200)+"...":a)}throw Error(b)}if(204===f.status)return null;return f.json()}catch(a){if(a instanceof TypeError||a instanceof Error&&a.message.includes("timeout"))throw Error("Unable to connect to Audit Log service");throw a}}async getAuditLogEntry(a){return this.request(`/api/v1/audit-logs/${a}`)}async getAuditLogsByEntity(a,b){return this.request(`/api/v1/audit-logs/entity/${encodeURIComponent(a)}/${encodeURIComponent(b)}`)}async getAuditLogsByCase(a){return this.request(`/api/v1/audit-logs/case/${encodeURIComponent(a)}`)}async searchAuditLogs(a){return this.request("/api/v1/audit-logs/search",{method:"POST",body:JSON.stringify(a)})}async getAllAuditLogs(a=0,b=100){return this.searchAuditLogs({skip:a,take:b})}};function q(){let[a,o]=(0,l.useState)(""),[q,r]=(0,l.useState)([]),[s,t]=(0,l.useState)({totalEvents:0,created:0,updated:0,approved:0}),[u,v]=(0,l.useState)(!0),[w,x]=(0,l.useState)(null),y=(0,l.useCallback)(a=>{let b=a.length,c=a.filter(a=>a.action.toUpperCase().includes("CREATE")||"CREATE"===a.action.toUpperCase()).length;return{totalEvents:b,created:c,updated:a.filter(a=>a.action.toUpperCase().includes("UPDATE")||"UPDATE"===a.action.toUpperCase()).length,approved:a.filter(a=>a.action.toUpperCase().includes("APPROVE")||"APPROVE"===a.action.toUpperCase()).length}},[]),z=(0,l.useCallback)(async a=>{v(!0),x(null);try{let b;if(a&&a.trim()){let c=a.toLowerCase(),d=(b=await p.searchAuditLogs({skip:0,take:1e3})).entries.filter(a=>a.action.toLowerCase().includes(c)||a.entityType.toLowerCase().includes(c)||a.entityId.toLowerCase().includes(c)||a.userId.toLowerCase().includes(c)||a.description.toLowerCase().includes(c));b.entries=d,b.totalCount=d.length}else b=await p.getAllAuditLogs(0,1e3);let c=b.entries.sort((a,b)=>new Date(b.timestamp).getTime()-new Date(a.timestamp).getTime());r(c),t(y(c))}catch(a){console.error("Error fetching audit logs:",a),x(a instanceof Error?a.message:"Failed to load audit logs. Please ensure the audit log service is running."),r([]),t({totalEvents:0,created:0,updated:0,approved:0})}finally{v(!1)}},[y]);return(0,l.useEffect)(()=>{z()},[]),(0,b.jsxs)(g.Flex,{minH:"100vh",bg:"gray.50",children:[(0,b.jsx)(m.default,{}),(0,b.jsxs)(c.Box,{flex:"1",ml:"240px",children:[(0,b.jsx)(c.Box,{bg:"white",borderBottom:"1px",borderColor:"gray.200",py:"4",px:"6",boxShadow:"sm",children:(0,b.jsx)(j.Typography,{fontSize:"xl",fontWeight:"bold",color:"gray.900",children:"Audit Log"})}),(0,b.jsx)(c.Box,{p:"6",bg:"gray.50",children:(0,b.jsxs)(d.VStack,{gap:"6",align:"stretch",children:[(0,b.jsxs)(c.Box,{children:[(0,b.jsxs)(g.Flex,{justify:"space-between",align:"start",mb:"4",children:[(0,b.jsxs)(d.VStack,{align:"start",gap:"2",children:[(0,b.jsxs)(e.HStack,{gap:"2",children:[(0,b.jsx)(n.FiShield,{size:20,color:"#374151"}),(0,b.jsx)(j.Typography,{fontSize:"xl",fontWeight:"bold",color:"gray.900",children:"Audit Trail"})]}),(0,b.jsx)(j.Typography,{fontSize:"md",color:"gray.600",fontWeight:"medium",children:"Complete history of all system activities and changes"})]}),(0,b.jsx)(c.Box,{width:"300px",children:(0,b.jsx)(i.Search,{placeholder:"Search audit events...",onSearchChange:a=>{o(a),z(a)}})})]}),(0,b.jsxs)(f.SimpleGrid,{columns:{base:1,md:2,lg:4},gap:"6",children:[(0,b.jsx)(c.Box,{bg:"white",p:"6",borderRadius:"xl",boxShadow:"0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06)",border:"1px",borderColor:"gray.100",_hover:{boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)"},transition:"all 0.2s",children:(0,b.jsx)(d.VStack,{align:"start",gap:"4",children:(0,b.jsxs)(e.HStack,{gap:"3",children:[(0,b.jsx)(c.Box,{p:"2",bg:"blue.50",borderRadius:"lg",children:(0,b.jsx)(n.FiTrendingUp,{size:20,color:"#3182ce"})}),(0,b.jsxs)(d.VStack,{align:"start",gap:"1",children:[(0,b.jsx)(j.Typography,{fontSize:"3xl",fontWeight:"bold",color:"gray.900",children:s.totalEvents}),(0,b.jsx)(j.Typography,{fontSize:"sm",color:"gray.600",fontWeight:"medium",children:"Total Events"})]})]})})}),(0,b.jsx)(c.Box,{bg:"white",p:"6",borderRadius:"xl",boxShadow:"0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06)",border:"1px",borderColor:"gray.100",_hover:{boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)"},transition:"all 0.2s",children:(0,b.jsx)(d.VStack,{align:"start",gap:"4",children:(0,b.jsxs)(e.HStack,{gap:"3",children:[(0,b.jsx)(c.Box,{p:"2",bg:"green.50",borderRadius:"lg",children:(0,b.jsx)(n.FiTrendingUp,{size:20,color:"#38a169"})}),(0,b.jsxs)(d.VStack,{align:"start",gap:"1",children:[(0,b.jsx)(j.Typography,{fontSize:"3xl",fontWeight:"bold",color:"green.500",children:s.created}),(0,b.jsx)(j.Typography,{fontSize:"sm",color:"gray.600",fontWeight:"medium",children:"Created"})]})]})})}),(0,b.jsx)(c.Box,{bg:"white",p:"6",borderRadius:"xl",boxShadow:"0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06)",border:"1px",borderColor:"gray.100",_hover:{boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)"},transition:"all 0.2s",children:(0,b.jsx)(d.VStack,{align:"start",gap:"4",children:(0,b.jsxs)(e.HStack,{gap:"3",children:[(0,b.jsx)(c.Box,{p:"2",bg:"orange.50",borderRadius:"lg",children:(0,b.jsx)(n.FiTrendingUp,{size:20,color:"#dd6b20"})}),(0,b.jsxs)(d.VStack,{align:"start",gap:"1",children:[(0,b.jsx)(j.Typography,{fontSize:"3xl",fontWeight:"bold",color:"orange.500",children:s.updated}),(0,b.jsx)(j.Typography,{fontSize:"sm",color:"gray.600",fontWeight:"medium",children:"Updated"})]})]})})}),(0,b.jsx)(c.Box,{bg:"white",p:"6",borderRadius:"xl",boxShadow:"0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06)",border:"1px",borderColor:"gray.100",_hover:{boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)"},transition:"all 0.2s",children:(0,b.jsx)(d.VStack,{align:"start",gap:"4",children:(0,b.jsxs)(e.HStack,{gap:"3",children:[(0,b.jsx)(c.Box,{p:"2",bg:"purple.50",borderRadius:"lg",children:(0,b.jsx)(n.FiTrendingUp,{size:20,color:"#805ad5"})}),(0,b.jsxs)(d.VStack,{align:"start",gap:"1",children:[(0,b.jsx)(j.Typography,{fontSize:"3xl",fontWeight:"bold",color:"purple.500",children:s.approved}),(0,b.jsx)(j.Typography,{fontSize:"sm",color:"gray.600",fontWeight:"medium",children:"Approved"})]})]})})})]})]}),(0,b.jsxs)(c.Box,{children:[(0,b.jsxs)(d.VStack,{align:"start",gap:"2",mb:"6",children:[(0,b.jsx)(j.Typography,{fontSize:"2xl",fontWeight:"bold",color:"gray.800",children:"Activity Log"}),(0,b.jsx)(j.Typography,{fontSize:"lg",color:"gray.600",children:"Append-only record of all actions performed in the system"})]}),(0,b.jsxs)(c.Box,{bg:"white",borderRadius:"lg",boxShadow:"sm",border:"1px",borderColor:"gray.200",overflow:"hidden",children:[(0,b.jsx)(c.Box,{bg:"gray.50",p:"4",borderBottom:"1px",borderColor:"gray.200",children:(0,b.jsxs)(e.HStack,{gap:"4",fontSize:"sm",fontWeight:"medium",color:"gray.600",children:[(0,b.jsx)(c.Box,{width:"200px",children:"Timestamp"}),(0,b.jsx)(c.Box,{width:"200px",children:"Actor"}),(0,b.jsx)(c.Box,{width:"150px",children:"Action"}),(0,b.jsx)(c.Box,{width:"100px",children:"Entity"}),(0,b.jsx)(c.Box,{width:"100px",children:"Entity ID"})]})}),u?(0,b.jsx)(c.Box,{p:"8",display:"flex",justifyContent:"center",children:(0,b.jsxs)(d.VStack,{gap:"2",children:[(0,b.jsx)(h.Spinner,{size:"md",color:"orange.500"}),(0,b.jsx)(j.Typography,{color:"gray.600",fontSize:"sm",children:"Loading audit logs..."})]})}):w?(0,b.jsx)(c.Box,{p:"8",children:(0,b.jsx)(c.Box,{bg:"red.50",border:"1px",borderColor:"red.200",borderRadius:"md",p:"4",children:(0,b.jsxs)(e.HStack,{gap:"2",children:[(0,b.jsx)(k.IconWrapper,{children:(0,b.jsx)(n.FiAlertCircle,{size:20,color:"#E53E3E"})}),(0,b.jsxs)(d.VStack,{align:"start",gap:"1",flex:"1",children:[(0,b.jsx)(j.Typography,{fontWeight:"semibold",color:"red.700",children:"Error loading audit logs"}),(0,b.jsx)(j.Typography,{fontSize:"sm",color:"red.600",children:w})]})]})})}):0===q.length?(0,b.jsx)(c.Box,{p:"8",textAlign:"center",children:(0,b.jsx)(j.Typography,{color:"gray.500",children:"No audit log entries found."})}):(0,b.jsx)(d.VStack,{gap:"0",align:"stretch",children:q.map((a,d)=>{let f,g=(f=a.action.toUpperCase()).includes("CREATE")?{bg:"green.100",color:"green.700"}:f.includes("UPDATE")?{bg:"blue.100",color:"blue.700"}:f.includes("APPROVE")?{bg:"purple.100",color:"purple.700"}:f.includes("DELETE")?{bg:"red.100",color:"red.700"}:{bg:"gray.100",color:"gray.700"};return(0,b.jsx)(c.Box,{p:"4",borderBottom:d<q.length-1?"1px":"none",borderColor:"gray.100",_hover:{bg:"gray.50"},children:(0,b.jsxs)(e.HStack,{gap:"4",fontSize:"sm",children:[(0,b.jsx)(c.Box,{width:"200px",children:(0,b.jsx)(j.Typography,{color:"gray.600",children:new Date(a.timestamp).toLocaleString()})}),(0,b.jsxs)(c.Box,{width:"200px",children:[(0,b.jsx)(j.Typography,{color:"gray.800",fontWeight:"medium",children:a.userId||"System"}),a.userRole&&(0,b.jsx)(j.Typography,{color:"gray.500",fontSize:"xs",children:a.userRole})]}),(0,b.jsx)(c.Box,{width:"150px",children:(0,b.jsx)(c.Box,{bg:g.bg,color:g.color,fontSize:"xs",fontWeight:"medium",px:"2",py:"1",borderRadius:"sm",display:"inline-block",children:a.action})}),(0,b.jsx)(c.Box,{width:"100px",children:(0,b.jsx)(j.Typography,{color:"gray.600",children:a.entityType})}),(0,b.jsx)(c.Box,{width:"100px",children:(0,b.jsx)(j.Typography,{color:"gray.600",fontFamily:"mono",fontSize:"xs",children:a.entityId})})]})},a.id)})})]})]})]})})]})]})}a.s(["default",()=>q],214586)}];

//# debugId=a727725e-dcf3-bf6a-ad31-0dbabc05d5ef
//# sourceMappingURL=src_app_audit-log_page_tsx_bc836274._.js.map