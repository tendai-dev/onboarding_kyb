;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="5bde7594-6d9b-ae68-f495-9594884ed738")}catch(e){}}();
module.exports=[478109,a=>{"use strict";var b=a.i(187924),c=a.i(247290),d=a.i(566701),e=a.i(480916),f=a.i(688294),g=a.i(332938),h=a.i(397225),i=a.i(15631);a.i(525985);var j=a.i(831551),k=a.i(492180),l=a.i(790932),m=a.i(259580),n=a.i(138340),o=a.i(727348),p=a.i(572131),q=a.i(992539),r=a.i(151342),s=a.i(718402);let t=process.env.MIGRATION_API_BASE_URL||process.env.ONBOARDING_API_BASE_URL||"http://127.0.0.1:8001",u=new class{async request(a,b={}){let c=await (0,s.getSession)(),d={"Content-Type":"application/json",...b.headers||{}};c?.user?.email&&(d["X-User-Email"]=c.user.email),c?.user?.name&&(d["X-User-Name"]=c.user.name);let e=await fetch(a,{...b,headers:d});if(!e.ok){let a;try{a=await e.json()}catch{a={error:await e.text().catch(()=>"Unknown error")||`HTTP ${e.status}: ${e.statusText}`}}let b=a.error||a.details||`HTTP ${e.status}: ${e.statusText}`;throw Error(a.details?`${b} - ${a.details}`:b)}return e.json()}async getMigrationJobs(){let a=`${t}`;return this.request(a)}async getMigrationJob(a){let b=`${t}/${a}`;return this.request(b)}async startMigration(a,b,c,d){let e=`${t}/start`,f=new FormData;f.append("name",a),f.append("entityType",b),f.append("file",c),d&&f.append("source",d);let g=await (0,s.getSession)(),h={};g?.user?.email&&(h["X-User-Email"]=g.user.email),g?.user?.name&&(h["X-User-Name"]=g.user.name);let i=await fetch(e,{method:"POST",headers:h,body:f});if(!i.ok)throw Error((await i.json().catch(()=>({error:"Unknown error"}))).error||`HTTP ${i.status}: ${i.statusText}`);return i.json()}};var v=a.i(495964),w=a.i(25065);function x(){let[a,s]=(0,p.useState)([]),[t,x]=(0,p.useState)([]),[y,z]=(0,p.useState)([]),[A,B]=(0,p.useState)(!0),[C,D]=(0,p.useState)(null),[E,F]=(0,p.useState)(null),[G,H]=(0,p.useState)(""),[I,J]=(0,p.useState)(""),[K,L]=(0,p.useState)(!1),M=(0,p.useRef)(null),N=async()=>{try{D(null);let a=await u.getMigrationJobs();s(a)}catch(a){console.error("Error loading migration jobs:",a),D(a instanceof Error?a.message:"Failed to load migration jobs")}},O=async()=>{try{let a=(await v.checklistApiService.getAllChecklists()).map(a=>({id:a.id,name:a.name||`${a.entityType} Checklist`,entityType:a.entityType||"Unknown",description:a.description||"",lastUpdated:a.lastUpdated||new Date().toISOString(),isActive:!0,items:a.items.map(a=>({id:a.id,description:a.description||"",isRequired:a.isRequired,category:a.category||"General"}))}));x(a)}catch(a){console.error("Error loading checklists:",a)}},P=async()=>{try{let a=await w.entityConfigApiService.getEntityTypes(!1,!1);z(a)}catch(a){console.error("Error loading entity types:",a)}};(0,p.useEffect)(()=>{(async()=>{B(!0),await Promise.all([N(),O(),P()]),B(!1)})()},[]),(0,p.useEffect)(()=>(a.some(a=>"IN_PROGRESS"===a.status.toUpperCase()||"PENDING"===a.status.toUpperCase())?M.current=setInterval(()=>{N()},5e3):M.current&&(clearInterval(M.current),M.current=null),()=>{M.current&&clearInterval(M.current)}),[a]);let Q=a=>{switch(a.toUpperCase()){case"PENDING":return"orange";case"IN_PROGRESS":return"blue";case"COMPLETED":return"green";case"FAILED":return"red";default:return"gray"}},R=a=>{if(!a)return"N/A";try{return new Date(a).toLocaleString()}catch{return a}},S=async()=>{if(!E||!G||!I)return void await r.SweetAlert.warning("Validation Error","Please fill in all fields and select a file");L(!0);try{await u.startMigration(G,I,E,E.name),await N(),F(null),H(""),J(""),await r.SweetAlert.success("Migration Started",`Migration job "${G}" has been started successfully.`),M.current||(M.current=setInterval(()=>{N()},5e3))}catch(a){console.error("Error starting migration:",a),await r.SweetAlert.error("Migration Failed",a instanceof Error?a.message:"Failed to start migration. Please try again.")}finally{L(!1)}};return A?(0,b.jsxs)(c.Box,{children:[(0,b.jsx)(q.default,{}),(0,b.jsx)(c.Box,{ml:"240px",p:"8",bg:"gray.50",minH:"100vh",children:(0,b.jsx)(h.Flex,{justify:"center",align:"center",h:"400px",children:(0,b.jsx)(i.Spinner,{size:"xl",color:"orange.500"})})})]}):(0,b.jsxs)(c.Box,{children:[(0,b.jsx)(q.default,{}),(0,b.jsx)(c.Box,{ml:"240px",p:"8",bg:"gray.50",minH:"100vh",children:(0,b.jsx)(d.Container,{maxW:"7xl",children:(0,b.jsxs)(e.VStack,{gap:"6",align:"stretch",children:[(0,b.jsxs)(h.Flex,{justify:"space-between",align:"center",children:[(0,b.jsxs)(e.VStack,{align:"start",gap:"1",children:[(0,b.jsx)(j.Typography,{fontSize:"3xl",fontWeight:"bold",color:"gray.800",children:"Data Migration"}),(0,b.jsx)(j.Typography,{color:"gray.600",children:"Import and migrate existing partner/customer data"})]}),(0,b.jsxs)(f.HStack,{gap:"3",children:[(0,b.jsxs)(k.Button,{variant:"secondary",size:"sm",onClick:N,children:[(0,b.jsx)(n.IconWrapper,{children:(0,b.jsx)(o.FiSearch,{size:16})}),"Refresh"]}),(0,b.jsxs)(k.Button,{variant:"secondary",size:"sm",children:[(0,b.jsx)(n.IconWrapper,{children:(0,b.jsx)(o.FiSettings,{size:16})}),"Migration Settings"]})]})]}),C&&(0,b.jsx)(c.Box,{bg:"red.50",p:"4",borderRadius:"md",border:"1px",borderColor:"red.200",children:(0,b.jsxs)(f.HStack,{gap:"2",children:[(0,b.jsx)(n.IconWrapper,{children:(0,b.jsx)(o.FiAlertTriangle,{size:20,color:"#E53E3E"})}),(0,b.jsxs)(e.VStack,{align:"start",gap:"1",children:[(0,b.jsx)(j.Typography,{fontWeight:"semibold",color:"red.700",children:"Error loading data"}),(0,b.jsx)(j.Typography,{fontSize:"sm",color:"red.600",children:C})]})]})}),(0,b.jsx)(c.Box,{bg:"white",p:"6",borderRadius:"lg",boxShadow:"sm",children:(0,b.jsxs)(e.VStack,{gap:"4",align:"stretch",children:[(0,b.jsxs)(h.Flex,{justify:"space-between",align:"center",children:[(0,b.jsx)(j.Typography,{fontSize:"lg",fontWeight:"semibold",color:"gray.800",children:"Migration Jobs"}),(0,b.jsxs)(k.Button,{variant:"primary",size:"sm",onClick:()=>{document.getElementById("start-migration-section")?.scrollIntoView({behavior:"smooth"})},children:[(0,b.jsx)(n.IconWrapper,{children:(0,b.jsx)(o.FiUpload,{size:16})}),"New Migration"]})]}),0===a.length?(0,b.jsx)(c.Box,{p:"8",textAlign:"center",border:"2px dashed",borderColor:"gray.300",borderRadius:"lg",bg:"gray.50",children:(0,b.jsxs)(e.VStack,{gap:"3",children:[(0,b.jsx)(n.IconWrapper,{children:(0,b.jsx)(o.FiUpload,{size:32,color:"#A0AEC0"})}),(0,b.jsx)(j.Typography,{fontSize:"md",color:"gray.600",fontWeight:"medium",children:"No migration jobs found"}),(0,b.jsx)(j.Typography,{fontSize:"sm",color:"gray.500",children:"Start a new migration to import partner/customer data"})]})}):(0,b.jsx)(g.SimpleGrid,{columns:{base:1,lg:2},gap:"4",children:a.map(a=>(0,b.jsx)(c.Box,{p:"4",border:"1px",borderColor:"gray.200",borderRadius:"lg",bg:"gray.50",children:(0,b.jsxs)(e.VStack,{gap:"3",align:"stretch",children:[(0,b.jsxs)(h.Flex,{justify:"space-between",align:"start",children:[(0,b.jsxs)(e.VStack,{align:"start",gap:"1",children:[(0,b.jsx)(j.Typography,{fontSize:"md",fontWeight:"semibold",color:"gray.800",children:a.name}),(0,b.jsx)(j.Typography,{fontSize:"xs",color:"gray.500",fontFamily:"mono",children:a.id}),(0,b.jsxs)(j.Typography,{fontSize:"sm",color:"gray.600",children:[a.entityType," â€¢ ",a.source]})]}),(0,b.jsx)(m.Tag,{variant:"red"===Q(a.status)?"danger":"green"===Q(a.status)?"success":"blue"===Q(a.status)?"info":"orange"===Q(a.status)?"warning":"inactive",children:a.status.replace(/_/g," ").replace(/\b\w/g,a=>a.toUpperCase())})]}),(0,b.jsxs)(e.VStack,{gap:"2",align:"stretch",children:[(0,b.jsxs)(f.HStack,{justify:"space-between",children:[(0,b.jsx)(j.Typography,{fontSize:"sm",color:"gray.600",children:"Progress:"}),(0,b.jsxs)(j.Typography,{fontSize:"sm",fontWeight:"medium",color:"gray.800",children:[a.progress,"%"]})]}),(0,b.jsx)(c.Box,{width:"100%",height:"6px",bg:"gray.200",borderRadius:"full",overflow:"hidden",children:(0,b.jsx)(c.Box,{width:`${a.progress}%`,height:"100%",bg:`${Q(a.status)}.400`,borderRadius:"full",transition:"width 0.3s ease"})})]}),(0,b.jsxs)(f.HStack,{justify:"space-between",fontSize:"sm",color:"gray.600",children:[(0,b.jsxs)(j.Typography,{children:["Total: ",a.totalRecords]}),(0,b.jsxs)(j.Typography,{children:["Processed: ",a.processedRecords]}),(0,b.jsxs)(j.Typography,{color:"red.600",children:["Failed: ",a.failedRecords]})]}),a.errorMessage&&(0,b.jsx)(c.Box,{bg:"red.50",p:"3",borderRadius:"md",border:"1px",borderColor:"red.200",children:(0,b.jsxs)(f.HStack,{gap:"2",children:[(0,b.jsx)(n.IconWrapper,{children:(0,b.jsx)(o.FiAlertTriangle,{size:16,color:"#E53E3E"})}),(0,b.jsx)(j.Typography,{fontSize:"sm",color:"red.700",children:a.errorMessage})]})}),(0,b.jsxs)(f.HStack,{justify:"space-between",fontSize:"xs",color:"gray.500",children:[(0,b.jsxs)(e.VStack,{align:"start",gap:"0",children:[(0,b.jsx)(j.Typography,{fontWeight:"medium",children:"Started:"}),(0,b.jsx)(j.Typography,{children:R(a.startTime)})]}),a.endTime&&(0,b.jsxs)(e.VStack,{align:"end",gap:"0",children:[(0,b.jsx)(j.Typography,{fontWeight:"medium",children:"Completed:"}),(0,b.jsx)(j.Typography,{children:R(a.endTime)})]})]})]})},a.id))})]})}),(0,b.jsx)(c.Box,{id:"start-migration-section",bg:"white",p:"6",borderRadius:"lg",boxShadow:"sm",children:(0,b.jsxs)(e.VStack,{gap:"4",align:"stretch",children:[(0,b.jsx)(j.Typography,{fontSize:"lg",fontWeight:"semibold",color:"gray.800",children:"Start New Migration"}),(0,b.jsxs)(g.SimpleGrid,{columns:{base:1,md:2},gap:"4",children:[(0,b.jsxs)(e.VStack,{gap:"3",align:"stretch",children:[(0,b.jsxs)(c.Box,{children:[(0,b.jsx)(j.Typography,{fontSize:"sm",fontWeight:"medium",color:"gray.700",mb:"2",children:"Migration Name"}),(0,b.jsx)(l.Input,{placeholder:"Enter migration name",value:G,onChange:a=>H(a.target.value)})]}),(0,b.jsxs)(c.Box,{children:[(0,b.jsx)(j.Typography,{fontSize:"sm",fontWeight:"medium",color:"gray.700",mb:"2",children:"Entity Type"}),(0,b.jsxs)("select",{value:I,onChange:a=>J(a.target.value),style:{width:"100%",padding:"8px 12px",borderRadius:"6px",border:"1px solid #E2E8F0",backgroundColor:"white",color:"#1A202C"},disabled:0===y.length,children:[(0,b.jsx)("option",{value:"",children:0===y.length?"Loading entity types...":"Select entity type"}),y.map(a=>(0,b.jsx)("option",{value:a.displayName,children:a.displayName},a.id))]}),0===y.length&&(0,b.jsx)(j.Typography,{fontSize:"xs",color:"gray.500",mt:"1",children:"No entity types found. Please configure entity types first."})]})]}),(0,b.jsxs)(e.VStack,{gap:"3",align:"stretch",children:[(0,b.jsxs)(c.Box,{children:[(0,b.jsx)(j.Typography,{fontSize:"sm",fontWeight:"medium",color:"gray.700",mb:"2",children:"Data File"}),(0,b.jsx)("input",{type:"file",accept:".csv,.xlsx,.pdf",onChange:a=>F(a.target.files?.[0]||null),style:{width:"100%",padding:"8px",borderRadius:"6px",border:"1px solid #E2E8F0",backgroundColor:"white"}})]}),(0,b.jsxs)(k.Button,{variant:"primary",onClick:S,disabled:!E||!G||!I||K,children:[(0,b.jsx)(n.IconWrapper,{children:(0,b.jsx)(o.FiUpload,{size:16})}),K?"Starting...":"Start Migration"]})]})]})]})}),(0,b.jsx)(c.Box,{bg:"white",p:"6",borderRadius:"lg",boxShadow:"sm",children:(0,b.jsxs)(e.VStack,{gap:"4",align:"stretch",children:[(0,b.jsxs)(h.Flex,{justify:"space-between",align:"center",children:[(0,b.jsx)(j.Typography,{fontSize:"lg",fontWeight:"semibold",color:"gray.800",children:"Entity Checklists"}),(0,b.jsxs)(k.Button,{variant:"secondary",size:"sm",children:[(0,b.jsx)(n.IconWrapper,{children:(0,b.jsx)(o.FiFileText,{size:16})}),(0,b.jsx)(j.Typography,{children:"Manage Checklists"})]})]}),(0,b.jsx)(g.SimpleGrid,{columns:{base:1,lg:2},gap:"4",children:t.map(a=>(0,b.jsx)(c.Box,{p:"4",border:"1px",borderColor:"gray.200",borderRadius:"lg",bg:"gray.50",children:(0,b.jsxs)(e.VStack,{gap:"3",align:"stretch",children:[(0,b.jsxs)(h.Flex,{justify:"space-between",align:"start",children:[(0,b.jsxs)(e.VStack,{align:"start",gap:"1",children:[(0,b.jsx)(j.Typography,{fontSize:"md",fontWeight:"semibold",color:"gray.800",children:a.name}),(0,b.jsx)(j.Typography,{fontSize:"sm",color:"gray.600",children:a.description})]}),(0,b.jsx)(m.Tag,{variant:a.isActive?"success":"inactive",children:a.isActive?"Active":"Inactive"})]}),(0,b.jsxs)(e.VStack,{gap:"2",align:"stretch",children:[(0,b.jsxs)(f.HStack,{justify:"space-between",children:[(0,b.jsx)(j.Typography,{fontSize:"sm",color:"gray.600",children:"Items:"}),(0,b.jsxs)(j.Typography,{fontSize:"sm",fontWeight:"medium",color:"gray.800",children:[a.items.length," items"]})]}),(0,b.jsxs)(f.HStack,{justify:"space-between",children:[(0,b.jsx)(j.Typography,{fontSize:"sm",color:"gray.600",children:"Required:"}),(0,b.jsxs)(j.Typography,{fontSize:"sm",fontWeight:"medium",color:"gray.800",children:[a.items.filter(a=>a.isRequired).length," required"]})]})]}),(0,b.jsxs)(j.Typography,{fontSize:"xs",color:"gray.500",children:["Last updated: ",new Date(a.lastUpdated).toLocaleDateString()]}),(0,b.jsxs)(f.HStack,{justify:"space-between",children:[(0,b.jsx)(k.Button,{size:"sm",variant:"secondary",children:(0,b.jsxs)(f.HStack,{gap:"2",children:[(0,b.jsx)(n.IconWrapper,{children:(0,b.jsx)(o.FiFileText,{size:16})}),(0,b.jsx)(j.Typography,{children:"View Details"})]})}),(0,b.jsxs)(k.Button,{size:"sm",variant:"secondary",children:[(0,b.jsx)(n.IconWrapper,{children:(0,b.jsx)(o.FiDownload,{size:16})}),(0,b.jsx)(j.Typography,{children:"Export"})]})]})]})},a.id))})]})})]})})})]})}a.s(["default",()=>x],478109)}];

//# debugId=5bde7594-6d9b-ae68-f495-9594884ed738
//# sourceMappingURL=src_app_data-migration_page_tsx_ab70aa6f._.js.map