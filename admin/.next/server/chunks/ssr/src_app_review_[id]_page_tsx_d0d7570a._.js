;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="4b67a917-9444-a83a-8342-55f989637996")}catch(e){}}();
module.exports=[326351,a=>{"use strict";var b=a.i(187924),c=a.i(247290),d=a.i(566701),e=a.i(480916),f=a.i(688294),g=a.i(397225),h=a.i(332938),i=a.i(154462),j=a.i(2488),k=a.i(230394),l=a.i(15631),m=a.i(547203),n=a.i(727348),o=a.i(346271),p=a.i(238246),q=a.i(50944),r=a.i(572131),s=a.i(992539),t=a.i(986189);a.i(95688);var u=a.i(775424),v=a.i(255145),w=a.i(718402),x=a.i(868887),y=a.i(968653);a.i(525985);var z=a.i(831551),A=a.i(492180),B=a.i(898799),C=a.i(832141),D=a.i(652167),E=a.i(259580),F=a.i(138340);let G=(0,o.motion)(c.Box);function H(){let a=(0,q.useParams)(),o=(0,q.useRouter)(),{data:H}=(0,w.useSession)(),I=a?.id,[J,K]=(0,r.useState)(null),[L,M]=(0,r.useState)(!0),[N,O]=(0,r.useState)(null),[P,Q]=(0,r.useState)(1),[R,S]=(0,r.useState)(""),[T,U]=(0,r.useState)(""),[V,W]=(0,r.useState)([]),[X,Y]=(0,r.useState)([]),[Z,$]=(0,r.useState)(""),[_,aa]=(0,r.useState)(!1),[ab,ac]=(0,r.useState)(!1),[ad,ae]=(0,r.useState)(!1),[af,ag]=(0,r.useState)(!1),[ah,ai]=(0,r.useState)(!1),[aj,ak]=(0,r.useState)(!1),[al,am]=(0,r.useState)(!1),[an,ao]=(0,r.useState)(null),[ap,aq]=(0,r.useState)(""),[ar,as]=(0,r.useState)(void 0),[at,au]=(0,r.useState)(void 0),[av,aw]=(0,r.useState)([]),[ax,ay]=(0,r.useState)(!1),[az,aA]=(0,r.useState)(null),[aB,aC]=(0,r.useState)(null),[aD,aE]=(0,r.useState)(null),[aF,aG]=(0,r.useState)(new Map),[aH,aI]=(0,r.useState)(null),[aJ,aK]=(0,r.useState)(!1),[aL,aM]=(0,r.useState)(""),[aN,aO]=(0,r.useState)(""),[aP,aQ]=(0,r.useState)(!1),[aR,aS]=(0,r.useState)(!1),[aT,aU]=(0,r.useState)(null),aV=(a,b,c="info",d=5e3)=>{aU({title:a,description:b,type:c}),setTimeout(()=>aU(null),d)};(0,r.useEffect)(()=>{I&&(aW(),aX(),aY())},[I]),(0,r.useEffect)(()=>{J&&a2()},[J]),(0,r.useEffect)(()=>{2===P&&J&&a3()},[P,J,aB,aF]),(0,r.useEffect)(()=>{3===P&&J&&a5()},[P,J]);let aW=async()=>{try{M(!0),O(null);let a=(await (0,u.fetchMyWorkItems)(1,1e3)).items.find(a=>a.workItemId===I||a.id===I);if(a)K(a);else{let a=(await (0,u.fetchWorkItems)({pageSize:1e3})).items.find(a=>a.workItemId===I||a.id===I);if(!a)return void O("Work item not found");K(a)}}catch(a){console.error("Error loading work item:",a),O(a instanceof Error?a.message:"Failed to load work item")}finally{M(!1)}},aX=async()=>{try{let a=await (0,u.fetchWorkItemComments)(I);W(a)}catch(a){v.logger.error(a,"Error loading comments",{tags:{error_type:"comments_load_error"}}),W([])}},aY=async()=>{try{let a=await (0,u.fetchWorkItemHistory)(I);Y(a)}catch(a){v.logger.error(a,"Error loading history",{tags:{error_type:"history_load_error"}}),Y([])}},aZ=async()=>{if(J){aS(!0);try{await (0,u.approveWorkItemUseCase)(J.workItemId||J.id,R),aV("Approved","Work item has been approved successfully","success",3e3),aa(!1),S(""),await aW(),o.push("/work-queue")}catch(a){aV("Approval failed",a instanceof Error?a.message:"Failed to approve work item","error",5e3)}finally{aS(!1)}}},a$=async()=>{if(J&&T.trim()){aS(!0);try{await (0,u.declineWorkItemUseCase)(J.workItemId||J.id,T),aV("Declined","Work item has been declined","success",3e3),ac(!1),U(""),await aW(),o.push("/work-queue")}catch(a){aV("Decline failed",a instanceof Error?a.message:"Failed to decline work item","error",5e3)}finally{aS(!1)}}},a_=async()=>{if(J){aS(!0);try{await (0,u.completeWorkItemUseCase)(J.workItemId||J.id,R),aV("Completed","Work item has been completed successfully","success",3e3),ae(!1),S(""),await aW(),o.push("/work-queue")}catch(a){aV("Completion failed",a instanceof Error?a.message:"Failed to complete work item","error",5e3)}finally{aS(!1)}}},a0=async()=>{if(J){aS(!0);try{await (0,u.submitForApprovalUseCase)(J.workItemId||J.id,R),aV("Submitted","Work item has been submitted for approval","success",3e3),ag(!1),S(""),await aW(),o.push("/work-queue")}catch(a){aV("Submission failed",a instanceof Error?a.message:"Failed to submit for approval","error",5e3)}finally{aS(!1)}}},a1=async()=>{if(Z.trim()&&J){aS(!0);try{await (0,u.addCommentUseCase)(J.workItemId||J.id,Z),aV("Comment added","Your comment has been added","success",3e3),$(""),await aX()}catch(a){aV("Comment failed",a instanceof Error?a.message:"Failed to add comment","error",5e3)}finally{aS(!1)}}},a2=async()=>{if(J)try{let a=J.applicationId||J.id;if(!a)return;let b=await fetch(`/api/applications/${a}`);if(b.ok){let a=await b.json();aC(a);let c=a.metadataJson?JSON.parse(a.metadataJson):{},d=c.entity_type_code||c.entityTypeCode;if(d&&("string"==typeof d&&d.includes(",")&&(d=d.split(",")[0].trim()),d=String(d).trim()),v.logger.debug("[Review Page] Extracted entity type code",{entityTypeCode:d}),d){let b=await (0,x.fetchEntitySchema)(d,a);if(b){aE(b);let a=new Map;b.sections.forEach(b=>{b.fields.forEach(b=>{("file"===b.type||"File"===b.type)&&a.set(b.code,b.label)})}),aG(a)}}}}catch(a){v.logger.error(a,"Error loading application data",{tags:{error_type:"application_data_load_error"}})}},a3=async()=>{if(J)try{ay(!0),aA(null);let a=J.applicationId||J.id;if(!a)return void aA("No application ID found");let b=await fetch(`/api/proxy/api/v1/documents/case/${a}`);if(!b.ok){if(404===b.status)return void aw([]);throw Error(`Failed to fetch documents: ${b.status}`)}let c=await b.json(),d=[];if(Array.isArray(c)?d=c:c.items&&Array.isArray(c.items)&&(d=c.items),aB&&aF.size>0){let a=aB.metadataJson?JSON.parse(aB.metadataJson):{};v.logger.debug("[Document Mapping] Application metadata keys",{keys:Object.keys(a)}),v.logger.debug("[Document Mapping] Requirement map",{entries:Array.from(aF.entries())}),v.logger.debug("[Document Mapping] Documents to map",{docs:d.map(a=>({id:a.id,fileName:a.fileName,documentNumber:a.documentNumber,storageKey:a.storageKey,type:a.type}))}),d=d.map(b=>{let c=null,d=(b.fileName||"").toLowerCase(),e=(b.documentNumber||"").toLowerCase(),f=b.id?String(b.id).toLowerCase():"",g=(b.storageKey||"").toLowerCase();for(let[d,e]of aF.entries()){let h=`${d}_document_id`,i=`${d}_storage_key`,j=[h,h.toLowerCase(),h.toUpperCase(),h.replace(/_/g,""),h.replace(/_/g,"-")],k=[i,i.toLowerCase(),i.toUpperCase(),i.replace(/_/g,""),i.replace(/_/g,"-")];for(let d of j){let g=a[d];if(g){let a=String(g).toLowerCase();if(a===f||f===a){c=e,v.logger.debug(`[Document Mapping] âœ… Matched ${b.fileName} to ${e} via ${d}`);break}}}if(c)break;for(let d of k){let f=a[d];if(f){let a=String(f).toLowerCase();if(a===g||g.includes(a)){c=e,console.log(`[Document Mapping] âœ… Matched ${b.fileName} to ${e} via storage key ${d}`);break}}}if(c)break}if(!c)for(let[h,i]of aF.entries()){for(let j of[h,h.toLowerCase(),h.toUpperCase(),h.replace(/_/g,""),h.replace(/_/g,"-"),h.replace(/_/g," ")]){let h=a[j];if(h){let a=String(h).toLowerCase();if(a.includes(d)||a.includes(e)||a.includes(f)||a.includes(g)||d.includes(a)||e.includes(a)){c=i,v.logger.debug(`[Document Mapping] âœ… Matched ${b.fileName} to ${i} via ${j}`);break}try{let a="string"==typeof h?JSON.parse(h):h;if("object"==typeof a&&null!==a){let h=JSON.stringify(a).toLowerCase();if(h.includes(d)||h.includes(e)||h.includes(f)||h.includes(g)){c=i,console.log(`[Document Mapping] âœ… Matched ${b.fileName} to ${i} via JSON in ${j}`);break}}}catch{}}}if(c)break}if(!c)for(let[h,i]of Object.entries(a)){if(!i)continue;let a=String(i).toLowerCase();if(a.includes(d)||a.includes(e)||a.includes(f)||a.includes(g)){for(let[a,d]of aF.entries())if(h.toLowerCase().includes(a.toLowerCase())||a.toLowerCase().includes(h.toLowerCase())){c=d,console.log(`[Document Mapping] âœ… Matched ${b.fileName} to ${d} via metadata key ${h}`);break}if(c)break}}return c||v.logger.debug(`[Document Mapping] âš ï¸ Could not match ${b.fileName} to any requirement`),{...b,requirementName:c||null}})}aw(d)}catch(a){v.logger.error(a,"Error loading documents",{tags:{error_type:"documents_load_error"}}),aA(a instanceof Error?a.message:"Failed to load documents"),aw([])}finally{ay(!1)}},a4=async a=>{try{if(!a||!a.storageKey)return void aV("Document error","Document storage key not found","error",3e3);let b=`/api/proxy-document?storageKey=${encodeURIComponent(a.storageKey)}`;ao(b),aq(a.fileName||a.documentNumber||"Document"),as(a.type?String(a.type):void 0),au(a.sizeBytes),am(!0)}catch(a){v.logger.error(a,"Error viewing document",{tags:{error_type:"document_view_error"}}),aV("View failed",a instanceof Error?a.message:"Failed to view document","error",5e3)}},a5=async()=>{if(J)try{aK(!0);let a=J.applicationId||J.id;if(!a)return void aI(null);let b=await y.riskApiService.getRiskAssessmentByCase(a);if(b){let a={id:b.id,caseId:b.caseId,partnerId:"",overallRiskLevel:b.riskLevel,riskScore:b.riskScore,status:b.status,createdAt:b.submittedDate,completedAt:b.reviewDate,assessedBy:b.reviewer,notes:b.recommendations?.join(", ")||"",factors:b.riskFactors?.map((a,c)=>({id:`factor-${c}`,type:"General",level:b.riskLevel,score:b.riskScore,description:a,createdAt:b.submittedDate}))||[]};if(aI(a),aM(b.riskLevel),a.notes&&a.notes.includes("MANUAL CLASSIFICATION:")){let b=a.notes.split("MANUAL CLASSIFICATION:")[1]?.trim()||"";aO(b)}}else aI(null),J.riskLevel&&aM(J.riskLevel.toUpperCase())}catch(a){v.logger.error(a,"Error loading risk assessment",{tags:{error_type:"risk_assessment_load_error"}}),aI(null)}finally{aK(!1)}},a6=async()=>{if(!J||!aL||!aN.trim())return void aV("Validation Error","Please select a risk level and provide a justification","error",5e3);try{aQ(!0);let a=J.applicationId||J.id;if(!a)throw Error("Case ID not found");let b=aH?.id;if(!b){let c=await y.riskApiService.getRiskAssessmentByCase(a);if(c)b=c.id;else throw Error("Risk assessment not found. Please create one first through the Risk Review page.")}await y.riskApiService.setManualRiskLevel(b,aL,aN),aV("Risk Assessment Saved","Manual risk level has been saved successfully","success",3e3),await a5(),await aW()}catch(a){v.logger.error(a,"Error saving risk assessment",{tags:{error_type:"risk_assessment_save_error"}}),aV("Save Failed",a instanceof Error?a.message:"Failed to save risk assessment","error",5e3)}finally{aQ(!1)}},a7=a=>({SUBMITTED:"blue","IN PROGRESS":"orange","RISK REVIEW":"red",COMPLETE:"green",DECLINED:"red",INCOMPLETE:"gray"})[a]||"gray",a8=a=>{let b=a?.toLowerCase()||"low";return b.includes("high")||b.includes("critical")?"red":b.includes("medium")?"orange":"green"};if(L)return(0,b.jsxs)(g.Flex,{minH:"100vh",bg:"gray.50",children:[(0,b.jsx)(s.default,{}),(0,b.jsx)(c.Box,{flex:"1",ml:"240px",display:"flex",alignItems:"center",justifyContent:"center",children:(0,b.jsx)(e.VStack,{gap:"4",children:(0,b.jsx)(z.Typography,{color:"gray.600",children:"Loading work item..."})})})]});if(N||!J)return(0,b.jsxs)(g.Flex,{minH:"100vh",bg:"gray.50",children:[(0,b.jsx)(s.default,{}),(0,b.jsx)(c.Box,{flex:"1",ml:"240px",display:"flex",alignItems:"center",justifyContent:"center",children:(0,b.jsxs)(e.VStack,{gap:"4",children:[(0,b.jsx)(D.AlertBar,{status:"error",title:"Error",description:N||"Work item not found"}),(0,b.jsx)(p.default,{href:"/work-queue",children:(0,b.jsx)(A.Button,{variant:"secondary",children:"Back to Work Queue"})})]})})]});let a9=[{id:1,title:"Overview",icon:n.FiFileText},{id:2,title:"Documents",icon:n.FiFolder},{id:3,title:"Risk Assessment",icon:n.FiShield},{id:4,title:"Review & Decision",icon:n.FiCheckSquare}];return(0,b.jsxs)(g.Flex,{minH:"100vh",bg:"gray.50",children:[(0,b.jsx)(s.default,{}),(0,b.jsxs)(c.Box,{flex:"1",ml:"240px",children:[(0,b.jsx)(c.Box,{bg:"white",borderBottom:"1px",borderColor:"gray.200",py:"4",px:"6",boxShadow:"sm",children:(0,b.jsxs)(f.HStack,{justify:"space-between",align:"center",children:[(0,b.jsxs)(e.VStack,{align:"start",gap:"1",children:[(0,b.jsxs)(f.HStack,{gap:"3",children:[(0,b.jsx)(z.Typography,{fontSize:"2xl",fontWeight:"bold",color:"gray.900",children:"Review Work Item"}),(0,b.jsx)(E.Tag,{variant:"green"===a7(J.status)?"success":"red"===a7(J.status)?"danger":"info",children:J.status}),J.riskLevel&&(0,b.jsxs)(E.Tag,{variant:"red"===a8(J.riskLevel)?"danger":"orange"===a8(J.riskLevel)?"warning":"info",children:[J.riskLevel," Risk"]})]}),(0,b.jsxs)(z.Typography,{color:"gray.600",fontSize:"sm",children:[J.workItemNumber||J.id," â€¢ ",J.legalName]})]}),(0,b.jsx)(f.HStack,{gap:"2",children:(0,b.jsx)(p.default,{href:"/work-queue",children:(0,b.jsxs)(A.Button,{variant:"secondary",size:"sm",children:[(0,b.jsx)(F.IconWrapper,{children:(0,b.jsx)(n.FiArrowLeft,{size:16})}),"Back to Queue"]})})})]})}),(0,b.jsx)(d.Container,{maxW:"8xl",py:"6",children:(0,b.jsxs)(e.VStack,{gap:"6",align:"stretch",children:[(0,b.jsx)(c.Box,{bg:"white",p:"4",borderRadius:"lg",boxShadow:"sm",children:(0,b.jsx)(f.HStack,{gap:"2",justify:"space-between",children:a9.map((a,d)=>(0,b.jsxs)(g.Flex,{align:"center",gap:"2",flex:"1",children:[(0,b.jsx)(c.Box,{w:"40px",h:"40px",borderRadius:"full",bg:P>=a.id?"orange.500":"gray.200",color:P>=a.id?"white":"gray.600",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",onClick:()=>Q(a.id),children:(0,b.jsx)(F.IconWrapper,{children:(0,b.jsx)(a.icon,{size:16})})}),(0,b.jsx)(z.Typography,{fontSize:"sm",fontWeight:P===a.id?"bold":"medium",color:P>=a.id?"gray.900":"gray.600",children:a.title}),d<a9.length-1&&(0,b.jsx)(c.Box,{flex:"1",h:"2px",bg:P>a.id?"orange.500":"gray.200",ml:"2"})]},a.id))})}),(0,b.jsxs)(G,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:[1===P&&(0,b.jsxs)(h.SimpleGrid,{columns:{base:1,md:2},gap:"6",children:[(0,b.jsxs)(B.Card,{bg:"white",boxShadow:"md",p:"6",children:[(0,b.jsx)(z.Typography,{fontWeight:"bold",fontSize:"lg",mb:"4",children:"Work Item Details"}),(0,b.jsx)(c.Box,{children:(0,b.jsxs)(e.VStack,{align:"stretch",gap:"3",children:[(0,b.jsxs)(f.HStack,{justify:"space-between",children:[(0,b.jsx)(z.Typography,{color:"gray.600",children:"Work Item #"}),(0,b.jsx)(z.Typography,{fontWeight:"semibold",children:J.workItemNumber||J.id})]}),(0,b.jsxs)(f.HStack,{justify:"space-between",children:[(0,b.jsx)(z.Typography,{color:"gray.600",children:"Applicant Name"}),(0,b.jsx)(z.Typography,{fontWeight:"semibold",children:J.legalName})]}),(0,b.jsxs)(f.HStack,{justify:"space-between",children:[(0,b.jsx)(z.Typography,{color:"gray.600",children:"Entity Type"}),(0,b.jsx)(z.Typography,{fontWeight:"semibold",children:J.entityType})]}),(0,b.jsxs)(f.HStack,{justify:"space-between",children:[(0,b.jsx)(z.Typography,{color:"gray.600",children:"Country"}),(0,b.jsx)(z.Typography,{fontWeight:"semibold",children:J.country})]}),(0,b.jsxs)(f.HStack,{justify:"space-between",children:[(0,b.jsx)(z.Typography,{color:"gray.600",children:"Priority"}),(0,b.jsx)(E.Tag,{variant:J.priority?.toLowerCase()==="high"?"danger":"warning",children:J.priority||"Medium"})]}),J.dueDate&&(0,b.jsxs)(f.HStack,{justify:"space-between",children:[(0,b.jsx)(z.Typography,{color:"gray.600",children:"Due Date"}),(0,b.jsx)(z.Typography,{fontWeight:"semibold",children:new Date(J.dueDate).toLocaleDateString()})]}),J.assignedToName&&(0,b.jsxs)(f.HStack,{justify:"space-between",children:[(0,b.jsx)(z.Typography,{color:"gray.600",children:"Assigned To"}),(0,b.jsx)(z.Typography,{fontWeight:"semibold",children:J.assignedToName})]})]})})]}),(0,b.jsxs)(B.Card,{bg:"white",boxShadow:"md",p:"6",children:[(0,b.jsx)(z.Typography,{fontWeight:"bold",fontSize:"lg",mb:"4",children:"Quick Actions"}),(0,b.jsxs)(e.VStack,{align:"stretch",gap:"3",children:[(0,b.jsx)(A.Button,{variant:"primary",onClick:()=>ai(!0),children:(0,b.jsxs)(f.HStack,{gap:"2",children:[(0,b.jsx)(F.IconWrapper,{children:(0,b.jsx)(n.FiMessageSquare,{size:16})}),(0,b.jsxs)(z.Typography,{children:["View Comments (",V.length,")"]})]})}),(0,b.jsx)(A.Button,{variant:"secondary",onClick:()=>ak(!0),children:(0,b.jsxs)(f.HStack,{gap:"2",children:[(0,b.jsx)(F.IconWrapper,{children:(0,b.jsx)(n.FiClock,{size:16})}),(0,b.jsx)(z.Typography,{children:"View History"})]})}),(0,b.jsx)(p.default,{href:`/applications/${J.applicationId||J.id}`,children:(0,b.jsx)(A.Button,{variant:"secondary",w:"full",children:(0,b.jsxs)(f.HStack,{gap:"2",children:[(0,b.jsx)(F.IconWrapper,{children:(0,b.jsx)(n.FiEye,{size:16})}),(0,b.jsx)(z.Typography,{children:"View Full Application"})]})})})]})]})]}),2===P&&(0,b.jsxs)(B.Card,{bg:"white",boxShadow:"md",p:"6",children:[(0,b.jsxs)(f.HStack,{justify:"space-between",align:"center",w:"full",mb:"4",children:[(0,b.jsx)(z.Typography,{fontWeight:"bold",fontSize:"lg",children:"Documents"}),(0,b.jsx)(A.Button,{size:"sm",variant:"secondary",onClick:a3,children:(0,b.jsxs)(f.HStack,{gap:"1",children:[(0,b.jsx)(F.IconWrapper,{children:(0,b.jsx)(n.FiRefreshCw,{size:16})}),(0,b.jsx)(z.Typography,{children:"Refresh"})]})})]}),(0,b.jsx)(c.Box,{children:ax?(0,b.jsxs)(e.VStack,{gap:"4",py:"8",children:[(0,b.jsx)(l.Spinner,{size:"lg",color:"orange.500"}),(0,b.jsx)(z.Typography,{color:"gray.600",children:"Loading documents..."})]}):az?(0,b.jsx)(D.AlertBar,{status:"error",title:"Error loading documents",description:az}):0===av.length?(0,b.jsxs)(e.VStack,{gap:"4",py:"8",children:[(0,b.jsx)(F.IconWrapper,{children:(0,b.jsx)(n.FiFolder,{size:48,color:"#9CA3AF"})}),(0,b.jsx)(z.Typography,{color:"gray.600",fontSize:"md",children:"No documents found for this application"}),(0,b.jsx)(p.default,{href:`/applications/${J.applicationId||J.id}`,children:(0,b.jsx)(A.Button,{variant:"secondary",children:"View Full Application"})})]}):(0,b.jsxs)(e.VStack,{align:"stretch",gap:"3",children:[(0,b.jsxs)(z.Typography,{color:"gray.600",fontSize:"sm",mb:"2",children:[av.length," document",1!==av.length?"s":""," found"]}),(0,b.jsx)(h.SimpleGrid,{columns:{base:1,md:2},gap:"3",children:av.map((a,d)=>(0,b.jsx)(c.Box,{p:"4",border:"1px",borderColor:"gray.200",borderRadius:"lg",_hover:{borderColor:"orange.400",boxShadow:"md",transform:"translateY(-2px)"},transition:"all 0.2s",cursor:"pointer",onClick:()=>a4(a),children:(0,b.jsxs)(f.HStack,{gap:"3",align:"start",children:[(0,b.jsx)(c.Box,{p:"2",borderRadius:"md",bg:"orange.100",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,children:(0,b.jsx)(F.IconWrapper,{children:(0,b.jsx)(n.FiFileText,{size:20,color:"#DD6B20"})})}),(0,b.jsxs)(e.VStack,{align:"start",gap:"1",flex:"1",minW:"0",children:[(0,b.jsx)(E.Tag,{variant:a.requirementName?"warning":"info",title:a.requirementName?`Requirement: ${a.requirementName}`:void 0,children:a.requirementName?a.requirementName:a.type?({1:"Passport Copy",2:"Drivers License",3:"National ID",4:"Proof of Address",5:"Bank Statement",6:"Tax Document",7:"Business Registration",8:"Articles of Incorporation",9:"Shareholder Registry",10:"Financial Statements",99:"Other"})[a.type]||`Type ${a.type}`:"Unknown"}),(0,b.jsx)(z.Typography,{fontWeight:"semibold",fontSize:"sm",color:"gray.900",style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"100%"},children:a.fileName||a.documentNumber||`Document ${d+1}`}),(0,b.jsx)(f.HStack,{gap:"2",wrap:"wrap",children:a.sizeBytes&&(0,b.jsx)(z.Typography,{fontSize:"xs",color:"gray.500",children:(a=>{if(!a)return"";if(0===a)return"0 Bytes";let b=Math.floor(Math.log(a)/Math.log(1024));return Math.round(a/Math.pow(1024,b)*100)/100+" "+["Bytes","KB","MB","GB"][b]})(a.sizeBytes)})}),a.requirementName&&(0,b.jsxs)(z.Typography,{fontSize:"xs",color:"orange.600",fontWeight:"medium",mt:"1",children:["ðŸ“‹ ",a.requirementName]}),a.uploadedAt&&(0,b.jsxs)(z.Typography,{fontSize:"xs",color:"gray.500",children:["Uploaded: ",new Date(a.uploadedAt).toLocaleDateString()]})]}),(0,b.jsx)(A.Button,{size:"sm",variant:"secondary",onClick:b=>{b.stopPropagation(),a4(a)},children:(0,b.jsxs)(f.HStack,{gap:"1",children:[(0,b.jsx)(F.IconWrapper,{children:(0,b.jsx)(n.FiEye,{size:16})}),(0,b.jsx)(z.Typography,{children:"View"})]})})]})},a.id||d))}),(0,b.jsx)(k.Separator,{mt:"4"}),(0,b.jsx)(p.default,{href:`/applications/${J.applicationId||J.id}`,children:(0,b.jsxs)(A.Button,{variant:"secondary",w:"full",mt:"2",children:[(0,b.jsx)(F.IconWrapper,{children:(0,b.jsx)(n.FiArrowRight,{size:16})}),"View Full Application Details"]})})]})})]}),3===P&&(0,b.jsxs)(B.Card,{bg:"white",boxShadow:"md",p:"6",children:[(0,b.jsxs)(f.HStack,{justify:"space-between",align:"center",w:"full",mb:"4",children:[(0,b.jsx)(z.Typography,{fontWeight:"bold",fontSize:"lg",children:"Manual Risk Assessment"}),aH&&(0,b.jsx)(E.Tag,{variant:"success",children:(0,b.jsxs)(f.HStack,{gap:"1",children:[(0,b.jsx)(F.IconWrapper,{children:(0,b.jsx)(n.FiCheck,{size:14})}),(0,b.jsx)(z.Typography,{fontSize:"sm",children:"Assessed"})]})})]}),(0,b.jsx)(c.Box,{children:aJ?(0,b.jsxs)(e.VStack,{gap:"4",py:"8",children:[(0,b.jsx)(l.Spinner,{size:"lg",color:"orange.500"}),(0,b.jsx)(z.Typography,{color:"gray.600",children:"Loading risk assessment..."})]}):(0,b.jsxs)(e.VStack,{align:"stretch",gap:"6",children:[aH&&(0,b.jsx)(c.Box,{p:"4",bg:"gray.50",borderRadius:"md",border:"1px",borderColor:"gray.200",children:(0,b.jsxs)(e.VStack,{align:"stretch",gap:"3",children:[(0,b.jsxs)(f.HStack,{justify:"space-between",children:[(0,b.jsx)(z.Typography,{fontWeight:"semibold",fontSize:"sm",color:"gray.700",children:"Current Risk Level"}),(0,b.jsx)(E.Tag,{variant:"red"===a8(aH.overallRiskLevel)?"danger":"orange"===a8(aH.overallRiskLevel)?"warning":"info",children:aH.overallRiskLevel})]}),void 0!==aH.riskScore&&(0,b.jsxs)(c.Box,{children:[(0,b.jsxs)(f.HStack,{justify:"space-between",mb:"2",children:[(0,b.jsx)(z.Typography,{fontSize:"sm",color:"gray.600",children:"Risk Score"}),(0,b.jsxs)(z.Typography,{fontWeight:"bold",fontSize:"sm",children:[aH.riskScore,"%"]})]}),(0,b.jsx)(j.Progress.Root,{value:aH.riskScore,colorScheme:a8(aH.overallRiskLevel),children:(0,b.jsx)(j.Progress.Track,{children:(0,b.jsx)(j.Progress.Range,{})})})]}),aH.assessedBy&&(0,b.jsxs)(f.HStack,{gap:"2",children:[(0,b.jsx)(z.Typography,{fontSize:"xs",color:"gray.500",children:"Assessed by:"}),(0,b.jsx)(z.Typography,{fontSize:"xs",fontWeight:"medium",children:aH.assessedBy}),aH.completedAt&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(z.Typography,{fontSize:"xs",color:"gray.400",children:"â€¢"}),(0,b.jsx)(z.Typography,{fontSize:"xs",color:"gray.500",children:new Date(aH.completedAt).toLocaleDateString()})]})]}),aH.notes&&aH.notes.includes("MANUAL CLASSIFICATION:")&&(0,b.jsxs)(c.Box,{mt:"2",children:[(0,b.jsx)(z.Typography,{fontSize:"xs",fontWeight:"semibold",color:"gray.600",mb:"1",children:"Justification:"}),(0,b.jsx)(z.Typography,{fontSize:"xs",color:"gray.700",fontStyle:"italic",children:aH.notes.split("MANUAL CLASSIFICATION:")[1]?.trim()||aH.notes})]})]})}),(0,b.jsx)(k.Separator,{}),(0,b.jsxs)(e.VStack,{align:"stretch",gap:"4",children:[(0,b.jsx)(z.Typography,{fontWeight:"semibold",fontSize:"md",color:"gray.900",children:"Determine Risk Level"}),(0,b.jsxs)(m.Field.Root,{required:!0,children:[(0,b.jsx)(m.Field.Label,{children:"Risk Level"}),(0,b.jsx)(m.Field.HelperText,{children:"Select the appropriate risk level based on your manual assessment"}),(0,b.jsxs)("select",{value:aL,onChange:a=>aM(a.target.value),style:{width:"100%",padding:"8px 12px",border:"1px solid #e2e8f0",borderRadius:"6px",fontSize:"14px",backgroundColor:"white"},children:[(0,b.jsx)("option",{value:"",children:"Select Risk Level"}),(0,b.jsx)("option",{value:"LOW",children:"Low"}),(0,b.jsx)("option",{value:"MEDIUMLOW",children:"Medium Low"}),(0,b.jsx)("option",{value:"MEDIUM",children:"Medium"}),(0,b.jsx)("option",{value:"MEDIUMHIGH",children:"Medium High"}),(0,b.jsx)("option",{value:"HIGH",children:"High"}),(0,b.jsx)("option",{value:"CRITICAL",children:"Critical"})]})]}),(0,b.jsxs)(m.Field.Root,{required:!0,children:[(0,b.jsx)(m.Field.Label,{children:"Justification"}),(0,b.jsx)(m.Field.HelperText,{children:"Provide a detailed justification for the selected risk level. This is required for audit and compliance purposes."}),(0,b.jsx)(i.Textarea,{value:aN,onChange:a=>aO(a.target.value),placeholder:"Enter your justification for the risk level determination. Include specific factors, concerns, or observations that led to this assessment...",rows:6,resize:"vertical"})]}),(0,b.jsxs)(f.HStack,{gap:"3",justify:"flex-end",pt:"2",children:[(0,b.jsx)(A.Button,{variant:"secondary",onClick:()=>{aM(aH?.overallRiskLevel||J?.riskLevel?.toUpperCase()||""),aO("")},children:"Reset"}),(0,b.jsx)(A.Button,{colorScheme:"orange",onClick:a6,loading:aP,disabled:!aL||!aN.trim(),children:(0,b.jsxs)(f.HStack,{gap:"2",children:[(0,b.jsx)(F.IconWrapper,{children:(0,b.jsx)(n.FiSave,{size:16})}),(0,b.jsx)(z.Typography,{children:"Save Risk Assessment"})]})})]})]}),(0,b.jsx)(k.Separator,{}),(0,b.jsx)(e.VStack,{align:"stretch",gap:"2",children:(0,b.jsx)(p.default,{href:`/risk-review?search=${J.id}`,children:(0,b.jsx)(A.Button,{variant:"secondary",w:"full",children:(0,b.jsxs)(f.HStack,{gap:"2",children:[(0,b.jsx)(F.IconWrapper,{children:(0,b.jsx)(n.FiShield,{size:16})}),(0,b.jsx)(z.Typography,{children:"View Detailed Risk Assessment"}),(0,b.jsx)(F.IconWrapper,{children:(0,b.jsx)(n.FiArrowRight,{size:16})})]})})})})]})})]}),4===P&&(0,b.jsxs)(B.Card,{bg:"white",boxShadow:"md",p:"6",children:[(0,b.jsx)(z.Typography,{fontWeight:"bold",fontSize:"lg",mb:"4",children:"Review & Decision"}),(0,b.jsx)(c.Box,{children:(0,b.jsxs)(e.VStack,{align:"stretch",gap:"4",children:[(0,b.jsxs)(m.Field.Root,{children:[(0,b.jsx)(m.Field.Label,{children:"Review Notes"}),(0,b.jsx)(i.Textarea,{value:R,onChange:a=>S(a.target.value),placeholder:"Enter your review notes...",rows:6})]}),(0,b.jsx)(k.Separator,{}),(0,b.jsxs)(h.SimpleGrid,{columns:{base:1,md:2},gap:"3",children:["IN PROGRESS"===J.status&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(A.Button,{variant:"primary",onClick:()=>ae(!0),size:"md",children:(0,b.jsxs)(f.HStack,{gap:"2",children:[(0,b.jsx)(F.IconWrapper,{children:(0,b.jsx)(n.FiCheck,{size:16})}),(0,b.jsx)(z.Typography,{children:"Complete Review"})]})}),J.requiresApproval&&(0,b.jsx)(A.Button,{variant:"primary",onClick:()=>ag(!0),size:"md",children:(0,b.jsxs)(f.HStack,{gap:"2",children:[(0,b.jsx)(F.IconWrapper,{children:(0,b.jsx)(n.FiSend,{size:16})}),(0,b.jsx)(z.Typography,{children:"Submit for Approval"})]})})]}),"RISK REVIEW"===J.status&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(A.Button,{variant:"primary",onClick:()=>aa(!0),size:"md",children:(0,b.jsxs)(f.HStack,{gap:"2",children:[(0,b.jsx)(F.IconWrapper,{children:(0,b.jsx)(n.FiCheck,{size:16})}),(0,b.jsx)(z.Typography,{children:"Approve"})]})}),(0,b.jsx)(A.Button,{variant:"primary",onClick:()=>ac(!0),size:"md",children:(0,b.jsxs)(f.HStack,{gap:"2",children:[(0,b.jsx)(F.IconWrapper,{children:(0,b.jsx)(n.FiX,{size:16})}),(0,b.jsx)(z.Typography,{children:"Decline"})]})})]})]})]})})]})]},P),(0,b.jsxs)(f.HStack,{justify:"space-between",mt:"4",children:[(0,b.jsx)(A.Button,{variant:"secondary",onClick:()=>Q(Math.max(1,P-1)),disabled:1===P,children:(0,b.jsxs)(f.HStack,{gap:"2",children:[(0,b.jsx)(F.IconWrapper,{children:(0,b.jsx)(n.FiArrowLeft,{size:16})}),(0,b.jsx)(z.Typography,{children:"Previous"})]})}),(0,b.jsx)(A.Button,{variant:"primary",onClick:()=>Q(Math.min(a9.length,P+1)),disabled:P===a9.length,children:(0,b.jsxs)(f.HStack,{gap:"2",children:[(0,b.jsx)(z.Typography,{children:"Next"}),(0,b.jsx)(F.IconWrapper,{children:(0,b.jsx)(n.FiArrowRight,{size:16})})]})})]})]})})]}),(0,b.jsxs)(C.Modal,{isOpen:_,onClose:()=>aa(!1),title:"Approve Work Item",size:"small",closeOnBackdropClick:!0,closeOnEsc:!0,children:[(0,b.jsx)(C.ModalHeader,{children:(0,b.jsx)(z.Typography,{fontSize:"lg",fontWeight:"700",color:"gray.900",children:"Approve Work Item"})}),(0,b.jsx)(C.ModalBody,{children:(0,b.jsx)(e.VStack,{align:"stretch",gap:"4",children:(0,b.jsxs)(m.Field.Root,{children:[(0,b.jsx)(m.Field.Label,{children:"Notes (Optional)"}),(0,b.jsx)(i.Textarea,{value:R,onChange:a=>S(a.target.value),placeholder:"Add approval notes...",rows:4})]})})}),(0,b.jsx)(C.ModalFooter,{children:(0,b.jsxs)(f.HStack,{gap:"2",children:[(0,b.jsx)(A.Button,{variant:"secondary",onClick:()=>aa(!1),children:"Cancel"}),(0,b.jsx)(A.Button,{variant:"primary",onClick:aZ,disabled:aR,children:"Approve"})]})})]}),(0,b.jsxs)(C.Modal,{isOpen:ab,onClose:()=>ac(!1),title:"Decline Work Item",size:"small",closeOnBackdropClick:!0,closeOnEsc:!0,children:[(0,b.jsx)(C.ModalHeader,{children:(0,b.jsx)(z.Typography,{fontSize:"lg",fontWeight:"700",color:"gray.900",children:"Decline Work Item"})}),(0,b.jsx)(C.ModalBody,{children:(0,b.jsx)(e.VStack,{align:"stretch",gap:"4",children:(0,b.jsxs)(m.Field.Root,{required:!0,children:[(0,b.jsx)(m.Field.Label,{children:"Reason for Decline"}),(0,b.jsx)(i.Textarea,{value:T,onChange:a=>U(a.target.value),placeholder:"Please provide a reason for declining...",rows:4})]})})}),(0,b.jsx)(C.ModalFooter,{children:(0,b.jsxs)(f.HStack,{gap:"2",children:[(0,b.jsx)(A.Button,{variant:"secondary",onClick:()=>ac(!1),children:"Cancel"}),(0,b.jsx)(A.Button,{variant:"primary",onClick:a$,disabled:aR||!T.trim(),children:"Decline"})]})})]}),(0,b.jsxs)(C.Modal,{isOpen:ad,onClose:()=>ae(!1),title:"Complete Work Item",size:"small",closeOnBackdropClick:!0,closeOnEsc:!0,children:[(0,b.jsx)(C.ModalHeader,{children:(0,b.jsx)(z.Typography,{fontSize:"lg",fontWeight:"700",color:"gray.900",children:"Complete Work Item"})}),(0,b.jsx)(C.ModalBody,{children:(0,b.jsx)(e.VStack,{align:"stretch",gap:"4",children:(0,b.jsxs)(m.Field.Root,{children:[(0,b.jsx)(m.Field.Label,{children:"Notes (Optional)"}),(0,b.jsx)(i.Textarea,{value:R,onChange:a=>S(a.target.value),placeholder:"Add completion notes...",rows:4})]})})}),(0,b.jsx)(C.ModalFooter,{children:(0,b.jsxs)(f.HStack,{gap:"2",children:[(0,b.jsx)(A.Button,{variant:"secondary",onClick:()=>ae(!1),children:"Cancel"}),(0,b.jsx)(A.Button,{variant:"primary",onClick:a_,disabled:aR,children:"Complete"})]})})]}),(0,b.jsxs)(C.Modal,{isOpen:af,onClose:()=>ag(!1),title:"Submit for Approval",size:"small",closeOnBackdropClick:!0,closeOnEsc:!0,children:[(0,b.jsx)(C.ModalHeader,{children:(0,b.jsx)(z.Typography,{fontSize:"lg",fontWeight:"700",color:"gray.900",children:"Submit for Approval"})}),(0,b.jsx)(C.ModalBody,{children:(0,b.jsx)(e.VStack,{align:"stretch",gap:"4",children:(0,b.jsxs)(m.Field.Root,{children:[(0,b.jsx)(m.Field.Label,{children:"Notes (Optional)"}),(0,b.jsx)(i.Textarea,{value:R,onChange:a=>S(a.target.value),placeholder:"Add notes for approval...",rows:4})]})})}),(0,b.jsx)(C.ModalFooter,{children:(0,b.jsxs)(f.HStack,{gap:"2",children:[(0,b.jsx)(A.Button,{variant:"secondary",onClick:()=>ag(!1),children:"Cancel"}),(0,b.jsx)(A.Button,{variant:"primary",onClick:a0,disabled:aR,children:"Submit"})]})})]}),(0,b.jsxs)(C.Modal,{isOpen:ah,onClose:()=>ai(!1),title:"Comments",size:"large",closeOnBackdropClick:!0,closeOnEsc:!0,children:[(0,b.jsx)(C.ModalHeader,{children:(0,b.jsx)(z.Typography,{fontSize:"lg",fontWeight:"700",color:"gray.900",children:"Comments"})}),(0,b.jsx)(C.ModalBody,{children:(0,b.jsxs)(e.VStack,{align:"stretch",gap:"4",children:[(0,b.jsx)(c.Box,{maxH:"400px",overflowY:"auto",children:0===V.length?(0,b.jsx)(z.Typography,{color:"gray.600",children:"No comments yet"}):(0,b.jsx)(e.VStack,{align:"stretch",gap:"3",children:V.map((a,d)=>(0,b.jsxs)(c.Box,{p:"3",bg:"gray.50",borderRadius:"md",children:[(0,b.jsxs)(f.HStack,{justify:"space-between",mb:"2",children:[(0,b.jsx)(z.Typography,{fontWeight:"semibold",fontSize:"sm",children:a.createdBy||a.authorName||"Unknown"}),(0,b.jsx)(z.Typography,{fontSize:"xs",color:"gray.600",children:new Date(a.createdAt||a.timestamp).toLocaleString()})]}),(0,b.jsx)(z.Typography,{fontSize:"sm",color:"gray.700",children:a.text||a.comment})]},d))})}),(0,b.jsx)(k.Separator,{}),(0,b.jsxs)(e.VStack,{align:"stretch",gap:"2",children:[(0,b.jsxs)(m.Field.Root,{children:[(0,b.jsx)(m.Field.Label,{children:"Add Comment"}),(0,b.jsx)(i.Textarea,{value:Z,onChange:a=>$(a.target.value),placeholder:"Enter your comment...",rows:3})]}),(0,b.jsx)(A.Button,{variant:"primary",onClick:a1,disabled:aR||!Z.trim(),children:(0,b.jsxs)(f.HStack,{gap:"2",children:[(0,b.jsx)(F.IconWrapper,{children:(0,b.jsx)(n.FiMessageSquare,{size:16})}),(0,b.jsx)(z.Typography,{children:"Add Comment"})]})})]})]})}),(0,b.jsx)(C.ModalFooter,{children:(0,b.jsx)(A.Button,{variant:"secondary",onClick:()=>ai(!1),children:"Close"})})]}),(0,b.jsxs)(C.Modal,{isOpen:aj,onClose:()=>ak(!1),title:"History",size:"large",closeOnBackdropClick:!0,closeOnEsc:!0,children:[(0,b.jsx)(C.ModalHeader,{children:(0,b.jsx)(z.Typography,{fontSize:"lg",fontWeight:"700",color:"gray.900",children:"History"})}),(0,b.jsx)(C.ModalBody,{children:(0,b.jsx)(c.Box,{maxH:"500px",overflowY:"auto",children:0===X.length?(0,b.jsx)(z.Typography,{color:"gray.600",children:"No history available"}):(0,b.jsx)(e.VStack,{align:"stretch",gap:"2",children:X.map((a,d)=>(0,b.jsxs)(c.Box,{p:"3",borderLeft:"3px",borderColor:"orange.500",bg:"gray.50",borderRadius:"md",children:[(0,b.jsxs)(f.HStack,{justify:"space-between",mb:"1",children:[(0,b.jsx)(z.Typography,{fontWeight:"semibold",fontSize:"sm",children:a.action||a.description||a.eventType}),(0,b.jsx)(z.Typography,{fontSize:"xs",color:"gray.600",children:new Date(a.timestamp||a.createdAt).toLocaleString()})]}),a.performedBy&&(0,b.jsxs)(z.Typography,{fontSize:"xs",color:"gray.600",children:["By: ",a.performedBy]})]},d))})})}),(0,b.jsx)(C.ModalFooter,{children:(0,b.jsx)(A.Button,{variant:"secondary",onClick:()=>ak(!1),children:"Close"})})]}),(0,b.jsx)(t.DocumentViewer,{isOpen:al,onClose:()=>{am(!1),ao(null),aq(""),as(void 0),au(void 0)},documentUrl:an,fileName:ap,documentType:ar,fileSize:at,onDownload:()=>{an&&window.open(an,"_blank")}})]})}a.s(["default",()=>H])}];

//# debugId=4b67a917-9444-a83a-8342-55f989637996
//# sourceMappingURL=src_app_review_%5Bid%5D_page_tsx_d0d7570a._.js.map