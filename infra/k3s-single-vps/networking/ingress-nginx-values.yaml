controller:
  replicaCount: 2
  
  service:
    type: LoadBalancer
    externalTrafficPolicy: Local
  
  resources:
    requests:
      cpu: 100m
      memory: 128Mi
    limits:
      cpu: 500m
      memory: 512Mi
  
  metrics:
    enabled: true
    serviceMonitor:
      enabled: true
      additionalLabels:
        release: prometheus
  
  config:
    # Request handling
    use-forwarded-headers: "true"
    compute-full-forwarded-for: "true"
    use-proxy-protocol: "false"
    
    # Body size limits
    proxy-body-size: "10m"
    client-body-buffer-size: "1m"
    
    # Timeouts
    client-header-timeout: "60"
    client-body-timeout: "60"
    proxy-connect-timeout: "30"
    proxy-send-timeout: "60"
    proxy-read-timeout: "60"
    keepalive-timeout: "75"
    
    # Compression
    enable-brotli: "true"
    brotli-level: "6"
    brotli-types: "application/json application/javascript text/css text/javascript text/plain text/xml"
    
    # Security headers
    hsts: "true"
    hsts-max-age: "31536000"
    hsts-include-subdomains: "true"
    hsts-preload: "true"
    
    # SSL
    ssl-protocols: "TLSv1.2 TLSv1.3"
    ssl-ciphers: "ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384"
    ssl-prefer-server-ciphers: "true"
    
    # Rate limiting (global defaults)
    limit-req-status-code: "429"
    limit-conn-status-code: "429"
    
    # Request ID
    generate-request-id: "true"
    
    # Real IP (already configured above)
    
    # Hide version
    server-tokens: "false"
    
    # Logging
    log-format-upstream: '{"time": "$time_iso8601", "remote_addr": "$remote_addr", "request_id": "$req_id", "remote_user": "$remote_user", "request": "$request", "status": $status, "body_bytes_sent": $body_bytes_sent, "request_time": $request_time, "http_referrer": "$http_referer", "http_user_agent": "$http_user_agent", "http_x_forwarded_for": "$http_x_forwarded_for", "upstream_addr": "$upstream_addr", "upstream_status": "$upstream_status", "upstream_response_time": "$upstream_response_time"}'
  
  podAnnotations:
    prometheus.io/scrape: "true"
    prometheus.io/port: "10254"
  
  podSecurityContext:
    runAsNonRoot: true
    runAsUser: 101
    fsGroup: 101
  
  containerSecurityContext:
    allowPrivilegeEscalation: false
    readOnlyRootFilesystem: true
    runAsNonRoot: true
    runAsUser: 101
    capabilities:
      drop:
      - ALL
      add:
      - NET_BIND_SERVICE

defaultBackend:
  enabled: true
  image:
    repository: defaultbackend-amd64
    tag: "1.5"
  resources:
    requests:
      cpu: 10m
      memory: 20Mi
    limits:
      cpu: 50m
      memory: 50Mi

