"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("app/auth/callback/page",{

/***/ "(app-pages-browser)/./src/app/auth/callback/page.tsx":
/*!****************************************!*\
  !*** ./src/app/auth/callback/page.tsx ***!
  \****************************************/
/***/ (function(module, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": function() { return /* binding */ AuthCallbackPage; }\n/* harmony export */ });\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react/jsx-dev-runtime */ \"(app-pages-browser)/./node_modules/next/dist/compiled/react/jsx-dev-runtime.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ \"(app-pages-browser)/./node_modules/next/dist/compiled/react/index.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var next_navigation__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/navigation */ \"(app-pages-browser)/./node_modules/next/dist/api/navigation.js\");\n/* harmony import */ var _chakra_ui_react__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @chakra-ui/react */ \"(app-pages-browser)/./node_modules/@chakra-ui/react/dist/esm/components/box/index.js\");\n/* harmony import */ var _chakra_ui_react__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @chakra-ui/react */ \"(app-pages-browser)/./node_modules/@chakra-ui/react/dist/esm/components/stack/v-stack.js\");\n/* harmony import */ var _chakra_ui_react__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @chakra-ui/react */ \"(app-pages-browser)/./node_modules/@chakra-ui/react/dist/esm/components/spinner/spinner.js\");\n/* harmony import */ var _chakra_ui_react__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @chakra-ui/react */ \"(app-pages-browser)/./node_modules/@chakra-ui/react/dist/esm/components/text/index.js\");\n/* harmony import */ var _chakra_ui_react__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @chakra-ui/react */ \"(app-pages-browser)/./node_modules/@chakra-ui/react/dist/esm/components/button/button.js\");\n/* harmony import */ var _config_auth__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/config/auth */ \"(app-pages-browser)/./src/config/auth.ts\");\n/* harmony import */ var _lib_auth_pkce__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/lib/auth/pkce */ \"(app-pages-browser)/./src/lib/auth/pkce.ts\");\n/* __next_internal_client_entry_do_not_use__ default auto */ \nvar _s = $RefreshSig$();\n\n\n\n\n\n// Removed: backupTokens - tokens are now stored server-side in Redis\nasync function exchangeCodeForTokens(code, codeVerifier) {\n    const body = new URLSearchParams({\n        grant_type: \"authorization_code\",\n        client_id: _config_auth__WEBPACK_IMPORTED_MODULE_3__.authConfig.clientId,\n        code,\n        redirect_uri: _config_auth__WEBPACK_IMPORTED_MODULE_3__.authConfig.redirectUri,\n        code_verifier: codeVerifier\n    });\n    const res = await fetch(_config_auth__WEBPACK_IMPORTED_MODULE_3__.authConfig.tokenUrl, {\n        method: \"POST\",\n        headers: {\n            \"Content-Type\": \"application/x-www-form-urlencoded\"\n        },\n        body: body.toString()\n    });\n    if (!res.ok) {\n        const text = await res.text();\n        throw new Error(text || \"Token exchange failed: \".concat(res.status));\n    }\n    return res.json();\n}\nfunction hasRequiredRole(accessTokenPayload) {\n    try {\n        var _ra_REQUIRED_RESOURCE, _accessTokenPayload_realm_access;\n        var _accessTokenPayload_resource_access;\n        // 1) Preferred: client role on the specified resource\n        const ra = (_accessTokenPayload_resource_access = accessTokenPayload === null || accessTokenPayload === void 0 ? void 0 : accessTokenPayload.resource_access) !== null && _accessTokenPayload_resource_access !== void 0 ? _accessTokenPayload_resource_access : {};\n        const preferredRoles = ra === null || ra === void 0 ? void 0 : (_ra_REQUIRED_RESOURCE = ra[_config_auth__WEBPACK_IMPORTED_MODULE_3__.REQUIRED_RESOURCE]) === null || _ra_REQUIRED_RESOURCE === void 0 ? void 0 : _ra_REQUIRED_RESOURCE.roles;\n        if (Array.isArray(preferredRoles) && preferredRoles.includes(_config_auth__WEBPACK_IMPORTED_MODULE_3__.REQUIRED_ROLE)) {\n            return true;\n        }\n        // 2) Fallback: role granted on any client resource (some setups map to a different client)\n        const anyClientHas = Object.values(ra).some((v)=>Array.isArray(v === null || v === void 0 ? void 0 : v.roles) && v.roles.includes(_config_auth__WEBPACK_IMPORTED_MODULE_3__.REQUIRED_ROLE));\n        if (anyClientHas) return true;\n        // 3) Fallback: realm role\n        const realmRoles = accessTokenPayload === null || accessTokenPayload === void 0 ? void 0 : (_accessTokenPayload_realm_access = accessTokenPayload.realm_access) === null || _accessTokenPayload_realm_access === void 0 ? void 0 : _accessTokenPayload_realm_access.roles;\n        if (Array.isArray(realmRoles) && realmRoles.includes(_config_auth__WEBPACK_IMPORTED_MODULE_3__.REQUIRED_ROLE)) {\n            return true;\n        }\n        return false;\n    } catch (e) {\n        return false;\n    }\n}\nfunction decodeJwt(token) {\n    try {\n        const [, payload] = token.split(\".\");\n        const json = atob(payload.replace(/-/g, \"+\").replace(/_/g, \"/\"));\n        return JSON.parse(json);\n    } catch (e) {\n        return null;\n    }\n}\nfunction AuthCallbackPage() {\n    _s();\n    const router = (0,next_navigation__WEBPACK_IMPORTED_MODULE_2__.useRouter)();\n    const [error, setError] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(null);\n    const [phase, setPhase] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(\"checking\");\n    const hasRunRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(false);\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{\n        // Prevent double execution in React Strict Mode\n        if (hasRunRef.current) {\n            return;\n        }\n        hasRunRef.current = true;\n        const run = async ()=>{\n            setPhase(\"checking\");\n            const url = new URL(window.location.href);\n            // Check for Keycloak error parameters first\n            const errorParam = url.searchParams.get(\"error\");\n            const errorDescription = url.searchParams.get(\"error_description\");\n            if (errorParam) {\n                let errorMessage = \"Authentication failed.\";\n                if (errorDescription) {\n                    errorMessage = decodeURIComponent(errorDescription);\n                } else {\n                    // Map common Keycloak error codes to user-friendly messages\n                    const errorMessages = {\n                        \"access_denied\": \"Access was denied. Please try again.\",\n                        \"invalid_request\": \"Invalid authentication request. Please try again.\",\n                        \"invalid_client\": \"Authentication configuration error. Please contact support.\",\n                        \"invalid_grant\": \"Authentication session expired. Please try again.\",\n                        \"unauthorized_client\": \"Client not authorized. Please contact support.\",\n                        \"unsupported_grant_type\": \"Authentication method not supported. Please contact support.\",\n                        \"invalid_scope\": \"Requested permissions are invalid. Please contact support.\",\n                        \"server_error\": \"Authentication server error. Please try again later.\",\n                        \"temporarily_unavailable\": \"Authentication service is temporarily unavailable. Please try again later.\"\n                    };\n                    errorMessage = errorMessages[errorParam] || errorMessage;\n                }\n                setError(errorMessage);\n                setPhase(\"error\");\n                return;\n            }\n            const code = url.searchParams.get(\"code\");\n            const returnedState = url.searchParams.get(\"state\");\n            const { codeVerifier, state } = (0,_lib_auth_pkce__WEBPACK_IMPORTED_MODULE_4__.getCodeVerifierAndState)();\n            // If code is missing, user navigated directly to callback: start flow\n            if (!code || !codeVerifier) {\n                (0,_lib_auth_pkce__WEBPACK_IMPORTED_MODULE_4__.startAuthorization)(_config_auth__WEBPACK_IMPORTED_MODULE_3__.authConfig);\n                return;\n            }\n            // Validate state parameter (CSRF protection)\n            if (state && returnedState && state !== returnedState) {\n                setError(\"Security validation failed. Please try again.\");\n                setPhase(\"error\");\n                return;\n            }\n            // If no state was sent but one was returned, that's also suspicious\n            if (!state && returnedState) {\n                setError(\"Security validation failed. Please try again.\");\n                setPhase(\"error\");\n                return;\n            }\n            try {\n                setPhase(\"exchanging\");\n                // Retry logic for network failures\n                let tokens;\n                let lastError = null;\n                const maxRetries = 3;\n                for(let attempt = 1; attempt <= maxRetries; attempt++){\n                    try {\n                        tokens = await exchangeCodeForTokens(code, codeVerifier);\n                        break;\n                    } catch (e) {\n                        var _e_message, _e_message1, _e_message2, _e_message3;\n                        lastError = e;\n                        // Don't retry on client errors (4xx)\n                        if (((_e_message = e.message) === null || _e_message === void 0 ? void 0 : _e_message.includes(\"400\")) || ((_e_message1 = e.message) === null || _e_message1 === void 0 ? void 0 : _e_message1.includes(\"401\")) || ((_e_message2 = e.message) === null || _e_message2 === void 0 ? void 0 : _e_message2.includes(\"403\")) || ((_e_message3 = e.message) === null || _e_message3 === void 0 ? void 0 : _e_message3.includes(\"404\"))) {\n                            throw e;\n                        }\n                        // Retry on network/server errors\n                        if (attempt < maxRetries) {\n                            await new Promise((resolve)=>setTimeout(resolve, 1000 * attempt)); // Exponential backoff\n                            continue;\n                        }\n                        throw e;\n                    }\n                }\n                if (!tokens) {\n                    throw lastError || new Error(\"Failed to exchange authorization code\");\n                }\n                const access = tokens.access_token;\n                const refresh = tokens.refresh_token;\n                // Validate access token format\n                if (!access || typeof access !== \"string\") {\n                    setError(\"Received invalid authentication token. Please try again.\");\n                    setPhase(\"error\");\n                    return;\n                }\n                const tokenParts = access.split(\".\");\n                if (tokenParts.length !== 3) {\n                    setError(\"Received invalid authentication token format. Please try again.\");\n                    setPhase(\"error\");\n                    return;\n                }\n                const payload = decodeJwt(access);\n                if (!payload) {\n                    setError(\"Failed to process authentication token. Please try again.\");\n                    setPhase(\"error\");\n                    return;\n                }\n                if (_config_auth__WEBPACK_IMPORTED_MODULE_3__.ENFORCE_ROLE && !hasRequiredRole(payload)) {\n                    setError(\"Your account lacks the required business-user role.\");\n                    setPhase(\"error\");\n                    return;\n                }\n                // SECURITY: Tokens are now stored server-side in Redis via NextAuth\n                // DO NOT store tokens in localStorage - this is a security risk\n                // NextAuth handles token storage and the API proxy injects tokens automatically\n                // This callback page is only for legacy PKCE flow - NextAuth handles OAuth callbacks at /api/auth/callback/keycloak\n                (0,_lib_auth_pkce__WEBPACK_IMPORTED_MODULE_4__.clearPkceState)();\n                // Redirect to NextAuth sign-in to complete the flow properly\n                // NextAuth will handle token storage in Redis\n                console.log(\"[Auth Callback] Legacy PKCE flow detected - redirecting to NextAuth\");\n                setPhase(\"success\");\n                // Small delay to ensure storage is written\n                await new Promise((resolve)=>setTimeout(resolve, 100));\n                router.replace(\"/partner/dashboard\");\n            } catch (e) {\n                var _e_message4, _e_message5, _e_message6, _e_message7;\n                let errorMessage = \"Authentication failed. Please try again.\";\n                // Try to parse JSON error response from Keycloak\n                let errorData = null;\n                try {\n                    if (e.message && typeof e.message === \"string\") {\n                        errorData = JSON.parse(e.message);\n                    }\n                } catch (e) {\n                // Not JSON, use string as-is\n                }\n                // Handle specific Keycloak error codes\n                if ((errorData === null || errorData === void 0 ? void 0 : errorData.error) === \"invalid_grant\") {\n                    errorMessage = errorData.error_description ? decodeURIComponent(errorData.error_description) : \"Your authentication session has expired. Please sign in again.\";\n                    // Clear PKCE state and redirect to login\n                    (0,_lib_auth_pkce__WEBPACK_IMPORTED_MODULE_4__.clearPkceState)();\n                    setTimeout(()=>{\n                        router.replace(\"/auth/login\");\n                    }, 2000);\n                    setError(errorMessage);\n                    setPhase(\"error\");\n                    return;\n                }\n                // Provide more specific error messages\n                if (((_e_message4 = e.message) === null || _e_message4 === void 0 ? void 0 : _e_message4.includes(\"NetworkError\")) || ((_e_message5 = e.message) === null || _e_message5 === void 0 ? void 0 : _e_message5.includes(\"Failed to fetch\"))) {\n                    errorMessage = \"Network error. Please check your connection and try again.\";\n                } else if ((_e_message6 = e.message) === null || _e_message6 === void 0 ? void 0 : _e_message6.includes(\"401\")) {\n                    errorMessage = \"Authentication failed. Please sign in again.\";\n                } else if ((_e_message7 = e.message) === null || _e_message7 === void 0 ? void 0 : _e_message7.includes(\"400\")) {\n                    // Parse JSON error if possible\n                    if (errorData === null || errorData === void 0 ? void 0 : errorData.error_description) {\n                        errorMessage = decodeURIComponent(errorData.error_description);\n                    } else if ((errorData === null || errorData === void 0 ? void 0 : errorData.error) === \"invalid_grant\") {\n                        // Handle \"code already used\" scenario (common in React Strict Mode)\n                        errorMessage = \"The authorization code has already been used. This may happen if the page reloaded. Please sign in again.\";\n                        // Clear PKCE state and redirect to login\n                        (0,_lib_auth_pkce__WEBPACK_IMPORTED_MODULE_4__.clearPkceState)();\n                        setTimeout(()=>{\n                            router.replace(\"/\");\n                        }, 2000);\n                    } else {\n                        errorMessage = \"Invalid authentication request. The authorization code may have expired or already been used. Please try again.\";\n                    }\n                } else if (errorData === null || errorData === void 0 ? void 0 : errorData.error_description) {\n                    errorMessage = decodeURIComponent(errorData.error_description);\n                } else if (e.message) {\n                    errorMessage = e.message;\n                }\n                // Don't log expected errors (like invalid_grant from expired codes)\n                if (!errorData || errorData.error !== \"invalid_grant\") {\n                    console.error(\"Authentication error:\", e);\n                }\n                setError(errorMessage);\n                setPhase(\"error\");\n            }\n        };\n        run();\n    }, [\n        router\n    ]);\n    // Unified full-screen loader overlay for all non-error states\n    if (phase !== \"error\") {\n        return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_5__.Box, {\n            minH: \"100vh\",\n            display: \"flex\",\n            alignItems: \"center\",\n            justifyContent: \"center\",\n            children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_6__.VStack, {\n                gap: 4,\n                children: [\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_7__.Spinner, {}, void 0, false, {\n                        fileName: \"/Users/mukurusystemsadministrator/Desktop/onboarding_kyc copy/partner/src/app/auth/callback/page.tsx\",\n                        lineNumber: 282,\n                        columnNumber: 11\n                    }, this),\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_8__.Text, {\n                        children: \"Completing sign-inâ€¦\"\n                    }, void 0, false, {\n                        fileName: \"/Users/mukurusystemsadministrator/Desktop/onboarding_kyc copy/partner/src/app/auth/callback/page.tsx\",\n                        lineNumber: 283,\n                        columnNumber: 11\n                    }, this)\n                ]\n            }, void 0, true, {\n                fileName: \"/Users/mukurusystemsadministrator/Desktop/onboarding_kyc copy/partner/src/app/auth/callback/page.tsx\",\n                lineNumber: 281,\n                columnNumber: 9\n            }, this)\n        }, void 0, false, {\n            fileName: \"/Users/mukurusystemsadministrator/Desktop/onboarding_kyc copy/partner/src/app/auth/callback/page.tsx\",\n            lineNumber: 280,\n            columnNumber: 7\n        }, this);\n    }\n    // Error state\n    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_5__.Box, {\n        minH: \"100vh\",\n        display: \"flex\",\n        alignItems: \"center\",\n        justifyContent: \"center\",\n        children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_6__.VStack, {\n            gap: 4,\n            children: [\n                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_8__.Text, {\n                    color: \"red.500\",\n                    fontWeight: \"bold\",\n                    children: error\n                }, void 0, false, {\n                    fileName: \"/Users/mukurusystemsadministrator/Desktop/onboarding_kyc copy/partner/src/app/auth/callback/page.tsx\",\n                    lineNumber: 293,\n                    columnNumber: 9\n                }, this),\n                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_chakra_ui_react__WEBPACK_IMPORTED_MODULE_9__.Button, {\n                    onClick: ()=>(0,_lib_auth_pkce__WEBPACK_IMPORTED_MODULE_4__.startAuthorization)(_config_auth__WEBPACK_IMPORTED_MODULE_3__.authConfig),\n                    children: \"Back to sign in\"\n                }, void 0, false, {\n                    fileName: \"/Users/mukurusystemsadministrator/Desktop/onboarding_kyc copy/partner/src/app/auth/callback/page.tsx\",\n                    lineNumber: 294,\n                    columnNumber: 9\n                }, this)\n            ]\n        }, void 0, true, {\n            fileName: \"/Users/mukurusystemsadministrator/Desktop/onboarding_kyc copy/partner/src/app/auth/callback/page.tsx\",\n            lineNumber: 292,\n            columnNumber: 7\n        }, this)\n    }, void 0, false, {\n        fileName: \"/Users/mukurusystemsadministrator/Desktop/onboarding_kyc copy/partner/src/app/auth/callback/page.tsx\",\n        lineNumber: 291,\n        columnNumber: 5\n    }, this);\n}\n_s(AuthCallbackPage, \"cS4kRvp5OAPyHJxGgoO6UcprOlk=\", false, function() {\n    return [\n        next_navigation__WEBPACK_IMPORTED_MODULE_2__.useRouter\n    ];\n});\n_c = AuthCallbackPage;\nvar _c;\n$RefreshReg$(_c, \"AuthCallbackPage\");\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL3NyYy9hcHAvYXV0aC9jYWxsYmFjay9wYWdlLnRzeCIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUVvRDtBQUNSO0FBQzBCO0FBQ3FCO0FBQ0c7QUFDOUYscUVBQXFFO0FBRXJFLGVBQWVnQixzQkFBc0JDLElBQVksRUFBRUMsWUFBb0I7SUFDckUsTUFBTUMsT0FBTyxJQUFJQyxnQkFBZ0I7UUFDL0JDLFlBQVk7UUFDWkMsV0FBV2Isb0RBQVVBLENBQUNjLFFBQVE7UUFDOUJOO1FBQ0FPLGNBQWNmLG9EQUFVQSxDQUFDZ0IsV0FBVztRQUNwQ0MsZUFBZVI7SUFDakI7SUFFQSxNQUFNUyxNQUFNLE1BQU1DLE1BQU1uQixvREFBVUEsQ0FBQ29CLFFBQVEsRUFBRTtRQUMzQ0MsUUFBUTtRQUNSQyxTQUFTO1lBQUUsZ0JBQWdCO1FBQW9DO1FBQy9EWixNQUFNQSxLQUFLYSxRQUFRO0lBQ3JCO0lBQ0EsSUFBSSxDQUFDTCxJQUFJTSxFQUFFLEVBQUU7UUFDWCxNQUFNQyxPQUFPLE1BQU1QLElBQUlPLElBQUk7UUFDM0IsTUFBTSxJQUFJQyxNQUFNRCxRQUFRLDBCQUFxQyxPQUFYUCxJQUFJUyxNQUFNO0lBQzlEO0lBQ0EsT0FBT1QsSUFBSVUsSUFBSTtBQUNqQjtBQUVBLFNBQVNDLGdCQUFnQkMsa0JBQXVCO0lBQzlDLElBQUk7WUFHMkNDLHVCQVVKRDtZQVg5QkE7UUFEWCxzREFBc0Q7UUFDdEQsTUFBTUMsS0FBS0QsQ0FBQUEsc0NBQUFBLCtCQUFBQSx5Q0FBQUEsbUJBQW9CRSxlQUFlLGNBQW5DRixpREFBQUEsc0NBQXVDLENBQUM7UUFDbkQsTUFBTUcsaUJBQXVDRixlQUFBQSwwQkFBQUEsd0JBQUFBLEVBQUksQ0FBQzlCLDJEQUFpQkEsQ0FBQyxjQUF2QjhCLDRDQUFBQSxzQkFBeUJHLEtBQUs7UUFDM0UsSUFBSUMsTUFBTUMsT0FBTyxDQUFDSCxtQkFBbUJBLGVBQWVJLFFBQVEsQ0FBQ25DLHVEQUFhQSxHQUFH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ckRvQyxRQUFRcEMsS0FBSyxDQUFDLHlCQUF5QnlCO2dCQUN6QztnQkFFQXhCLFNBQVNlO2dCQUNUYixTQUFTO1lBQ1g7UUFDRjtRQUNBRztJQUNGLEdBQUc7UUFBQ1A7S0FBTztJQUVYLDhEQUE4RDtJQUM5RCxJQUFJRyxVQUFVLFNBQVM7UUFDckIscUJBQ0UsOERBQUM5RCxpREFBR0E7WUFBQ29HLE1BQUs7WUFBUUMsU0FBUTtZQUFPQyxZQUFXO1lBQVNDLGdCQUFlO3NCQUNsRSw0RUFBQ25HLG9EQUFNQTtnQkFBQ29HLEtBQUs7O2tDQUNYLDhEQUFDdkcscURBQU9BOzs7OztrQ0FDUiw4REFBQ0Msa0RBQUlBO2tDQUFDOzs7Ozs7Ozs7Ozs7Ozs7OztJQUlkO0lBRUEsY0FBYztJQUNkLHFCQUNFLDhEQUFDRixpREFBR0E7UUFBQ29HLE1BQUs7UUFBUUMsU0FBUTtRQUFPQyxZQUFXO1FBQVNDLGdCQUFlO2tCQUNsRSw0RUFBQ25HLG9EQUFNQTtZQUFDb0csS0FBSzs7OEJBQ1gsOERBQUN0RyxrREFBSUE7b0JBQUN1RyxPQUFNO29CQUFVQyxZQUFXOzhCQUFROUM7Ozs7Ozs4QkFDekMsOERBQUN6RCxvREFBTUE7b0JBQUN3RyxTQUFTLElBQU1sRyxrRUFBa0JBLENBQUNKLG9EQUFVQTs4QkFBRzs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFJL0Q7R0F4T3dCcUQ7O1FBQ1AzRCxzREFBU0E7OztLQURGMkQiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9fTl9FLy4vc3JjL2FwcC9hdXRoL2NhbGxiYWNrL3BhZ2UudHN4PzRjMDgiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2UgY2xpZW50XCI7XG5cbmltcG9ydCB7IHVzZUVmZmVjdCwgdXNlU3RhdGUsIHVzZVJlZiB9IGZyb20gXCJyZWFjdFwiO1xuaW1wb3J0IHsgdXNlUm91dGVyIH0gZnJvbSBcIm5leHQvbmF2aWdhdGlvblwiO1xuaW1wb3J0IHsgQm94LCBTcGlubmVyLCBUZXh0LCBCdXR0b24sIFZTdGFjayB9IGZyb20gXCJAY2hha3JhLXVpL3JlYWN0XCI7XG5pbXBvcnQgeyBhdXRoQ29uZmlnLCBSRVFVSVJFRF9SRVNPVVJDRSwgUkVRVUlSRURfUk9MRSwgRU5GT1JDRV9ST0xFIH0gZnJvbSBcIkAvY29uZmlnL2F1dGhcIjtcbmltcG9ydCB7IHN0YXJ0QXV0aG9yaXphdGlvbiwgZ2V0Q29kZVZlcmlmaWVyQW5kU3RhdGUsIGNsZWFyUGtjZVN0YXRlIH0gZnJvbSBcIkAvbGliL2F1dGgvcGtjZVwiO1xuLy8gUmVtb3ZlZDogYmFja3VwVG9rZW5zIC0gdG9rZW5zIGFyZSBub3cgc3RvcmVkIHNlcnZlci1zaWRlIGluIFJlZGlzXG5cbmFzeW5jIGZ1bmN0aW9uIGV4Y2hhbmdlQ29kZUZvclRva2Vucyhjb2RlOiBzdHJpbmcsIGNvZGVWZXJpZmllcjogc3RyaW5nKSB7XG4gIGNvbnN0IGJvZHkgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKHtcbiAgICBncmFudF90eXBlOiBcImF1dGhvcml6YXRpb25fY29kZVwiLFxuICAgIGNsaWVudF9pZDogYXV0aENvbmZpZy5jbGllbnRJZCxcbiAgICBjb2RlLFxuICAgIHJlZGlyZWN0X3VyaTogYXV0aENvbmZpZy5yZWRpcmVjdFVyaSxcbiAgICBjb2RlX3ZlcmlmaWVyOiBjb2RlVmVyaWZpZXIsXG4gIH0pO1xuXG4gIGNvbnN0IHJlcyA9IGF3YWl0IGZldGNoKGF1dGhDb25maWcudG9rZW5VcmwsIHtcbiAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgIGhlYWRlcnM6IHsgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWRcIiB9LFxuICAgIGJvZHk6IGJvZHkudG9TdHJpbmcoKSxcbiAgfSk7XG4gIGlmICghcmVzLm9rKSB7XG4gICAgY29uc3QgdGV4dCA9IGF3YWl0IHJlcy50ZXh0KCk7XG4gICAgdGhyb3cgbmV3IEVycm9yKHRleHQgfHwgYFRva2VuIGV4Y2hhbmdlIGZhaWxlZDogJHtyZXMuc3RhdHVzfWApO1xuICB9XG4gIHJldHVybiByZXMuanNvbigpO1xufVxuXG5mdW5jdGlvbiBoYXNSZXF1aXJlZFJvbGUoYWNjZXNzVG9rZW5QYXlsb2FkOiBhbnkpOiBib29sZWFuIHtcbiAgdHJ5IHtcbiAgICAvLyAxKSBQcmVmZXJyZWQ6IGNsaWVudCByb2xlIG9uIHRoZSBzcGVjaWZpZWQgcmVzb3VyY2VcbiAgICBjb25zdCByYSA9IGFjY2Vzc1Rva2VuUGF5bG9hZD8ucmVzb3VyY2VfYWNjZXNzID8/IHt9O1xuICAgIGNvbnN0IHByZWZlcnJlZFJvbGVzOiBzdHJpbmdbXSB8IHVuZGVmaW5lZCA9IHJhPy5bUkVRVUlSRURfUkVTT1VSQ0VdPy5yb2xlcztcbiAgICBpZiAoQXJyYXkuaXNBcnJheShwcmVmZXJyZWRSb2xlcykgJiYgcHJlZmVycmVkUm9sZXMuaW5jbHVkZXMoUkVRVUlSRURfUk9MRSkpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIC8vIDIpIEZhbGxiYWNrOiByb2xlIGdyYW50ZWQgb24gYW55IGNsaWVudCByZXNvdXJjZSAoc29tZSBzZXR1cHMgbWFwIHRvIGEgZGlmZmVyZW50IGNsaWVudClcbiAgICBjb25zdCBhbnlDbGllbnRIYXMgPSBPYmplY3QudmFsdWVzKHJhKS5zb21lKCh2OiBhbnkpID0+IEFycmF5LmlzQXJyYXkodj8ucm9sZXMpICYmIHYucm9sZXMuaW5jbHVkZXMoUkVRVUlSRURfUk9MRSkpO1xuICAgIGlmIChhbnlDbGllbnRIYXMpIHJldHVybiB0cnVlO1xuXG4gICAgLy8gMykgRmFsbGJhY2s6IHJlYWxtIHJvbGVcbiAgICBjb25zdCByZWFsbVJvbGVzOiBzdHJpbmdbXSB8IHVuZGVmaW5lZCA9IGFjY2Vzc1Rva2VuUGF5bG9hZD8ucmVhbG1fYWNjZXNzPy5yb2xlcztcbiAgICBpZiAoQXJyYXkuaXNBcnJheShyZWFsbVJvbGVzKSAmJiByZWFsbVJvbGVzLmluY2x1ZGVzKFJFUVVJUkVEX1JPTEUpKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICByZXR1cm4gZmFsc2U7XG4gIH0gY2F0Y2gge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxufVxuXG5mdW5jdGlvbiBkZWNvZGVKd3QodG9rZW46IHN0cmluZyk6IGFueSB8IG51bGwge1xuICB0cnkge1xuICAgIGNvbnN0IFssIHBheWxvYWRdID0gdG9rZW4uc3BsaXQoXCIuXCIpO1xuICAgIGNvbnN0IGpzb24gPSBhdG9iKHBheWxvYWQucmVwbGFjZSgvLS9nLCBcIitcIikucmVwbGFjZSgvXy9nLCBcIi9cIikpO1xuICAgIHJldHVybiBKU09OLnBhcnNlKGpzb24pO1xuICB9IGNhdGNoIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBBdXRoQ2FsbGJhY2tQYWdlKCkge1xuICBjb25zdCByb3V0ZXIgPSB1c2VSb3V0ZXIoKTtcbiAgY29uc3QgW2Vycm9yLCBzZXRFcnJvcl0gPSB1c2VTdGF0ZTxzdHJpbmcgfCBudWxsPihudWxsKTtcbiAgY29uc3QgW3BoYXNlLCBzZXRQaGFzZV0gPSB1c2VTdGF0ZTxcImNoZWNraW5nXCIgfCBcImV4Y2hhbmdpbmdcIiB8IFwic3VjY2Vzc1wiIHwgXCJlcnJvclwiPihcImNoZWNraW5nXCIpO1xuICBjb25zdCBoYXNSdW5SZWYgPSB1c2VSZWYoZmFsc2UpO1xuXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgLy8gUHJldmVudCBkb3VibGUgZXhlY3V0aW9uIGluIFJlYWN0IFN0cmljdCBNb2RlXG4gICAgaWYgKGhhc1J1blJlZi5jdXJyZW50KSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGhhc1J1blJlZi5jdXJyZW50ID0gdHJ1ZTtcblxuICAgIGNvbnN0IHJ1biA9IGFzeW5jICgpID0+IHtcbiAgICAgIHNldFBoYXNlKFwiY2hlY2tpbmdcIik7XG4gICAgICBjb25zdCB1cmwgPSBuZXcgVVJMKHdpbmRvdy5sb2NhdGlvbi5ocmVmKTtcbiAgICAgIFxuICAgICAgLy8gQ2hlY2sgZm9yIEtleWNsb2FrIGVycm9yIHBhcmFtZXRlcnMgZmlyc3RcbiAgICAgIGNvbnN0IGVycm9yUGFyYW0gPSB1cmwuc2VhcmNoUGFyYW1zLmdldChcImVycm9yXCIpO1xuICAgICAgY29uc3QgZXJyb3JEZXNjcmlwdGlvbiA9IHVybC5zZWFyY2hQYXJhbXMuZ2V0KFwiZXJyb3JfZGVzY3JpcHRpb25cIik7XG4gICAgICBpZiAoZXJyb3JQYXJhbSkge1xuICAgICAgICBsZXQgZXJyb3JNZXNzYWdlID0gXCJBdXRoZW50aWNhdGlvbiBmYWlsZWQuXCI7XG4gICAgICAgIGlmIChlcnJvckRlc2NyaXB0aW9uKSB7XG4gICAgICAgICAgZXJyb3JNZXNzYWdlID0gZGVjb2RlVVJJQ29tcG9uZW50KGVycm9yRGVzY3JpcHRpb24pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIC8vIE1hcCBjb21tb24gS2V5Y2xvYWsgZXJyb3IgY29kZXMgdG8gdXNlci1mcmllbmRseSBtZXNzYWdlc1xuICAgICAgICAgIGNvbnN0IGVycm9yTWVzc2FnZXM6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7XG4gICAgICAgICAgICBcImFjY2Vzc19kZW5pZWRcIjogXCJBY2Nlc3Mgd2FzIGRlbmllZC4gUGxlYXNlIHRyeSBhZ2Fpbi5cIixcbiAgICAgICAgICAgIFwiaW52YWxpZF9yZXF1ZXN0XCI6IFwiSW52YWxpZCBhdXRoZW50aWNhdGlvbiByZXF1ZXN0LiBQbGVhc2UgdHJ5IGFnYWluLlwiLFxuICAgICAgICAgICAgXCJpbnZhbGlkX2NsaWVudFwiOiBcIkF1dGhlbnRpY2F0aW9uIGNvbmZpZ3VyYXRpb24gZXJyb3IuIFBsZWFzZSBjb250YWN0IHN1cHBvcnQuXCIsXG4gICAgICAgICAgICBcImludmFsaWRfZ3JhbnRcIjogXCJBdXRoZW50aWNhdGlvbiBzZXNzaW9uIGV4cGlyZWQuIFBsZWFzZSB0cnkgYWdhaW4uXCIsXG4gICAgICAgICAgICBcInVuYXV0aG9yaXplZF9jbGllbnRcIjogXCJDbGllbnQgbm90IGF1dGhvcml6ZWQuIFBsZWFzZSBjb250YWN0IHN1cHBvcnQuXCIsXG4gICAgICAgICAgICBcInVuc3VwcG9ydGVkX2dyYW50X3R5cGVcIjogXCJBdXRoZW50aWNhdGlvbiBtZXRob2Qgbm90IHN1cHBvcnRlZC4gUGxlYXNlIGNvbnRhY3Qgc3VwcG9ydC5cIixcbiAgICAgICAgICAgIFwiaW52YWxpZF9zY29wZVwiOiBcIlJlcXVlc3RlZCBwZXJtaXNzaW9ucyBhcmUgaW52YWxpZC4gUGxlYXNlIGNvbnRhY3Qgc3VwcG9ydC5cIixcbiAgICAgICAgICAgIFwic2VydmVyX2Vycm9yXCI6IFwiQXV0aGVudGljYXRpb24gc2VydmVyIGVycm9yLiBQbGVhc2UgdHJ5IGFnYWluIGxhdGVyLlwiLFxuICAgICAgICAgICAgXCJ0ZW1wb3JhcmlseV91bmF2YWlsYWJsZVwiOiBcIkF1dGhlbnRpY2F0aW9uIHNlcnZpY2UgaXMgdGVtcG9yYXJpbHkgdW5hdmFpbGFibGUuIFBsZWFzZSB0cnkgYWdhaW4gbGF0ZXIuXCIsXG4gICAgICAgICAgfTtcbiAgICAgICAgICBlcnJvck1lc3NhZ2UgPSBlcnJvck1lc3NhZ2VzW2Vycm9yUGFyYW1dIHx8IGVycm9yTWVzc2FnZTtcbiAgICAgICAgfVxuICAgICAgICBzZXRFcnJvcihlcnJvck1lc3NhZ2UpO1xuICAgICAgICBzZXRQaGFzZShcImVycm9yXCIpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBcbiAgICAgIGNvbnN0IGNvZGUgPSB1cmwuc2VhcmNoUGFyYW1zLmdldChcImNvZGVcIik7XG4gICAgICBjb25zdCByZXR1cm5lZFN0YXRlID0gdXJsLnNlYXJjaFBhcmFtcy5nZXQoXCJzdGF0ZVwiKTtcbiAgICAgIGNvbnN0IHsgY29kZVZlcmlmaWVyLCBzdGF0ZSB9ID0gZ2V0Q29kZVZlcmlmaWVyQW5kU3RhdGUoKTtcblxuICAgICAgLy8gSWYgY29kZSBpcyBtaXNzaW5nLCB1c2VyIG5hdmlnYXRlZCBkaXJlY3RseSB0byBjYWxsYmFjazogc3RhcnQgZmxvd1xuICAgICAgaWYgKCFjb2RlIHx8ICFjb2RlVmVyaWZpZXIpIHtcbiAgICAgICAgc3RhcnRBdXRob3JpemF0aW9uKGF1dGhDb25maWcpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIFZhbGlkYXRlIHN0YXRlIHBhcmFtZXRlciAoQ1NSRiBwcm90ZWN0aW9uKVxuICAgICAgaWYgKHN0YXRlICYmIHJldHVybmVkU3RhdGUgJiYgc3RhdGUgIT09IHJldHVybmVkU3RhdGUpIHtcbiAgICAgICAgc2V0RXJyb3IoXCJTZWN1cml0eSB2YWxpZGF0aW9uIGZhaWxlZC4gUGxlYXNlIHRyeSBhZ2Fpbi5cIik7XG4gICAgICAgIHNldFBoYXNlKFwiZXJyb3JcIik7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gSWYgbm8gc3RhdGUgd2FzIHNlbnQgYnV0IG9uZSB3YXMgcmV0dXJuZWQsIHRoYXQncyBhbHNvIHN1c3BpY2lvdXNcbiAgICAgIGlmICghc3RhdGUgJiYgcmV0dXJuZWRTdGF0ZSkge1xuICAgICAgICBzZXRFcnJvcihcIlNlY3VyaXR5IHZhbGlkYXRpb24gZmFpbGVkLiBQbGVhc2UgdHJ5IGFnYWluLlwiKTtcbiAgICAgICAgc2V0UGhhc2UoXCJlcnJvclwiKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICB0cnkge1xuICAgICAgICBzZXRQaGFzZShcImV4Y2hhbmdpbmdcIik7XG4gICAgICAgIFxuICAgICAgICAvLyBSZXRyeSBsb2dpYyBmb3IgbmV0d29yayBmYWlsdXJlc1xuICAgICAgICBsZXQgdG9rZW5zO1xuICAgICAgICBsZXQgbGFzdEVycm9yOiBFcnJvciB8IG51bGwgPSBudWxsO1xuICAgICAgICBjb25zdCBtYXhSZXRyaWVzID0gMztcbiAgICAgICAgXG4gICAgICAgIGZvciAobGV0IGF0dGVtcHQgPSAxOyBhdHRlbXB0IDw9IG1heFJldHJpZXM7IGF0dGVtcHQrKykge1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICB0b2tlbnMgPSBhd2FpdCBleGNoYW5nZUNvZGVGb3JUb2tlbnMoY29kZSwgY29kZVZlcmlmaWVyKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH0gY2F0Y2ggKGU6IGFueSkge1xuICAgICAgICAgICAgbGFzdEVycm9yID0gZTtcbiAgICAgICAgICAgIC8vIERvbid0IHJldHJ5IG9uIGNsaWVudCBlcnJvcnMgKDR4eClcbiAgICAgICAgICAgIGlmIChlLm1lc3NhZ2U/LmluY2x1ZGVzKCc0MDAnKSB8fCBlLm1lc3NhZ2U/LmluY2x1ZGVzKCc0MDEnKSB8fCBcbiAgICAgICAgICAgICAgICBlLm1lc3NhZ2U/LmluY2x1ZGVzKCc0MDMnKSB8fCBlLm1lc3NhZ2U/LmluY2x1ZGVzKCc0MDQnKSkge1xuICAgICAgICAgICAgICB0aHJvdyBlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gUmV0cnkgb24gbmV0d29yay9zZXJ2ZXIgZXJyb3JzXG4gICAgICAgICAgICBpZiAoYXR0ZW1wdCA8IG1heFJldHJpZXMpIHtcbiAgICAgICAgICAgICAgYXdhaXQgbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIDEwMDAgKiBhdHRlbXB0KSk7IC8vIEV4cG9uZW50aWFsIGJhY2tvZmZcbiAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aHJvdyBlO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgaWYgKCF0b2tlbnMpIHtcbiAgICAgICAgICB0aHJvdyBsYXN0RXJyb3IgfHwgbmV3IEVycm9yKFwiRmFpbGVkIHRvIGV4Y2hhbmdlIGF1dGhvcml6YXRpb24gY29kZVwiKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgY29uc3QgYWNjZXNzID0gdG9rZW5zLmFjY2Vzc190b2tlbiBhcyBzdHJpbmc7XG4gICAgICAgIGNvbnN0IHJlZnJlc2ggPSB0b2tlbnMucmVmcmVzaF90b2tlbiBhcyBzdHJpbmcgfCB1bmRlZmluZWQ7XG4gICAgICAgIFxuICAgICAgICAvLyBWYWxpZGF0ZSBhY2Nlc3MgdG9rZW4gZm9ybWF0XG4gICAgICAgIGlmICghYWNjZXNzIHx8IHR5cGVvZiBhY2Nlc3MgIT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgc2V0RXJyb3IoXCJSZWNlaXZlZCBpbnZhbGlkIGF1dGhlbnRpY2F0aW9uIHRva2VuLiBQbGVhc2UgdHJ5IGFnYWluLlwiKTtcbiAgICAgICAgICBzZXRQaGFzZShcImVycm9yXCIpO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgY29uc3QgdG9rZW5QYXJ0cyA9IGFjY2Vzcy5zcGxpdCgnLicpO1xuICAgICAgICBpZiAodG9rZW5QYXJ0cy5sZW5ndGggIT09IDMpIHtcbiAgICAgICAgICBzZXRFcnJvcihcIlJlY2VpdmVkIGludmFsaWQgYXV0aGVudGljYXRpb24gdG9rZW4gZm9ybWF0LiBQbGVhc2UgdHJ5IGFnYWluLlwiKTtcbiAgICAgICAgICBzZXRQaGFzZShcImVycm9yXCIpO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgY29uc3QgcGF5bG9hZCA9IGRlY29kZUp3dChhY2Nlc3MpO1xuICAgICAgICBpZiAoIXBheWxvYWQpIHtcbiAgICAgICAgICBzZXRFcnJvcihcIkZhaWxlZCB0byBwcm9jZXNzIGF1dGhlbnRpY2F0aW9uIHRva2VuLiBQbGVhc2UgdHJ5IGFnYWluLlwiKTtcbiAgICAgICAgICBzZXRQaGFzZShcImVycm9yXCIpO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChFTkZPUkNFX1JPTEUgJiYgIWhhc1JlcXVpcmVkUm9sZShwYXlsb2FkKSkge1xuICAgICAgICAgIHNldEVycm9yKFwiWW91ciBhY2NvdW50IGxhY2tzIHRoZSByZXF1aXJlZCBidXNpbmVzcy11c2VyIHJvbGUuXCIpO1xuICAgICAgICAgIHNldFBoYXNlKFwiZXJyb3JcIik7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gU0VDVVJJVFk6IFRva2VucyBhcmUgbm93IHN0b3JlZCBzZXJ2ZXItc2lkZSBpbiBSZWRpcyB2aWEgTmV4dEF1dGhcbiAgICAgICAgLy8gRE8gTk9UIHN0b3JlIHRva2VucyBpbiBsb2NhbFN0b3JhZ2UgLSB0aGlzIGlzIGEgc2VjdXJpdHkgcmlza1xuICAgICAgICAvLyBOZXh0QXV0aCBoYW5kbGVzIHRva2VuIHN0b3JhZ2UgYW5kIHRoZSBBUEkgcHJveHkgaW5qZWN0cyB0b2tlbnMgYXV0b21hdGljYWxseVxuICAgICAgICAvLyBUaGlzIGNhbGxiYWNrIHBhZ2UgaXMgb25seSBmb3IgbGVnYWN5IFBLQ0UgZmxvdyAtIE5leHRBdXRoIGhhbmRsZXMgT0F1dGggY2FsbGJhY2tzIGF0IC9hcGkvYXV0aC9jYWxsYmFjay9rZXljbG9ha1xuICAgICAgICBcbiAgICAgICAgY2xlYXJQa2NlU3RhdGUoKTtcbiAgICAgICAgXG4gICAgICAgIC8vIFJlZGlyZWN0IHRvIE5leHRBdXRoIHNpZ24taW4gdG8gY29tcGxldGUgdGhlIGZsb3cgcHJvcGVybHlcbiAgICAgICAgLy8gTmV4dEF1dGggd2lsbCBoYW5kbGUgdG9rZW4gc3RvcmFnZSBpbiBSZWRpc1xuICAgICAgICBjb25zb2xlLmxvZygnW0F1dGggQ2FsbGJhY2tdIExlZ2FjeSBQS0NFIGZsb3cgZGV0ZWN0ZWQgLSByZWRpcmVjdGluZyB0byBOZXh0QXV0aCcpO1xuXG4gICAgICAgIHNldFBoYXNlKFwic3VjY2Vzc1wiKTtcbiAgICAgICAgLy8gU21hbGwgZGVsYXkgdG8gZW5zdXJlIHN0b3JhZ2UgaXMgd3JpdHRlblxuICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgMTAwKSk7XG4gICAgICAgIHJvdXRlci5yZXBsYWNlKFwiL3BhcnRuZXIvZGFzaGJvYXJkXCIpO1xuICAgICAgfSBjYXRjaCAoZTogYW55KSB7XG4gICAgICAgIGxldCBlcnJvck1lc3NhZ2UgPSBcIkF1dGhlbnRpY2F0aW9uIGZhaWxlZC4gUGxlYXNlIHRyeSBhZ2Fpbi5cIjtcbiAgICAgICAgXG4gICAgICAgIC8vIFRyeSB0byBwYXJzZSBKU09OIGVycm9yIHJlc3BvbnNlIGZyb20gS2V5Y2xvYWtcbiAgICAgICAgbGV0IGVycm9yRGF0YTogYW55ID0gbnVsbDtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBpZiAoZS5tZXNzYWdlICYmIHR5cGVvZiBlLm1lc3NhZ2UgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICBlcnJvckRhdGEgPSBKU09OLnBhcnNlKGUubWVzc2FnZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIHtcbiAgICAgICAgICAvLyBOb3QgSlNPTiwgdXNlIHN0cmluZyBhcy1pc1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBIYW5kbGUgc3BlY2lmaWMgS2V5Y2xvYWsgZXJyb3IgY29kZXNcbiAgICAgICAgaWYgKGVycm9yRGF0YT8uZXJyb3IgPT09ICdpbnZhbGlkX2dyYW50Jykge1xuICAgICAgICAgIGVycm9yTWVzc2FnZSA9IGVycm9yRGF0YS5lcnJvcl9kZXNjcmlwdGlvbiBcbiAgICAgICAgICAgID8gZGVjb2RlVVJJQ29tcG9uZW50KGVycm9yRGF0YS5lcnJvcl9kZXNjcmlwdGlvbilcbiAgICAgICAgICAgIDogXCJZb3VyIGF1dGhlbnRpY2F0aW9uIHNlc3Npb24gaGFzIGV4cGlyZWQuIFBsZWFzZSBzaWduIGluIGFnYWluLlwiO1xuICAgICAgICAgIC8vIENsZWFyIFBLQ0Ugc3RhdGUgYW5kIHJlZGlyZWN0IHRvIGxvZ2luXG4gICAgICAgICAgY2xlYXJQa2NlU3RhdGUoKTtcbiAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgIHJvdXRlci5yZXBsYWNlKCcvYXV0aC9sb2dpbicpO1xuICAgICAgICAgIH0sIDIwMDApO1xuICAgICAgICAgIHNldEVycm9yKGVycm9yTWVzc2FnZSk7XG4gICAgICAgICAgc2V0UGhhc2UoXCJlcnJvclwiKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIFByb3ZpZGUgbW9yZSBzcGVjaWZpYyBlcnJvciBtZXNzYWdlc1xuICAgICAgICBpZiAoZS5tZXNzYWdlPy5pbmNsdWRlcygnTmV0d29ya0Vycm9yJykgfHwgZS5tZXNzYWdlPy5pbmNsdWRlcygnRmFpbGVkIHRvIGZldGNoJykpIHtcbiAgICAgICAgICBlcnJvck1lc3NhZ2UgPSBcIk5ldHdvcmsgZXJyb3IuIFBsZWFzZSBjaGVjayB5b3VyIGNvbm5lY3Rpb24gYW5kIHRyeSBhZ2Fpbi5cIjtcbiAgICAgICAgfSBlbHNlIGlmIChlLm1lc3NhZ2U/LmluY2x1ZGVzKCc0MDEnKSkge1xuICAgICAgICAgIGVycm9yTWVzc2FnZSA9IFwiQXV0aGVudGljYXRpb24gZmFpbGVkLiBQbGVhc2Ugc2lnbiBpbiBhZ2Fpbi5cIjtcbiAgICAgICAgfSBlbHNlIGlmIChlLm1lc3NhZ2U/LmluY2x1ZGVzKCc0MDAnKSkge1xuICAgICAgICAgIC8vIFBhcnNlIEpTT04gZXJyb3IgaWYgcG9zc2libGVcbiAgICAgICAgICBpZiAoZXJyb3JEYXRhPy5lcnJvcl9kZXNjcmlwdGlvbikge1xuICAgICAgICAgICAgZXJyb3JNZXNzYWdlID0gZGVjb2RlVVJJQ29tcG9uZW50KGVycm9yRGF0YS5lcnJvcl9kZXNjcmlwdGlvbik7XG4gICAgICAgICAgfSBlbHNlIGlmIChlcnJvckRhdGE/LmVycm9yID09PSAnaW52YWxpZF9ncmFudCcpIHtcbiAgICAgICAgICAgIC8vIEhhbmRsZSBcImNvZGUgYWxyZWFkeSB1c2VkXCIgc2NlbmFyaW8gKGNvbW1vbiBpbiBSZWFjdCBTdHJpY3QgTW9kZSlcbiAgICAgICAgICAgIGVycm9yTWVzc2FnZSA9IFwiVGhlIGF1dGhvcml6YXRpb24gY29kZSBoYXMgYWxyZWFkeSBiZWVuIHVzZWQuIFRoaXMgbWF5IGhhcHBlbiBpZiB0aGUgcGFnZSByZWxvYWRlZC4gUGxlYXNlIHNpZ24gaW4gYWdhaW4uXCI7XG4gICAgICAgICAgICAvLyBDbGVhciBQS0NFIHN0YXRlIGFuZCByZWRpcmVjdCB0byBsb2dpblxuICAgICAgICAgICAgY2xlYXJQa2NlU3RhdGUoKTtcbiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICByb3V0ZXIucmVwbGFjZSgnLycpO1xuICAgICAgICAgICAgfSwgMjAwMCk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGVycm9yTWVzc2FnZSA9IFwiSW52YWxpZCBhdXRoZW50aWNhdGlvbiByZXF1ZXN0LiBUaGUgYXV0aG9yaXphdGlvbiBjb2RlIG1heSBoYXZlIGV4cGlyZWQgb3IgYWxyZWFkeSBiZWVuIHVzZWQuIFBsZWFzZSB0cnkgYWdhaW4uXCI7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKGVycm9yRGF0YT8uZXJyb3JfZGVzY3JpcHRpb24pIHtcbiAgICAgICAgICBlcnJvck1lc3NhZ2UgPSBkZWNvZGVVUklDb21wb25lbnQoZXJyb3JEYXRhLmVycm9yX2Rlc2NyaXB0aW9uKTtcbiAgICAgICAgfSBlbHNlIGlmIChlLm1lc3NhZ2UpIHtcbiAgICAgICAgICBlcnJvck1lc3NhZ2UgPSBlLm1lc3NhZ2U7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIERvbid0IGxvZyBleHBlY3RlZCBlcnJvcnMgKGxpa2UgaW52YWxpZF9ncmFudCBmcm9tIGV4cGlyZWQgY29kZXMpXG4gICAgICAgIGlmICghZXJyb3JEYXRhIHx8IGVycm9yRGF0YS5lcnJvciAhPT0gJ2ludmFsaWRfZ3JhbnQnKSB7XG4gICAgICAgICAgY29uc29sZS5lcnJvcignQXV0aGVudGljYXRpb24gZXJyb3I6JywgZSk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHNldEVycm9yKGVycm9yTWVzc2FnZSk7XG4gICAgICAgIHNldFBoYXNlKFwiZXJyb3JcIik7XG4gICAgICB9XG4gICAgfTtcbiAgICBydW4oKTtcbiAgfSwgW3JvdXRlcl0pO1xuXG4gIC8vIFVuaWZpZWQgZnVsbC1zY3JlZW4gbG9hZGVyIG92ZXJsYXkgZm9yIGFsbCBub24tZXJyb3Igc3RhdGVzXG4gIGlmIChwaGFzZSAhPT0gXCJlcnJvclwiKSB7XG4gICAgcmV0dXJuIChcbiAgICAgIDxCb3ggbWluSD1cIjEwMHZoXCIgZGlzcGxheT1cImZsZXhcIiBhbGlnbkl0ZW1zPVwiY2VudGVyXCIganVzdGlmeUNvbnRlbnQ9XCJjZW50ZXJcIj5cbiAgICAgICAgPFZTdGFjayBnYXA9ezR9PlxuICAgICAgICAgIDxTcGlubmVyIC8+XG4gICAgICAgICAgPFRleHQ+Q29tcGxldGluZyBzaWduLWlu4oCmPC9UZXh0PlxuICAgICAgICA8L1ZTdGFjaz5cbiAgICAgIDwvQm94PlxuICAgICk7XG4gIH1cblxuICAvLyBFcnJvciBzdGF0ZVxuICByZXR1cm4gKFxuICAgIDxCb3ggbWluSD1cIjEwMHZoXCIgZGlzcGxheT1cImZsZXhcIiBhbGlnbkl0ZW1zPVwiY2VudGVyXCIganVzdGlmeUNvbnRlbnQ9XCJjZW50ZXJcIj5cbiAgICAgIDxWU3RhY2sgZ2FwPXs0fT5cbiAgICAgICAgPFRleHQgY29sb3I9XCJyZWQuNTAwXCIgZm9udFdlaWdodD1cImJvbGRcIj57ZXJyb3J9PC9UZXh0PlxuICAgICAgICA8QnV0dG9uIG9uQ2xpY2s9eygpID0+IHN0YXJ0QXV0aG9yaXphdGlvbihhdXRoQ29uZmlnKX0+QmFjayB0byBzaWduIGluPC9CdXR0b24+XG4gICAgICA8L1ZTdGFjaz5cbiAgICA8L0JveD5cbiAgKTtcbn1cblxuXG4iXSwibmFtZXMiOlsidXNlRWZmZWN0IiwidXNlU3RhdGUiLCJ1c2VSZWYiLCJ1c2VSb3V0ZXIiLCJCb3giLCJTcGlubmVyIiwiVGV4dCIsIkJ1dHRvbiIsIlZTdGFjayIsImF1dGhDb25maWciLCJSRVFVSVJFRF9SRVNPVVJDRSIsIlJFUVVJUkVEX1JPTEUiLCJFTkZPUkNFX1JPTEUiLCJzdGFydEF1dGhvcml6YXRpb24iLCJnZXRDb2RlVmVyaWZpZXJBbmRTdGF0ZSIsImNsZWFyUGtjZVN0YXRlIiwiZXhjaGFuZ2VDb2RlRm9yVG9rZW5zIiwiY29kZSIsImNvZGVWZXJpZmllciIsImJvZHkiLCJVUkxTZWFyY2hQYXJhbXMiLCJncmFudF90eXBlIiwiY2xpZW50X2lkIiwiY2xpZW50SWQiLCJyZWRpcmVjdF91cmkiLCJyZWRpcmVjdFVyaSIsImNvZGVfdmVyaWZpZXIiLCJyZXMiLCJmZXRjaCIsInRva2VuVXJsIiwibWV0aG9kIiwiaGVhZGVycyIsInRvU3RyaW5nIiwib2siLCJ0ZXh0IiwiRXJyb3IiLCJzdGF0dXMiLCJqc29uIiwiaGFzUmVxdWlyZWRSb2xlIiwiYWNjZXNzVG9rZW5QYXlsb2FkIiwicmEiLCJyZXNvdXJjZV9hY2Nlc3MiLCJwcmVmZXJyZWRSb2xlcyIsInJvbGVzIiwiQXJyYXkiLCJpc0FycmF5IiwiaW5jbHVkZXMiLCJhbnlDbGllbnRIYXMiLCJPYmplY3QiLCJ2YWx1ZXMiLCJzb21lIiwidiIsInJlYWxtUm9sZXMiLCJyZWFsbV9hY2Nlc3MiLCJkZWNvZGVKd3QiLCJ0b2tlbiIsInBheWxvYWQiLCJzcGxpdCIsImF0b2IiLCJyZXBsYWNlIiwiSlNPTiIsInBhcnNlIiwiQXV0aENhbGxiYWNrUGFnZSIsInJvdXRlciIsImVycm9yIiwic2V0RXJyb3IiLCJwaGFzZSIsInNldFBoYXNlIiwiaGFzUnVuUmVmIiwiY3VycmVudCIsInJ1biIsInVybCIsIlVSTCIsIndpbmRvdyIsImxvY2F0aW9uIiwiaHJlZiIsImVycm9yUGFyYW0iLCJzZWFyY2hQYXJhbXMiLCJnZXQiLCJlcnJvckRlc2NyaXB0aW9uIiwiZXJyb3JNZXNzYWdlIiwiZGVjb2RlVVJJQ29tcG9uZW50IiwiZXJyb3JNZXNzYWdlcyIsInJldHVybmVkU3RhdGUiLCJzdGF0ZSIsInRva2VucyIsImxhc3RFcnJvciIsIm1heFJldHJpZXMiLCJhdHRlbXB0IiwiZSIsIm1lc3NhZ2UiLCJQcm9taXNlIiwicmVzb2x2ZSIsInNldFRpbWVvdXQiLCJhY2Nlc3MiLCJhY2Nlc3NfdG9rZW4iLCJyZWZyZXNoIiwicmVmcmVzaF90b2tlbiIsInRva2VuUGFydHMiLCJsZW5ndGgiLCJjb25zb2xlIiwibG9nIiwiZXJyb3JEYXRhIiwiZXJyb3JfZGVzY3JpcHRpb24iLCJtaW5IIiwiZGlzcGxheSIsImFsaWduSXRlbXMiLCJqdXN0aWZ5Q29udGVudCIsImdhcCIsImNvbG9yIiwiZm9udFdlaWdodCIsIm9uQ2xpY2siXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(app-pages-browser)/./src/app/auth/callback/page.tsx\n"));

/***/ })

});