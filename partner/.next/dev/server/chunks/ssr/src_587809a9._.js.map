{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/mukurusystemsadministrator/Desktop/onboarding_kyc%20copy/partner/src/hooks/useFormPersistence.ts"],"sourcesContent":["\"use client\";\n\nimport { useState, useEffect, useCallback } from 'react';\n\ninterface FormData {\n  [key: string]: any;\n}\n\ninterface UseFormPersistenceOptions {\n  formId: string;\n  autoSaveInterval?: number; // in milliseconds\n  debounceMs?: number;\n}\n\nexport function useFormPersistence<T extends FormData>(\n  initialData: T,\n  options: UseFormPersistenceOptions\n) {\n  const { formId, autoSaveInterval = 30000, debounceMs = 1000 } = options;\n  const storageKey = `form_${formId}`;\n  \n  const [formData, setFormData] = useState<T>(initialData);\n  const [isDirty, setIsDirty] = useState(false);\n  const [lastSaved, setLastSaved] = useState<Date | null>(null);\n  const [isSaving, setIsSaving] = useState(false);\n  const [saveError, setSaveError] = useState<string | null>(null);\n\n  // Load saved data on mount\n  useEffect(() => {\n    try {\n      const savedData = localStorage.getItem(storageKey);\n      if (savedData) {\n        const parsed = JSON.parse(savedData);\n        setFormData(parsed.data);\n        setLastSaved(new Date(parsed.timestamp));\n        setIsDirty(false);\n      }\n    } catch (error) {\n      console.error('Error loading saved form data:', error);\n    }\n  }, [storageKey]);\n\n  // Auto-save functionality\n  useEffect(() => {\n    if (!isDirty) return;\n\n    const timeoutId = setTimeout(() => {\n      saveToStorage();\n    }, debounceMs);\n\n    return () => clearTimeout(timeoutId);\n  }, [formData, isDirty, debounceMs]);\n\n  // Periodic auto-save\n  useEffect(() => {\n    if (!isDirty) return;\n\n    const intervalId = setInterval(() => {\n      saveToStorage();\n    }, autoSaveInterval);\n\n    return () => clearInterval(intervalId);\n  }, [isDirty, autoSaveInterval]);\n\n  const saveToStorage = useCallback(async () => {\n    if (!isDirty) return;\n\n    try {\n      setIsSaving(true);\n      setSaveError(null);\n      \n      const dataToSave = {\n        data: formData,\n        timestamp: new Date().toISOString(),\n        version: '1.0'\n      };\n\n      localStorage.setItem(storageKey, JSON.stringify(dataToSave));\n      setLastSaved(new Date());\n      setIsDirty(false);\n    } catch (error) {\n      setSaveError('Failed to save form data');\n      console.error('Error saving form data:', error);\n    } finally {\n      setIsSaving(false);\n    }\n  }, [formData, isDirty, storageKey]);\n\n  const updateField = useCallback((field: string, value: any) => {\n    setFormData(prev => ({\n      ...prev,\n      [field]: value\n    }));\n    setIsDirty(true);\n  }, []);\n\n  const updateNestedField = useCallback((parentField: string, childField: string, value: any) => {\n    setFormData(prev => ({\n      ...prev,\n      [parentField]: {\n        ...prev[parentField],\n        [childField]: value\n      }\n    }));\n    setIsDirty(true);\n  }, []);\n\n  const updateArrayField = useCallback((field: string, index: number, value: any) => {\n    setFormData(prev => ({\n      ...prev,\n      [field]: prev[field].map((item: any, i: number) => \n        i === index ? value : item\n      )\n    }));\n    setIsDirty(true);\n  }, []);\n\n  const addArrayItem = useCallback((field: string, item: any) => {\n    setFormData(prev => ({\n      ...prev,\n      [field]: [...(prev[field] || []), item]\n    }));\n    setIsDirty(true);\n  }, []);\n\n  const removeArrayItem = useCallback((field: string, index: number) => {\n    setFormData(prev => ({\n      ...prev,\n      [field]: prev[field].filter((_: any, i: number) => i !== index)\n    }));\n    setIsDirty(true);\n  }, []);\n\n  const clearSavedData = useCallback(() => {\n    localStorage.removeItem(storageKey);\n    setLastSaved(null);\n    setIsDirty(false);\n  }, [storageKey]);\n\n  const forceSave = useCallback(() => {\n    return saveToStorage();\n  }, [saveToStorage]);\n\n  return {\n    formData,\n    updateField,\n    updateNestedField,\n    updateArrayField,\n    addArrayItem,\n    removeArrayItem,\n    isDirty,\n    lastSaved,\n    isSaving,\n    saveError,\n    clearSavedData,\n    forceSave\n  };\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 154, "column": 0}, "map": {"version":3,"sources":["file:///Users/mukurusystemsadministrator/Desktop/onboarding_kyc%20copy/partner/src/lib/entityFormConfigs.ts"],"sourcesContent":["export interface FormField {\n  id: string;\n  label: string;\n  type: 'text' | 'email' | 'tel' | 'url' | 'number' | 'date' | 'textarea' | 'select' | 'checkbox' | 'radio' | 'file' | 'custom';\n  required?: boolean;\n  placeholder?: string;\n  description?: string;\n  validation?: {\n    min?: number;\n    max?: number;\n    pattern?: string;\n    custom?: (value: any) => string | null;\n  };\n  options?: Array<{ value: string; label: string; disabled?: boolean }>;\n  dependencies?: {\n    field: string;\n    value: any;\n    show?: boolean;\n    required?: boolean;\n  }[];\n  externalValidation?: {\n    enabled: boolean;\n    apiEndpoint?: string;\n    loadingText?: string;\n    successText?: string;\n    errorText?: string;\n  };\n  conditional?: {\n    field: string;\n    operator: 'equals' | 'not_equals' | 'contains' | 'greater_than' | 'less_than';\n    value: any;\n  };\n  group?: string;\n  order?: number;\n}\n\nexport interface EntityFormConfig {\n  entityType: string;\n  displayName: string;\n  description: string;\n  steps: {\n    id: string;\n    title: string;\n    subtitle: string;\n    fields: FormField[];\n    requiredDocuments: string[];\n    // Metadata for integration with checklist and work-queue\n    requirementType?: string;\n    checklistCategory?: string;\n    stepNumber?: number;\n  }[];\n  requiredDocuments: {\n    id: string;\n    name: string;\n    description: string;\n    required: boolean;\n    category: string;\n  }[];\n}\n\nexport const entityFormConfigs: Record<string, EntityFormConfig> = {\n  'private_company': {\n    entityType: 'private_company',\n    displayName: 'Private Company / Limited Liability Company',\n    description: 'Registered companies and corporations',\n    steps: [\n      {\n        id: 'business_info',\n        title: 'Business Information',\n        subtitle: 'Company details and registration',\n        fields: [\n          {\n            id: 'companyName',\n            label: 'Company Name',\n            type: 'text',\n            required: true,\n            placeholder: 'Enter your company name',\n            externalValidation: {\n              enabled: true,\n              apiEndpoint: '/api/validate/company-name',\n              loadingText: 'Validating company name...',\n              successText: 'Company name verified',\n              errorText: 'Company name not found'\n            },\n            order: 1\n          },\n          {\n            id: 'country',\n            label: 'Country',\n            type: 'select',\n            required: true,\n            placeholder: 'Select country',\n            options: [\n              { value: 'South Africa', label: 'South Africa' },\n              { value: 'Kenya', label: 'Kenya' },\n              { value: 'Nigeria', label: 'Nigeria' },\n              { value: 'Ghana', label: 'Ghana' },\n              { value: 'Zimbabwe', label: 'Zimbabwe' },\n              { value: 'Zambia', label: 'Zambia' },\n              { value: 'Tanzania', label: 'Tanzania' },\n              { value: 'Uganda', label: 'Uganda' },\n              { value: 'Rwanda', label: 'Rwanda' },\n              { value: 'Mauritius', label: 'Mauritius' }\n            ],\n            order: 2\n          },\n          {\n            id: 'tradingName',\n            label: 'Trading Name (if different)',\n            type: 'text',\n            required: false,\n            placeholder: 'Enter trading name',\n            order: 3\n          },\n          {\n            id: 'registrationNumber',\n            label: 'Registration Number',\n            type: 'text',\n            required: true,\n            placeholder: 'Enter company registration number',\n            externalValidation: {\n              enabled: true,\n              apiEndpoint: '/api/validate/registration',\n              loadingText: 'Validating registration...',\n              successText: 'Registration verified',\n              errorText: 'Invalid registration number'\n            },\n            order: 4\n          },\n          {\n            id: 'applicantName',\n            label: 'Applicant Full Name',\n            type: 'text',\n            required: true,\n            placeholder: 'Enter your full name',\n            order: 5\n          },\n          {\n            id: 'applicantEmail',\n            label: 'Applicant Email',\n            type: 'email',\n            required: true,\n            placeholder: 'Enter your email address',\n            order: 6\n          },\n          {\n            id: 'taxNumber',\n            label: 'Tax Number',\n            type: 'text',\n            required: true,\n            placeholder: 'Enter tax identification number',\n            externalValidation: {\n              enabled: true,\n              apiEndpoint: '/api/validate/tax-number',\n              loadingText: 'Validating tax number...',\n              successText: 'Tax number verified',\n              errorText: 'Invalid tax number'\n            },\n            order: 7\n          },\n          {\n            id: 'dateOfIncorporation',\n            label: 'Date of Incorporation',\n            type: 'date',\n            required: true,\n            order: 8\n          },\n          {\n            id: 'placeOfIncorporation',\n            label: 'Place of Incorporation',\n            type: 'text',\n            required: true,\n            placeholder: 'Enter place of incorporation',\n            order: 9\n          }\n        ],\n        requiredDocuments: ['certificate_incorporation', 'memorandum_association']\n      },\n      {\n        id: 'business_address',\n        title: 'Business Address',\n        subtitle: 'Registered and operating addresses',\n        fields: [\n          {\n            id: 'businessAddress',\n            label: 'Registered Business Address',\n            type: 'textarea',\n            required: true,\n            placeholder: 'Enter complete business address',\n            order: 1\n          },\n          {\n            id: 'businessCity',\n            label: 'City',\n            type: 'text',\n            required: true,\n            placeholder: 'Enter city',\n            order: 2\n          },\n          {\n            id: 'businessCountry',\n            label: 'Country',\n            type: 'select',\n            required: true,\n            options: [\n              { value: 'ZA', label: 'South Africa' },\n              { value: 'UK', label: 'United Kingdom' },\n              { value: 'US', label: 'United States' },\n              { value: 'AU', label: 'Australia' },\n              { value: 'CA', label: 'Canada' }\n            ],\n            order: 3\n          },\n          {\n            id: 'businessPostalCode',\n            label: 'Postal Code',\n            type: 'text',\n            required: true,\n            placeholder: 'Enter postal code',\n            order: 4\n          },\n          {\n            id: 'operatingAddress',\n            label: 'Operating Address (if different)',\n            type: 'textarea',\n            required: false,\n            placeholder: 'Enter operating address if different from registered address',\n            conditional: {\n              field: 'businessAddress',\n              operator: 'not_equals',\n              value: ''\n            },\n            order: 5\n          }\n        ],\n        requiredDocuments: ['proof_address']\n      },\n      {\n        id: 'ownership_control',\n        title: 'Ownership & Control',\n        subtitle: 'Shareholders and beneficial owners',\n        fields: [\n          {\n            id: 'authorizedCapital',\n            label: 'Authorized Capital',\n            type: 'text',\n            required: true,\n            placeholder: 'Enter authorized capital amount',\n            order: 1\n          },\n          {\n            id: 'issuedCapital',\n            label: 'Issued Capital',\n            type: 'text',\n            required: true,\n            placeholder: 'Enter issued capital amount',\n            order: 2\n          },\n          {\n            id: 'shareholders',\n            label: 'Shareholders',\n            type: 'custom',\n            required: true,\n            description: 'Add all shareholders with 25% or more ownership',\n            order: 3\n          },\n          {\n            id: 'beneficialOwners',\n            label: 'Beneficial Owners',\n            type: 'custom',\n            required: true,\n            description: 'Add all beneficial owners with 25% or more control',\n            order: 4\n          }\n        ],\n        requiredDocuments: ['shareholder_register', 'beneficial_ownership']\n      },\n      {\n        id: 'directors',\n        title: 'Directors',\n        subtitle: 'Board of directors and management',\n        fields: [\n          {\n            id: 'directors',\n            label: 'Directors',\n            type: 'custom',\n            required: true,\n            description: 'Add all directors and their details',\n            order: 1\n          },\n          {\n            id: 'authorizedSignatory',\n            label: 'Authorized Signatory',\n            type: 'custom',\n            required: true,\n            description: 'Person authorized to sign on behalf of the company',\n            order: 2\n          }\n        ],\n        requiredDocuments: ['director_ids', 'board_resolution']\n      },\n      {\n        id: 'contact_details',\n        title: 'Contact Details',\n        subtitle: 'Key personnel and communication',\n        fields: [\n          {\n            id: 'businessPhone',\n            label: 'Business Phone',\n            type: 'tel',\n            required: true,\n            placeholder: 'Enter business phone number',\n            order: 1\n          },\n          {\n            id: 'businessEmail',\n            label: 'Business Email',\n            type: 'email',\n            required: true,\n            placeholder: 'Enter business email address',\n            order: 2\n          },\n          {\n            id: 'website',\n            label: 'Website (if applicable)',\n            type: 'url',\n            required: false,\n            placeholder: 'Enter company website',\n            order: 3\n          },\n          {\n            id: 'primaryContact',\n            label: 'Primary Contact Person',\n            type: 'custom',\n            required: true,\n            description: 'Main contact person for this application',\n            order: 4\n          }\n        ],\n        requiredDocuments: []\n      }\n    ],\n    requiredDocuments: [\n      {\n        id: 'certificate_incorporation',\n        name: 'Certificate of Incorporation',\n        description: 'Official certificate of incorporation',\n        required: true,\n        category: 'legal'\n      },\n      {\n        id: 'memorandum_association',\n        name: 'Memorandum of Association',\n        description: 'Memorandum and articles of association',\n        required: true,\n        category: 'legal'\n      },\n      {\n        id: 'proof_address',\n        name: 'Proof of Business Address',\n        description: 'Document proving registered business address',\n        required: true,\n        category: 'address'\n      },\n      {\n        id: 'shareholder_register',\n        name: 'Shareholder Register',\n        description: 'Current shareholder register',\n        required: true,\n        category: 'ownership'\n      },\n      {\n        id: 'beneficial_ownership',\n        name: 'Beneficial Ownership Declaration',\n        description: 'Declaration of beneficial ownership',\n        required: true,\n        category: 'ownership'\n      },\n      {\n        id: 'director_ids',\n        name: 'Director ID Copies',\n        description: 'Copies of ID documents for all directors',\n        required: true,\n        category: 'identity'\n      },\n      {\n        id: 'board_resolution',\n        name: 'Board Resolution',\n        description: 'Board resolution authorizing the application',\n        required: true,\n        category: 'authorization'\n      },\n      {\n        id: 'banking_details',\n        name: 'Banking Details',\n        description: 'Bank account details and statements',\n        required: true,\n        category: 'financial'\n      },\n      {\n        id: 'tax_clearance',\n        name: 'Tax Clearance Certificate',\n        description: 'Valid tax clearance certificate',\n        required: false,\n        category: 'compliance'\n      }\n    ]\n  },\n  \n  'npo': {\n    entityType: 'npo',\n    displayName: 'Non-Profit Organisation (NPO/NGO/PVO)',\n    description: 'Non-profit organizations and charities',\n    steps: [\n      {\n        id: 'organization_info',\n        title: 'Organization Information',\n        subtitle: 'NPO details and registration',\n        fields: [\n          {\n            id: 'organizationName',\n            label: 'Organization Name',\n            type: 'text',\n            required: true,\n            placeholder: 'Enter organization name',\n            order: 1\n          },\n          {\n            id: 'country',\n            label: 'Country',\n            type: 'select',\n            required: true,\n            placeholder: 'Select country',\n            options: [\n              { value: 'South Africa', label: 'South Africa' },\n              { value: 'Kenya', label: 'Kenya' },\n              { value: 'Nigeria', label: 'Nigeria' },\n              { value: 'Ghana', label: 'Ghana' },\n              { value: 'Zimbabwe', label: 'Zimbabwe' },\n              { value: 'Zambia', label: 'Zambia' },\n              { value: 'Tanzania', label: 'Tanzania' },\n              { value: 'Uganda', label: 'Uganda' },\n              { value: 'Rwanda', label: 'Rwanda' },\n              { value: 'Mauritius', label: 'Mauritius' }\n            ],\n            order: 2\n          },\n          {\n            id: 'applicantName',\n            label: 'Applicant Full Name',\n            type: 'text',\n            required: true,\n            placeholder: 'Enter your full name',\n            order: 3\n          },\n          {\n            id: 'applicantEmail',\n            label: 'Applicant Email',\n            type: 'email',\n            required: true,\n            placeholder: 'Enter your email address',\n            order: 4\n          },\n          {\n            id: 'registrationNumber',\n            label: 'NPO Registration Number',\n            type: 'text',\n            required: true,\n            placeholder: 'Enter NPO registration number',\n            externalValidation: {\n              enabled: true,\n              apiEndpoint: '/api/validate/npo-registration',\n              loadingText: 'Validating NPO registration...',\n              successText: 'NPO registration verified',\n              errorText: 'Invalid NPO registration number'\n            },\n            order: 5\n          },\n          {\n            id: 'dateOfRegistration',\n            label: 'Date of Registration',\n            type: 'date',\n            required: true,\n            order: 6\n          },\n          {\n            id: 'organizationType',\n            label: 'Organization Type',\n            type: 'select',\n            required: true,\n            options: [\n              { value: 'npo', label: 'Non-Profit Organisation' },\n              { value: 'ngo', label: 'Non-Governmental Organisation' },\n              { value: 'pvo', label: 'Private Voluntary Organisation' },\n              { value: 'charity', label: 'Charity' },\n              { value: 'foundation', label: 'Foundation' }\n            ],\n            order: 7\n          }\n        ],\n        requiredDocuments: ['npo_certificate', 'constitution']\n      },\n      {\n        id: 'governance',\n        title: 'Governance Structure',\n        subtitle: 'Trustees and management structure',\n        fields: [\n          {\n            id: 'trustees',\n            label: 'Trustees/Board Members',\n            type: 'custom',\n            required: true,\n            description: 'Add all trustees and board members',\n            order: 1\n          },\n          {\n            id: 'executiveDirector',\n            label: 'Executive Director',\n            type: 'custom',\n            required: true,\n            description: 'Executive director details',\n            order: 2\n          },\n          {\n            id: 'authorizedSignatory',\n            label: 'Authorized Signatory',\n            type: 'custom',\n            required: true,\n            description: 'Person authorized to sign on behalf of the organization',\n            order: 3\n          }\n        ],\n        requiredDocuments: ['trustee_ids', 'board_resolution']\n      },\n      {\n        id: 'activities',\n        title: 'Activities & Mission',\n        subtitle: 'Organization activities and objectives',\n        fields: [\n          {\n            id: 'missionStatement',\n            label: 'Mission Statement',\n            type: 'textarea',\n            required: true,\n            placeholder: 'Describe your organization\\'s mission',\n            order: 1\n          },\n          {\n            id: 'mainActivities',\n            label: 'Main Activities',\n            type: 'textarea',\n            required: true,\n            placeholder: 'Describe your main activities',\n            order: 2\n          },\n          {\n            id: 'targetBeneficiaries',\n            label: 'Target Beneficiaries',\n            type: 'textarea',\n            required: true,\n            placeholder: 'Describe your target beneficiaries',\n            order: 3\n          }\n        ],\n        requiredDocuments: []\n      },\n      {\n        id: 'financial_info',\n        title: 'Financial Information',\n        subtitle: 'Financial details and funding',\n        fields: [\n          {\n            id: 'annualBudget',\n            label: 'Annual Budget',\n            type: 'text',\n            required: true,\n            placeholder: 'Enter annual budget amount',\n            order: 1\n          },\n          {\n            id: 'fundingSources',\n            label: 'Main Funding Sources',\n            type: 'textarea',\n            required: true,\n            placeholder: 'Describe your main funding sources',\n            order: 2\n          },\n          {\n            id: 'bankingDetails',\n            label: 'Banking Details',\n            type: 'custom',\n            required: true,\n            description: 'Bank account details for the organization',\n            order: 3\n          }\n        ],\n        requiredDocuments: ['financial_statements', 'banking_details']\n      }\n    ],\n    requiredDocuments: [\n      {\n        id: 'npo_certificate',\n        name: 'NPO Registration Certificate',\n        description: 'Official NPO registration certificate',\n        required: true,\n        category: 'legal'\n      },\n      {\n        id: 'constitution',\n        name: 'Constitution',\n        description: 'Organization constitution or governing document',\n        required: true,\n        category: 'legal'\n      },\n      {\n        id: 'trustee_ids',\n        name: 'Trustee ID Copies',\n        description: 'Copies of ID documents for all trustees',\n        required: true,\n        category: 'identity'\n      },\n      {\n        id: 'board_resolution',\n        name: 'Board Resolution',\n        description: 'Board resolution authorizing the application',\n        required: true,\n        category: 'authorization'\n      },\n      {\n        id: 'financial_statements',\n        name: 'Financial Statements',\n        description: 'Recent audited financial statements',\n        required: true,\n        category: 'financial'\n      },\n      {\n        id: 'banking_details',\n        name: 'Banking Details',\n        description: 'Bank account details and statements',\n        required: true,\n        category: 'financial'\n      }\n    ]\n  },\n\n  'government': {\n    entityType: 'government',\n    displayName: 'Government / State Owned Entity',\n    description: 'Government departments and state-owned entities',\n    steps: [\n      {\n        id: 'entity_info',\n        title: 'Entity Information',\n        subtitle: 'Government entity details',\n        fields: [\n          {\n            id: 'entityName',\n            label: 'Entity Name',\n            type: 'text',\n            required: true,\n            placeholder: 'Enter entity name',\n            order: 1\n          },\n          {\n            id: 'country',\n            label: 'Country',\n            type: 'select',\n            required: true,\n            placeholder: 'Select country',\n            options: [\n              { value: 'South Africa', label: 'South Africa' },\n              { value: 'Kenya', label: 'Kenya' },\n              { value: 'Nigeria', label: 'Nigeria' },\n              { value: 'Ghana', label: 'Ghana' },\n              { value: 'Zimbabwe', label: 'Zimbabwe' },\n              { value: 'Zambia', label: 'Zambia' },\n              { value: 'Tanzania', label: 'Tanzania' },\n              { value: 'Uganda', label: 'Uganda' },\n              { value: 'Rwanda', label: 'Rwanda' },\n              { value: 'Mauritius', label: 'Mauritius' }\n            ],\n            order: 2\n          },\n          {\n            id: 'applicantName',\n            label: 'Applicant Full Name',\n            type: 'text',\n            required: true,\n            placeholder: 'Enter your full name',\n            order: 3\n          },\n          {\n            id: 'applicantEmail',\n            label: 'Applicant Email',\n            type: 'email',\n            required: true,\n            placeholder: 'Enter your email address',\n            order: 4\n          },\n          {\n            id: 'entityType',\n            label: 'Entity Type',\n            type: 'select',\n            required: true,\n            options: [\n              { value: 'department', label: 'Government Department' },\n              { value: 'ministry', label: 'Ministry' },\n              { value: 'agency', label: 'Government Agency' },\n              { value: 'soe', label: 'State-Owned Enterprise' },\n              { value: 'municipality', label: 'Municipality' }\n            ],\n            order: 5\n          },\n          {\n            id: 'registrationNumber',\n            label: 'Government Registration Number',\n            type: 'text',\n            required: true,\n            placeholder: 'Enter government registration number',\n            order: 6\n          },\n          {\n            id: 'jurisdiction',\n            label: 'Jurisdiction',\n            type: 'text',\n            required: true,\n            placeholder: 'Enter jurisdiction (e.g., National, Provincial, Local)',\n            order: 7\n          }\n        ],\n        requiredDocuments: ['government_certificate', 'establishment_act']\n      },\n      {\n        id: 'authority',\n        title: 'Authority & Authorization',\n        subtitle: 'Legal authority and authorization',\n        fields: [\n          {\n            id: 'legalBasis',\n            label: 'Legal Basis',\n            type: 'textarea',\n            required: true,\n            placeholder: 'Describe the legal basis for the entity',\n            order: 1\n          },\n          {\n            id: 'authorizedSignatory',\n            label: 'Authorized Signatory',\n            type: 'custom',\n            required: true,\n            description: 'Person authorized to sign on behalf of the entity',\n            order: 2\n          },\n          {\n            id: 'authorityDocument',\n            label: 'Authority Document Reference',\n            type: 'text',\n            required: true,\n            placeholder: 'Reference to the authority document',\n            order: 3\n          }\n        ],\n        requiredDocuments: ['authority_document', 'signatory_authorization']\n      }\n    ],\n    requiredDocuments: [\n      {\n        id: 'government_certificate',\n        name: 'Government Certificate',\n        description: 'Official government certificate or registration',\n        required: true,\n        category: 'legal'\n      },\n      {\n        id: 'establishment_act',\n        name: 'Establishment Act/Statute',\n        description: 'Act or statute establishing the entity',\n        required: true,\n        category: 'legal'\n      },\n      {\n        id: 'authority_document',\n        name: 'Authority Document',\n        description: 'Document authorizing the entity to operate',\n        required: true,\n        category: 'authorization'\n      },\n      {\n        id: 'signatory_authorization',\n        name: 'Signatory Authorization',\n        description: 'Document authorizing the signatory',\n        required: true,\n        category: 'authorization'\n      }\n    ]\n  }\n};\n\nexport const getEntityFormConfig = (entityType: string): EntityFormConfig | null => {\n  return entityFormConfigs[entityType] || null;\n};\n\nexport const getAllEntityTypes = (): Array<{ value: string; label: string; description: string }> => {\n  return Object.values(entityFormConfigs).map(config => ({\n    value: config.entityType,\n    label: config.displayName,\n    description: config.description\n  }));\n};\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1072, "column": 0}, "map": {"version":3,"sources":["file:///Users/mukurusystemsadministrator/Desktop/onboarding_kyc%20copy/partner/src/utils/sweetAlert.tsx"],"sourcesContent":["\"use client\";\n\nimport Swal from 'sweetalert2';\n\ninterface ConfirmResult {\n  isConfirmed: boolean;\n  isDenied: boolean;\n  isDismissed: boolean;\n}\n\ninterface SweetAlertContextType {\n  confirm: (\n    title: string,\n    text: string,\n    confirmButtonText?: string,\n    cancelButtonText?: string,\n    icon?: 'warning' | 'error' | 'info' | 'question'\n  ) => Promise<ConfirmResult>;\n  success: (title: string, text?: string) => Promise<void>;\n  error: (title: string, text?: string) => Promise<void>;\n  warning: (title: string, text?: string) => Promise<void>;\n  info: (title: string, text?: string) => Promise<void>;\n  loading: (title: string, text?: string) => void;\n  close: () => void;\n  alert: (title: string, text?: string, icon?: 'success' | 'error' | 'warning' | 'info' | 'question') => Promise<void>;\n}\n\n// Static API for SweetAlert\nexport const SweetAlert: SweetAlertContextType = {\n  confirm: async (title, text, confirmButtonText = 'Yes', cancelButtonText = 'Cancel', icon = 'question') => {\n    const result = await Swal.fire({\n      title,\n      text,\n      icon,\n      showCancelButton: true,\n      confirmButtonText,\n      cancelButtonText,\n      confirmButtonColor: '#3085d6',\n      cancelButtonColor: '#d33',\n      reverseButtons: true,\n    });\n\n    return {\n      isConfirmed: result.isConfirmed,\n      isDenied: result.isDenied,\n      isDismissed: result.isDismissed,\n    };\n  },\n  success: async (title, text) => {\n    await Swal.fire({\n      title,\n      text,\n      icon: 'success',\n      confirmButtonColor: '#3085d6',\n    });\n  },\n  error: async (title, text) => {\n    await Swal.fire({\n      title,\n      text,\n      icon: 'error',\n      confirmButtonColor: '#d33',\n    });\n  },\n  warning: async (title, text) => {\n    await Swal.fire({\n      title,\n      text,\n      icon: 'warning',\n      confirmButtonColor: '#f59e0b',\n    });\n  },\n  info: async (title, text) => {\n    await Swal.fire({\n      title,\n      text,\n      icon: 'info',\n      confirmButtonColor: '#3085d6',\n    });\n  },\n  loading: (title, text) => {\n    Swal.fire({\n      title,\n      text,\n      allowOutsideClick: false,\n      allowEscapeKey: false,\n      showConfirmButton: false,\n      didOpen: () => {\n        Swal.showLoading();\n      },\n    });\n  },\n  close: () => {\n    Swal.close();\n  },\n  alert: async (title, text, icon = 'info') => {\n    await Swal.fire({\n      title,\n      text,\n      icon,\n      confirmButtonColor: '#3085d6',\n    });\n  },\n};\n\n"],"names":[],"mappings":";;;;AAEA;AAFA;;AA4BO,MAAM,aAAoC;IAC/C,SAAS,OAAO,OAAO,MAAM,oBAAoB,KAAK,EAAE,mBAAmB,QAAQ,EAAE,OAAO,UAAU;QACpG,MAAM,SAAS,MAAM,2KAAI,CAAC,IAAI,CAAC;YAC7B;YACA;YACA;YACA,kBAAkB;YAClB;YACA;YACA,oBAAoB;YACpB,mBAAmB;YACnB,gBAAgB;QAClB;QAEA,OAAO;YACL,aAAa,OAAO,WAAW;YAC/B,UAAU,OAAO,QAAQ;YACzB,aAAa,OAAO,WAAW;QACjC;IACF;IACA,SAAS,OAAO,OAAO;QACrB,MAAM,2KAAI,CAAC,IAAI,CAAC;YACd;YACA;YACA,MAAM;YACN,oBAAoB;QACtB;IACF;IACA,OAAO,OAAO,OAAO;QACnB,MAAM,2KAAI,CAAC,IAAI,CAAC;YACd;YACA;YACA,MAAM;YACN,oBAAoB;QACtB;IACF;IACA,SAAS,OAAO,OAAO;QACrB,MAAM,2KAAI,CAAC,IAAI,CAAC;YACd;YACA;YACA,MAAM;YACN,oBAAoB;QACtB;IACF;IACA,MAAM,OAAO,OAAO;QAClB,MAAM,2KAAI,CAAC,IAAI,CAAC;YACd;YACA;YACA,MAAM;YACN,oBAAoB;QACtB;IACF;IACA,SAAS,CAAC,OAAO;QACf,2KAAI,CAAC,IAAI,CAAC;YACR;YACA;YACA,mBAAmB;YACnB,gBAAgB;YAChB,mBAAmB;YACnB,SAAS;gBACP,2KAAI,CAAC,WAAW;YAClB;QACF;IACF;IACA,OAAO;QACL,2KAAI,CAAC,KAAK;IACZ;IACA,OAAO,OAAO,OAAO,MAAM,OAAO,MAAM;QACtC,MAAM,2KAAI,CAAC,IAAI,CAAC;YACd;YACA;YACA;YACA,oBAAoB;QACtB;IACF;AACF"}},
    {"offset": {"line": 1158, "column": 0}, "map": {"version":3,"sources":["file:///Users/mukurusystemsadministrator/Desktop/onboarding_kyc%20copy/partner/src/components/EnhancedDynamicForm.tsx"],"sourcesContent":["// @ts-nocheck\n\"use client\";\n\nimport { Box, VStack, HStack, Text, Input, Textarea, Button, SimpleGrid, Icon, Badge, Spinner, Flex, Select, Circle } from \"@chakra-ui/react\";\nimport { useState, useEffect, useRef } from \"react\";\nimport { FiInfo, FiAlertCircle, FiCheckCircle, FiExternalLink, FiUpload, FiUser, FiUsers, FiPlus, FiTrash2, FiArrowRight } from \"react-icons/fi\";\nimport { FormField, EntityFormConfig } from \"../lib/entityFormConfigs\";\nimport { FileUpload } from \"@shared/components/FileUpload\";\nimport { SweetAlert } from \"../utils/sweetAlert\";\n\ninterface EnhancedDynamicFormProps {\n  config: EntityFormConfig;\n  formData: any;\n  onFieldChange: (fieldId: string, value: any) => void;\n  onStepComplete: (stepId: string) => void;\n  currentStep: number;\n  onNext: () => void;\n  onPrevious: () => void;\n  onSubmit: () => void;\n  isLoading?: boolean;\n  validationErrors?: Record<string, string>;\n  onFilesChange?: (files: Map<string, File>) => void; // Callback to notify parent of file changes\n}\n\ninterface ValidationState {\n  isValidating: boolean;\n  isValid: boolean;\n  message: string;\n  data?: any;\n}\n\nexport function EnhancedDynamicForm({\n  config,\n  formData,\n  onFieldChange,\n  onStepComplete,\n  currentStep,\n  onNext,\n  onPrevious,\n  onSubmit,\n  isLoading = false,\n  validationErrors = {},\n  onFilesChange\n}: EnhancedDynamicFormProps) {\n  const [validationStates, setValidationStates] = useState<Record<string, ValidationState>>({});\n  const [customFieldData, setCustomFieldData] = useState<Record<string, any>>({});\n  // local banner state instead of Chakra useToast (not available in this build)\n  const [banner, setBanner] = useState<{ status: 'success' | 'error'; message: string } | null>(null);\n  // Store File objects temporarily (can't be serialized in formData)\n  // Key: fieldId, Value: File object\n  const fileObjectsRef = useRef<Map<string, File>>(new Map());\n\n  const currentStepConfig = config.steps[currentStep - 1];\n  if (!currentStepConfig) return null;\n\n  const handleFieldChange = async (fieldId: string, value: any) => {\n    onFieldChange(fieldId, value);\n\n    // Handle external validation\n    const field = currentStepConfig.fields.find(f => f.id === fieldId);\n    if (field?.externalValidation?.enabled && value) {\n      await validateExternalField(fieldId, value, field.externalValidation);\n    }\n  };\n\n  const validateExternalField = async (fieldId: string, value: any, validation: any) => {\n    setValidationStates(prev => ({\n      ...prev,\n      [fieldId]: { isValidating: true, isValid: false, message: validation.loadingText }\n    }));\n\n    try {\n      // Mock external validation - replace with actual API calls\n      await new Promise(resolve => setTimeout(resolve, 1500));\n      \n      // Simulate validation result\n      const isValid = Math.random() > 0.3; // 70% success rate for demo\n      \n      if (isValid) {\n        setValidationStates(prev => ({\n          ...prev,\n          [fieldId]: { \n            isValidating: false, \n            isValid: true, \n            message: validation.successText,\n            data: { verifiedAt: new Date().toISOString() }\n          }\n        }));\n        \n        setBanner({ status: 'success', message: validation.successText });\n        setTimeout(() => setBanner(null), 3000);\n      } else {\n        setValidationStates(prev => ({\n          ...prev,\n          [fieldId]: { \n            isValidating: false, \n            isValid: false, \n            message: validation.errorText \n          }\n        }));\n        \n        setBanner({ status: 'error', message: validation.errorText });\n        setTimeout(() => setBanner(null), 5000);\n      }\n    } catch (error) {\n      setValidationStates(prev => ({\n        ...prev,\n        [fieldId]: { \n          isValidating: false, \n          isValid: false, \n          message: \"Validation service unavailable\" \n        }\n      }));\n    }\n  };\n\n  const renderField = (field: FormField) => {\n    const value = formData[field.id] || '';\n    const error = validationErrors[field.id];\n    const validationState = validationStates[field.id];\n\n    // Props for Chakra UI components (Input, Textarea)\n    // Note: Using errorBorderColor instead of isInvalid to avoid React warning about DOM props\n    const chakraProps = {\n      value,\n      onChange: (e: any) => handleFieldChange(field.id, e.target.value),\n      placeholder: field.placeholder,\n      required: field.required, // Use 'required' instead of 'isRequired' for DOM elements\n      // Use errorBorderColor for error state instead of isInvalid to avoid React DOM warnings\n      ...(error ? { \n        errorBorderColor: 'red.500',\n        borderColor: 'red.500'\n      } : {}),\n      disabled: isLoading,\n      bg: 'white',\n      color: 'black', // Text color for input value\n      _placeholder: { \n        color: 'gray.400',\n        opacity: 1\n      },\n      sx: {\n        // Ensure placeholder is light gray across all browsers\n        '&::placeholder': {\n          color: 'gray.400 !important',\n          opacity: '1 !important'\n        },\n        '&::-webkit-input-placeholder': {\n          color: 'gray.400 !important',\n          opacity: '1 !important'\n        },\n        '&::-moz-placeholder': {\n          color: 'gray.400 !important',\n          opacity: '1 !important'\n        },\n        '&:-ms-input-placeholder': {\n          color: 'gray.400 !important',\n          opacity: '1 !important'\n        },\n        // Ensure input text is black when there's a value\n        ...(value && {\n          color: '#000000',\n          WebkitTextFillColor: '#000000'\n        })\n      },\n      // Caret color\n      style: { caretColor: '#000000' }\n    } as any;\n\n    // Props for native HTML elements (select, checkbox, etc.)\n    const nativeProps = {\n      value,\n      onChange: (e: any) => handleFieldChange(field.id, e.target.value),\n      placeholder: field.placeholder,\n      required: field.required,\n      disabled: isLoading,\n      // Note: No isInvalid prop for native HTML elements\n    };\n\n    const fieldElement = (() => {\n      switch (field.type) {\n        case 'text':\n        case 'email':\n        case 'tel':\n        case 'url':\n        case 'number':\n          return <Input {...chakraProps} type={field.type} />;\n        \n        case 'date':\n          return <Input {...chakraProps} type=\"date\" />;\n        \n        case 'textarea':\n          return <Textarea {...chakraProps} rows={4} />;\n        \n        case 'select':\n          return (\n            <Box>\n              <select\n                value={value}\n                onChange={(e) => handleFieldChange(field.id, e.target.value)}\n                disabled={isLoading}\n                style={{ width: '100%', padding: '10px 12px', borderRadius: 6, border: '1px solid var(--chakra-colors-gray-200)', background: 'white', color: '#000000' }}\n              >\n                <option value=\"\">Select an option</option>\n                {field.options?.map(option => (\n                  <option key={option.value} value={option.value} disabled={option.disabled}>\n                    {option.label}\n                  </option>\n                ))}\n              </select>\n            </Box>\n          );\n        \n        case 'checkbox':\n          return (\n            <HStack>\n              <input\n                type=\"checkbox\"\n                checked={!!value}\n                onChange={(e) => handleFieldChange(field.id, e.target.checked)}\n                disabled={isLoading}\n              />\n              <Text>{field.label}</Text>\n            </HStack>\n          );\n        \n        case 'radio':\n          return (\n            <VStack align=\"start\" gap=\"2\">\n              {field.options?.map(option => (\n                <HStack key={option.value}>\n                  <input\n                    type=\"radio\"\n                    name={field.id}\n                    value={option.value}\n                    checked={value === option.value}\n                    onChange={(e) => handleFieldChange(field.id, e.target.value)}\n                    disabled={option.disabled}\n                  />\n                  <Text>{option.label}</Text>\n                </HStack>\n              ))}\n            </VStack>\n          );\n        \n        case 'file':\n          // Handle both legacy string format and new object format\n          const existingFileValue = formData[field.id];\n          const existingFileName = typeof existingFileValue === 'string' \n            ? existingFileValue \n            : existingFileValue?.fileName || '';\n          \n          return (\n            <FileUpload\n              onFileUpload={async (file) => {\n                // Store File object temporarily (will be uploaded to Document Service after case creation)\n                // File objects can't be serialized, so we store them in a ref\n                fileObjectsRef.current.set(field.id, file);\n                \n                // Notify parent component of file changes\n                if (onFilesChange) {\n                  onFilesChange(new Map(fileObjectsRef.current));\n                }\n                \n                // Store file metadata in formData (this can be serialized)\n                // Files will be uploaded to Document Service API after case creation\n                const fileData = {\n                  fileName: file.name,\n                  fileSize: file.size,\n                  fileType: file.type,\n                  uploadedAt: new Date().toISOString(),\n                  requirementCode: field.id, // Store the field/requirement code for mapping to DocumentType\n                  // Status: 'pending' means file is ready to upload after case creation\n                  status: 'pending',\n                  // Note: File object is stored in fileObjectsRef, not here (can't serialize File)\n                };\n                \n                // Store file metadata in formData\n                handleFieldChange(field.id, fileData);\n                \n                console.log(' File selected and stored (will upload to Document Service after case creation):', {\n                  fieldId: field.id,\n                  fileName: fileData.fileName,\n                  fileSize: fileData.fileSize,\n                  fileType: fileData.fileType,\n                  requirementCode: field.id\n                });\n                \n                // Return a placeholder URL for FileUpload component display\n                // In a real implementation, this would show \"Ready to upload\" or similar\n                return `file://${file.name}`;\n              }}\n              acceptedTypes={['.pdf', '.doc', '.docx', '.jpg', '.jpeg', '.png']}\n              maxSize={10}\n              label={field.label}\n              description={field.description || \"Upload document\"}\n              onError={async (message, title) => {\n                await SweetAlert.error(title || 'File Upload Error', message);\n              }}\n            />\n          );\n        \n        case 'custom':\n          return renderCustomField(field);\n        \n        default:\n          return <Input {...chakraProps} />;\n      }\n    })();\n\n    return (\n      <Box key={field.id}>\n        <Text fontSize=\"sm\" fontWeight=\"medium\" color=\"gray.700\" mb=\"1\">\n          {field.label}\n          {field.externalValidation?.enabled && (\n            <Icon as={FiExternalLink} ml=\"2\" boxSize=\"3\" color=\"blue.500\" />\n          )}\n        </Text>\n        \n        {fieldElement}\n        \n        {field.description && (\n          <Text fontSize=\"xs\" color=\"gray.600\" mt=\"1\">\n            {field.description}\n          </Text>\n        )}\n        \n        {error && (\n          <Text fontSize=\"xs\" color=\"red.500\" mt=\"1\">\n            {error}\n          </Text>\n        )}\n        \n        {validationState && (\n          <Box mt=\"2\">\n            {validationState.isValidating ? (\n              <HStack gap=\"2\">\n                <Spinner size=\"xs\" color=\"blue.500\" />\n                <Text fontSize=\"xs\" color=\"blue.600\">\n                  {validationState.message}\n                </Text>\n              </HStack>\n            ) : (\n              <HStack gap=\"2\">\n                <Icon \n                  as={validationState.isValid ? FiCheckCircle : FiAlertCircle} \n                  boxSize=\"3\" \n                  color={validationState.isValid ? \"green.500\" : \"red.500\"} \n                />\n                <Text fontSize=\"xs\" color={validationState.isValid ? \"green.600\" : \"red.600\"}>\n                  {validationState.message}\n                </Text>\n              </HStack>\n            )}\n          </Box>\n        )}\n      </Box>\n    );\n  };\n\n  const renderCustomField = (field: FormField) => {\n    switch (field.id) {\n      case 'shareholders':\n      case 'beneficialOwners':\n      case 'directors':\n      case 'trustees':\n        return renderPersonListField(field);\n      \n      case 'authorizedSignatory':\n      case 'executiveDirector':\n      case 'primaryContact':\n        return renderPersonField(field);\n      \n      case 'bankingDetails':\n        return renderBankingDetailsField(field);\n      \n      default:\n        return <Textarea placeholder={field.placeholder} />;\n    }\n  };\n\n  const renderPersonListField = (field: FormField) => {\n    const people = customFieldData[field.id] || [];\n    \n    const addPerson = () => {\n      const newPerson = {\n        id: `person_${Date.now()}`,\n        name: '',\n        email: '',\n        phone: '',\n        idNumber: '',\n        address: '',\n        ownership: field.id === 'shareholders' ? '' : undefined,\n        position: field.id === 'directors' ? '' : undefined\n      };\n      \n      setCustomFieldData(prev => ({\n        ...prev,\n        [field.id]: [...people, newPerson]\n      }));\n      \n      onFieldChange(field.id, [...people, newPerson]);\n    };\n    \n    const removePerson = (personId: string) => {\n      const updatedPeople = people.filter((p: any) => p.id !== personId);\n      setCustomFieldData(prev => ({\n        ...prev,\n        [field.id]: updatedPeople\n      }));\n      onFieldChange(field.id, updatedPeople);\n    };\n    \n    const updatePerson = (personId: string, fieldName: string, value: any) => {\n      const updatedPeople = people.map((p: any) => \n        p.id === personId ? { ...p, [fieldName]: value } : p\n      );\n      setCustomFieldData(prev => ({\n        ...prev,\n        [field.id]: updatedPeople\n      }));\n      onFieldChange(field.id, updatedPeople);\n    };\n\n    return (\n      <VStack gap=\"4\" align=\"stretch\">\n        {people.map((person: any, index: number) => (\n          <Box key={person.id} p=\"4\" border=\"1px\" borderColor=\"gray.200\" borderRadius=\"md\" bg=\"gray.50\">\n            <HStack justify=\"space-between\" mb=\"3\">\n              <Text fontSize=\"sm\" fontWeight=\"medium\" color=\"gray.700\">\n                {field.label} #{index + 1}\n              </Text>\n              <Button\n                size=\"xs\"\n                variant=\"ghost\"\n                color=\"red.500\"\n                onClick={() => removePerson(person.id)}\n                disabled={isLoading}\n              >\n                <Icon as={FiTrash2} />\n              </Button>\n            </HStack>\n            \n            <SimpleGrid columns={{ base: 1, md: 2 }} gap=\"3\">\n              <Input\n                placeholder=\"Full Name\"\n                value={person.name}\n                onChange={(e) => updatePerson(person.id, 'name', e.target.value)}\n                disabled={isLoading}\n              />\n              <Input\n                placeholder=\"Email Address\"\n                type=\"email\"\n                value={person.email}\n                onChange={(e) => updatePerson(person.id, 'email', e.target.value)}\n                disabled={isLoading}\n              />\n              <Input\n                placeholder=\"Phone Number\"\n                type=\"tel\"\n                value={person.phone}\n                onChange={(e) => updatePerson(person.id, 'phone', e.target.value)}\n                disabled={isLoading}\n              />\n              <Input\n                placeholder=\"ID Number\"\n                value={person.idNumber}\n                onChange={(e) => updatePerson(person.id, 'idNumber', e.target.value)}\n                disabled={isLoading}\n              />\n              {field.id === 'shareholders' && (\n                <Input\n                  placeholder=\"Ownership %\"\n                  value={person.ownership}\n                  onChange={(e) => updatePerson(person.id, 'ownership', e.target.value)}\n                  disabled={isLoading}\n                />\n              )}\n              {field.id === 'directors' && (\n                <Input\n                  placeholder=\"Position\"\n                  value={person.position}\n                  onChange={(e) => updatePerson(person.id, 'position', e.target.value)}\n                  disabled={isLoading}\n                />\n              )}\n            </SimpleGrid>\n            \n            <Textarea\n              placeholder=\"Address\"\n              value={person.address}\n              onChange={(e) => updatePerson(person.id, 'address', e.target.value)}\n              mt=\"3\"\n              rows={2}\n              disabled={isLoading}\n            />\n          </Box>\n        ))}\n        \n        <Button\n          variant=\"outline\"\n          onClick={addPerson}\n          disabled={isLoading}\n        >\n          <Icon as={FiPlus} mr=\"2\" />\n          Add {field.label.slice(0, -1)}\n        </Button>\n      </VStack>\n    );\n  };\n\n  const renderPersonField = (field: FormField) => {\n    const person = customFieldData[field.id] || {\n      name: '',\n      email: '',\n      phone: '',\n      position: '',\n      idNumber: ''\n    };\n    \n    const updatePerson = (fieldName: string, value: any) => {\n      const updatedPerson = { ...person, [fieldName]: value };\n      setCustomFieldData(prev => ({\n        ...prev,\n        [field.id]: updatedPerson\n      }));\n      onFieldChange(field.id, updatedPerson);\n    };\n\n    return (\n      <VStack gap=\"3\" align=\"stretch\">\n        <SimpleGrid columns={{ base: 1, md: 2 }} gap=\"3\">\n          <Input\n            placeholder=\"Full Name\"\n            value={person.name}\n            onChange={(e) => updatePerson('name', e.target.value)}\n            disabled={isLoading}\n            bg=\"white\"\n            color=\"gray.800\"\n            _placeholder={{ color: 'gray.500' }}\n          />\n          <Input\n            placeholder=\"Email Address\"\n            type=\"email\"\n            value={person.email}\n            onChange={(e) => updatePerson('email', e.target.value)}\n            disabled={isLoading}\n            bg=\"white\"\n            color=\"gray.800\"\n            _placeholder={{ color: 'gray.500' }}\n          />\n          <Input\n            placeholder=\"Phone Number\"\n            type=\"tel\"\n            value={person.phone}\n            onChange={(e) => updatePerson('phone', e.target.value)}\n            disabled={isLoading}\n            bg=\"white\"\n            color=\"gray.800\"\n            _placeholder={{ color: 'gray.500' }}\n          />\n          <Input\n            placeholder=\"Position/Title\"\n            value={person.position}\n            onChange={(e) => updatePerson('position', e.target.value)}\n            disabled={isLoading}\n            bg=\"white\"\n            color=\"gray.800\"\n            _placeholder={{ color: 'gray.500' }}\n          />\n        </SimpleGrid>\n        <Input\n          placeholder=\"ID Number\"\n          value={person.idNumber}\n          onChange={(e) => updatePerson('idNumber', e.target.value)}\n          disabled={isLoading}\n          bg=\"white\"\n          color=\"gray.800\"\n          _placeholder={{ color: 'gray.500' }}\n        />\n      </VStack>\n    );\n  };\n\n  const renderBankingDetailsField = (field: FormField) => {\n    const banking = customFieldData[field.id] || {\n      bankName: '',\n      accountNumber: '',\n      accountType: '',\n      branchCode: '',\n      accountHolder: ''\n    };\n    \n    const updateBanking = (fieldName: string, value: any) => {\n      const updatedBanking = { ...banking, [fieldName]: value };\n      setCustomFieldData(prev => ({\n        ...prev,\n        [field.id]: updatedBanking\n      }));\n      onFieldChange(field.id, updatedBanking);\n    };\n\n    return (\n      <VStack gap=\"3\" align=\"stretch\">\n        <SimpleGrid columns={{ base: 1, md: 2 }} gap=\"3\">\n          <Input\n            placeholder=\"Bank Name\"\n            value={banking.bankName}\n            onChange={(e) => updateBanking('bankName', e.target.value)}\n            disabled={isLoading}\n            bg=\"white\"\n            color=\"gray.800\"\n            _placeholder={{ color: 'gray.500' }}\n          />\n          <Input\n            placeholder=\"Account Number\"\n            value={banking.accountNumber}\n            onChange={(e) => updateBanking('accountNumber', e.target.value)}\n            disabled={isLoading}\n            bg=\"white\"\n            color=\"gray.800\"\n            _placeholder={{ color: 'gray.500' }}\n          />\n          <Input\n            placeholder=\"Branch Code\"\n            value={banking.branchCode}\n            onChange={(e) => updateBanking('branchCode', e.target.value)}\n            disabled={isLoading}\n            bg=\"white\"\n            color=\"gray.800\"\n            _placeholder={{ color: 'gray.500' }}\n          />\n          <Select\n            placeholder=\"Account Type\"\n            value={banking.accountType}\n            onChange={(e) => updateBanking('accountType', e.target.value)}\n            disabled={isLoading}\n          >\n            <option value=\"current\">Current Account</option>\n            <option value=\"savings\">Savings Account</option>\n            <option value=\"business\">Business Account</option>\n          </Select>\n        </SimpleGrid>\n        <Input\n          placeholder=\"Account Holder Name\"\n          value={banking.accountHolder}\n          onChange={(e) => updateBanking('accountHolder', e.target.value)}\n          disabled={isLoading}\n          bg=\"white\"\n          color=\"gray.800\"\n          _placeholder={{ color: 'gray.500' }}\n        />\n      </VStack>\n    );\n  };\n\n  const isStepComplete = () => {\n    // Validate based ONLY on the fields from entity configuration that are displayed in this step\n    const requiredFields = currentStepConfig.fields.filter(field => field.required);\n    const missingFields = requiredFields.filter(field => {\n      const value = formData[field.id];\n      // Check for undefined, null, empty string, or whitespace-only strings\n      if (value === undefined || value === null || value === '') {\n        return true;\n      }\n      // For strings, check if they're just whitespace\n      if (typeof value === 'string' && value.trim() === '') {\n        return true;\n      }\n      // For arrays, check if they're empty\n      if (Array.isArray(value) && value.length === 0) {\n        return true;\n      }\n      return false;\n    });\n    \n    if (missingFields.length > 0) {\n      console.log('Step not complete - missing required fields from entity configuration:', {\n        currentStep: currentStep,\n        stepId: currentStepConfig.id,\n        stepTitle: currentStepConfig.title,\n        totalFieldsInStep: currentStepConfig.fields.length,\n        requiredFieldsInStep: requiredFields.length,\n        missingFields: missingFields.map(f => ({\n          id: f.id,\n          label: f.label,\n          currentValue: formData[f.id],\n          valueType: typeof formData[f.id]\n        })),\n        allFieldsInStep: currentStepConfig.fields.map(f => ({\n          id: f.id,\n          label: f.label,\n          required: f.required,\n          hasValue: !!(formData[f.id] && (typeof formData[f.id] !== 'string' || formData[f.id].trim() !== ''))\n        }))\n      });\n    }\n    \n    return missingFields.length === 0;\n  };\n\n  const getStepProgress = () => {\n    const totalFields = currentStepConfig.fields.length;\n    const completedFields = currentStepConfig.fields.filter(field => {\n      const value = formData[field.id];\n      return value !== undefined && value !== null && value !== '';\n    }).length;\n    \n    return (completedFields / totalFields) * 100;\n  };\n\n  const getOverallWizardProgress = () => {\n    let totalCompletedSteps = 0;\n    let totalStepsProgress = 0;\n\n    config.steps.forEach((step, index) => {\n      const stepNumber = index + 1;\n      if (stepNumber < currentStep) {\n        // Completed steps\n        totalCompletedSteps++;\n        totalStepsProgress += 100;\n      } else if (stepNumber === currentStep) {\n        // Current step - add partial progress\n        totalStepsProgress += getStepProgress();\n      }\n      // Future steps contribute 0\n    });\n\n    return {\n      completedSteps: totalCompletedSteps,\n      totalSteps: config.steps.length,\n      percentage: (totalStepsProgress / config.steps.length)\n    };\n  };\n\n  const overallProgress = getOverallWizardProgress();\n  const nextStep = currentStep < config.steps.length ? config.steps[currentStep] : null;\n\n  return (\n    <Box>\n      {banner && (\n        <Box mb=\"4\" p=\"3\" borderRadius=\"md\" bg={banner.status === 'success' ? 'green.50' : 'red.50'} border=\"1px\" borderColor={banner.status === 'success' ? 'green.200' : 'red.200'}>\n          <Text fontSize=\"sm\" color={banner.status === 'success' ? 'green.700' : 'red.700'}>{banner.message}</Text>\n        </Box>\n      )}\n      \n      {/* Enhanced Wizard Progress Overview */}\n      <Box mb=\"6\" p=\"5\" bgGradient=\"linear(to-r, blue.50, indigo.50)\" borderRadius=\"xl\" border=\"1px\" borderColor=\"blue.200\">\n        <VStack gap=\"4\" align=\"stretch\">\n          {/* Overall Progress Header */}\n          <HStack justify=\"space-between\" align=\"center\">\n            <VStack align=\"start\" gap=\"1\">\n              <Text fontSize=\"lg\" fontWeight=\"bold\" color=\"gray.800\">\n                Application Progress\n              </Text>\n              <Text fontSize=\"sm\" color=\"gray.600\">\n                {overallProgress.completedSteps} of {overallProgress.totalSteps} steps completed\n              </Text>\n            </VStack>\n            <Badge colorScheme=\"blue\" variant=\"solid\" fontSize=\"md\" px=\"3\" py=\"1\" borderRadius=\"full\">\n              {Math.round(overallProgress.percentage)}% Complete\n            </Badge>\n          </HStack>\n\n          {/* Overall Progress Bar */}\n          <Box>\n            <Box h=\"3\" bg=\"gray.200\" borderRadius=\"full\" overflow=\"hidden\" position=\"relative\">\n              <Box \n                h=\"100%\" \n                bgGradient=\"linear(to-r, blue.500, blue.600)\" \n                width={`${overallProgress.percentage}%`}\n                borderRadius=\"full\"\n                transition=\"width 0.5s ease-in-out\"\n              />\n            </Box>\n          </Box>\n\n          {/* Step Indicators */}\n          <Box mt=\"2\">\n            <HStack gap=\"2\" flexWrap=\"wrap\">\n              {config.steps.map((step, index) => {\n                const stepNumber = index + 1;\n                const isCompleted = stepNumber < currentStep;\n                const isCurrent = stepNumber === currentStep;\n                const isUpcoming = stepNumber > currentStep;\n\n                return (\n                  <Box\n                    key={step.id}\n                    flex=\"1\"\n                    minW=\"120px\"\n                    p=\"3\"\n                    borderRadius=\"md\"\n                    border=\"2px\"\n                    borderColor={\n                      isCompleted ? \"green.400\" : \n                      isCurrent ? \"blue.500\" : \n                      \"gray.200\"\n                    }\n                    bg={\n                      isCompleted ? \"green.50\" : \n                      isCurrent ? \"blue.50\" : \n                      \"white\"\n                    }\n                    position=\"relative\"\n                  >\n                    <HStack gap=\"2\" align=\"center\">\n                      <Circle\n                        size=\"24px\"\n                        bg={\n                          isCompleted ? \"green.500\" : \n                          isCurrent ? \"blue.500\" : \n                          \"gray.300\"\n                        }\n                        color=\"white\"\n                        fontWeight=\"bold\"\n                        fontSize=\"xs\"\n                      >\n                        {isCompleted ? (\n                          <Icon as={FiCheckCircle} boxSize=\"3\" />\n                        ) : (\n                          stepNumber\n                        )}\n                      </Circle>\n                      <VStack align=\"start\" gap=\"0\" flex=\"1\">\n                        <Text \n                          fontSize=\"xs\" \n                          fontWeight={isCurrent ? \"bold\" : \"medium\"}\n                          color={\n                            isCompleted ? \"green.700\" : \n                            isCurrent ? \"blue.700\" : \n                            \"gray.600\"\n                          }\n                          noOfLines={1}\n                        >\n                          {step.title}\n                        </Text>\n                        {isCurrent && (\n                          <Text fontSize=\"2xs\" color=\"blue.600\" fontWeight=\"medium\">\n                            Current Step\n                          </Text>\n                        )}\n                        {isCompleted && (\n                          <Text fontSize=\"2xs\" color=\"green.600\">\n                            Completed\n                          </Text>\n                        )}\n                        {isUpcoming && (\n                          <Text fontSize=\"2xs\" color=\"gray.500\">\n                            Upcoming\n                          </Text>\n                        )}\n                      </VStack>\n                    </HStack>\n                  </Box>\n                );\n              })}\n            </HStack>\n          </Box>\n\n          {/* Next Step Indicator */}\n          {nextStep && (\n            <Box mt=\"2\" p=\"3\" bg=\"orange.50\" borderRadius=\"md\" border=\"1px\" borderColor=\"orange.200\">\n              <HStack gap=\"2\">\n                <Icon as={FiArrowRight} color=\"orange.600\" boxSize=\"4\" />\n                <VStack align=\"start\" gap=\"0\" flex=\"1\">\n                  <Text fontSize=\"sm\" fontWeight=\"semibold\" color=\"orange.800\">\n                    Next Step: {nextStep.title}\n                  </Text>\n                  <Text fontSize=\"xs\" color=\"orange.700\">\n                    {nextStep.subtitle}\n                  </Text>\n                </VStack>\n              </HStack>\n            </Box>\n          )}\n        </VStack>\n      </Box>\n\n      {/* Current Step Details */}\n      <VStack gap=\"4\" align=\"stretch\" mb=\"6\">\n        <HStack justify=\"space-between\">\n          <VStack align=\"start\" gap=\"1\">\n            <Text fontSize=\"xl\" fontWeight=\"bold\" color=\"gray.800\">\n              {currentStepConfig.title}\n            </Text>\n            <Text fontSize=\"sm\" color=\"gray.600\">\n              {currentStepConfig.subtitle}\n            </Text>\n          </VStack>\n          <Badge colorScheme=\"blue\" variant=\"subtle\" fontSize=\"sm\" px=\"3\" py=\"1\">\n            Step {currentStep} of {config.steps.length}\n          </Badge>\n        </HStack>\n        \n        <Box>\n          <HStack justify=\"space-between\" mb=\"2\">\n            <Text fontSize=\"sm\" fontWeight=\"medium\" color=\"gray.700\">Step Progress</Text>\n            <Text fontSize=\"sm\" fontWeight=\"semibold\" color=\"gray.700\">{Math.round(getStepProgress())}%</Text>\n          </HStack>\n          <Box h=\"3\" bg=\"gray.200\" borderRadius=\"full\" overflow=\"hidden\">\n            <Box \n              h=\"100%\" \n              bg=\"blue.500\" \n              width={`${Math.round(getStepProgress())}%`}\n              borderRadius=\"full\"\n              transition=\"width 0.3s ease-in-out\"\n            />\n          </Box>\n        </Box>\n      </VStack>\n\n      {/* Form Fields */}\n      <VStack gap=\"6\" align=\"stretch\">\n        {currentStepConfig.fields\n          .sort((a, b) => (a.order || 0) - (b.order || 0))\n          .map(field => renderField(field))}\n      </VStack>\n\n      {/* Required Documents */}\n      {currentStepConfig.requiredDocuments.length > 0 && (\n        <Box mt=\"8\" p=\"4\" bg=\"blue.50\" borderRadius=\"md\" border=\"1px\" borderColor=\"blue.200\">\n          <VStack gap=\"3\" align=\"stretch\">\n            <HStack gap=\"2\">\n              <Icon as={FiUpload} color=\"blue.500\" />\n              <Text fontSize=\"sm\" fontWeight=\"medium\" color=\"blue.700\">\n                Required Documents for this Step\n              </Text>\n            </HStack>\n            \n            <VStack gap=\"2\" align=\"stretch\">\n              {currentStepConfig.requiredDocuments.map(docId => {\n                const doc = config.requiredDocuments.find(d => d.id === docId);\n                if (!doc) return null;\n                \n                return (\n                  <HStack key={docId} gap=\"2\">\n                    <Icon as={FiInfo} boxSize=\"3\" color=\"blue.500\" />\n                    <Text fontSize=\"xs\" color=\"blue.600\">\n                      {doc.name}: {doc.description}\n                    </Text>\n                  </HStack>\n                );\n              })}\n            </VStack>\n          </VStack>\n        </Box>\n      )}\n\n      {/* Navigation */}\n      <HStack justify=\"space-between\" mt=\"8\">\n        <Button\n          variant=\"outline\"\n          onClick={onPrevious}\n          disabled={currentStep === 1 || isLoading}\n        >\n          Previous\n        </Button>\n        \n        <HStack gap=\"3\">\n          {currentStep === config.steps.length ? (\n            <Button\n              colorScheme={isStepComplete() ? \"blue\" : \"orange\"}\n              onClick={async () => {\n                if (!isStepComplete()) {\n                  console.error('Cannot submit - step not complete');\n                  // Check which fields are missing\n                  const requiredFields = currentStepConfig.fields.filter(field => field.required);\n                  const missingFields = requiredFields.filter(field => {\n                    const value = formData[field.id];\n                    return value === undefined || value === null || value === '' || (typeof value === 'string' && value.trim() === '');\n                  });\n                  if (missingFields.length > 0) {\n                    await SweetAlert.warning(\n                      'Required Fields Missing',\n                      `Please fill in the following required fields:\\n${missingFields.map(f => `- ${f.label}`).join('\\n')}`\n                    );\n                  }\n                  return;\n                }\n                console.log('Submitting form...');\n                onSubmit();\n              }}\n              disabled={isLoading}\n              isLoading={isLoading}\n              title={!isStepComplete() ? \"Click to see which required fields are missing\" : \"Submit your application\"}\n            >\n              {!isStepComplete() ? \"Complete Required Fields\" : \"Submit Application\"}\n            </Button>\n          ) : (\n            <Button\n              colorScheme=\"blue\"\n              onClick={onNext}\n              disabled={!isStepComplete() || isLoading}\n              isLoading={isLoading}\n            >\n              Next Step\n            </Button>\n          )}\n        </HStack>\n      </HStack>\n    </Box>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2833, "column": 0}, "map": {"version":3,"sources":["file:///Users/mukurusystemsadministrator/Desktop/onboarding_kyc%20copy/partner/src/components/ProgressTracking.tsx"],"sourcesContent":["\"use client\";\n\nimport { Box, VStack, HStack, Text, Badge, Icon, Button, Flex, SimpleGrid, useDisclosure, DialogRoot, DialogContent, DialogHeader, DialogBody, DialogFooter, DialogTitle, DialogCloseTrigger, Spinner } from \"@chakra-ui/react\";\nimport { useState, useEffect } from \"react\";\nimport {\n  FiCheckCircle,\n  FiClock,\n  FiAlertCircle,\n  FiFileText,\n  FiHome,\n  FiUsers,\n  FiUserCheck,\n  FiFolder,\n  FiPhone,\n  FiCheck,\n  FiEye,\n  FiEdit,\n  FiSave,\n  FiPlay\n} from \"react-icons/fi\";\nimport { EntityFormConfig } from \"../lib/entityFormConfigs\";\n\ninterface ProgressTrackingProps {\n  config: EntityFormConfig;\n  formData: any;\n  currentStep: number;\n  onStepClick: (stepIndex: number) => void;\n  onSaveProgress: () => void;\n  onResumeFromStep: (stepIndex: number) => void;\n  lastSaved?: string;\n  isDirty?: boolean;\n  isSaving?: boolean;\n}\n\ninterface StepStatus {\n  id: string;\n  title: string;\n  subtitle: string;\n  completed: boolean;\n  inProgress: boolean;\n  blocked: boolean;\n  completionPercentage: number;\n  requiredFields: number;\n  completedFields: number;\n  requiredDocuments: number;\n  uploadedDocuments: number;\n}\n\nexport function ProgressTracking({\n  config,\n  formData,\n  currentStep,\n  onStepClick,\n  onSaveProgress,\n  onResumeFromStep,\n  lastSaved,\n  isDirty = false,\n  isSaving = false\n}: ProgressTrackingProps) {\n  const [stepStatuses, setStepStatuses] = useState<StepStatus[]>([]);\n  const { open: isOpen, onOpen, onClose } = useDisclosure();\n\n  useEffect(() => {\n    const statuses = config.steps.map((step, index) => {\n      const isCurrentStep = index + 1 === currentStep;\n      const isCompleted = index + 1 < currentStep;\n      \n      // Calculate field completion\n      const requiredFields = step.fields.filter(field => field.required).length;\n      const completedFields = step.fields.filter(field => {\n        const value = formData[field.id];\n        return field.required && value !== undefined && value !== null && value !== '';\n      }).length;\n      \n      // Calculate document completion\n      const requiredDocuments = step.requiredDocuments.length;\n      const uploadedDocuments = step.requiredDocuments.filter(docId => {\n        // Mock document upload status - in real app, check actual upload status\n        return Math.random() > 0.5; // 50% chance for demo\n      }).length;\n      \n      const completionPercentage = requiredFields > 0 \n        ? (completedFields / requiredFields) * 100 \n        : 100;\n      \n      return {\n        id: step.id,\n        title: step.title,\n        subtitle: step.subtitle,\n        completed: isCompleted,\n        inProgress: isCurrentStep,\n        blocked: !isCompleted && index > 0 && !config.steps[index - 1].fields.every(field => {\n          const value = formData[field.id];\n          return !field.required || (value !== undefined && value !== null && value !== '');\n        }),\n        completionPercentage,\n        requiredFields,\n        completedFields,\n        requiredDocuments,\n        uploadedDocuments\n      };\n    });\n    \n    setStepStatuses(statuses);\n  }, [config, formData, currentStep]);\n\n  const getStepIcon = (status: StepStatus, index: number) => {\n    if (status.completed) return FiCheckCircle;\n    if (status.inProgress) return FiPlay;\n    if (status.blocked) return FiAlertCircle;\n    return FiClock;\n  };\n\n  const getStepColor = (status: StepStatus) => {\n    if (status.completed) return \"green\";\n    if (status.inProgress) return \"blue\";\n    if (status.blocked) return \"red\";\n    return \"gray\";\n  };\n\n  const getOverallProgress = () => {\n    const totalSteps = stepStatuses.length;\n    const completedSteps = stepStatuses.filter(s => s.completed).length;\n    const currentStepProgress = stepStatuses.find(s => s.inProgress)?.completionPercentage || 0;\n    \n    return ((completedSteps + (currentStepProgress / 100)) / totalSteps) * 100;\n  };\n\n  const getNextIncompleteStep = () => {\n    return stepStatuses.find(s => !s.completed && !s.blocked);\n  };\n\n  const handleStepClick = (index: number) => {\n    const step = stepStatuses[index];\n    if (step.blocked) return;\n    \n    if (step.completed || step.inProgress) {\n      onStepClick(index + 1);\n    } else {\n      onResumeFromStep(index + 1);\n    }\n  };\n\n  return (\n    <Box>\n      {/* Overall Progress */}\n      <Box p=\"6\" bg=\"white\" borderRadius=\"lg\" boxShadow=\"sm\" mb=\"6\">\n        <VStack gap=\"4\" align=\"stretch\">\n          <HStack justify=\"space-between\">\n            <VStack align=\"start\" gap=\"1\">\n              <Text fontSize=\"lg\" fontWeight=\"semibold\" color=\"gray.800\">\n                Application Progress\n              </Text>\n              <Text fontSize=\"sm\" color=\"gray.600\">\n                Complete all steps to submit your application\n              </Text>\n            </VStack>\n            \n            <HStack gap=\"3\">\n              <Badge colorScheme=\"blue\" variant=\"subtle\" fontSize=\"sm\">\n                {Math.round(getOverallProgress())}% Complete\n              </Badge>\n              \n              <Button\n                size=\"sm\"\n                variant=\"outline\"\n                onClick={onSaveProgress}\n                loading={isSaving}\n                disabled={!isDirty}\n              >\n                <Icon as={FiSave} mr=\"2\" />\n                Save Progress\n              </Button>\n            </HStack>\n          </HStack>\n          \n          <Box>\n            <Box h=\"3\" bg=\"gray.200\" borderRadius=\"full\" overflow=\"hidden\">\n              <Box h=\"3\" bg=\"blue.500\" width={`${Math.round(getOverallProgress())}%`} />\n            </Box>\n          </Box>\n          \n          {lastSaved && (\n            <Text fontSize=\"xs\" color=\"gray.500\">\n              Last saved: {new Date(lastSaved).toLocaleString()}\n            </Text>\n          )}\n        </VStack>\n      </Box>\n\n      {/* Step-by-Step Progress */}\n      <Box p=\"6\" bg=\"white\" borderRadius=\"lg\" boxShadow=\"sm\">\n        <VStack gap=\"4\" align=\"stretch\">\n          <HStack justify=\"space-between\">\n            <Text fontSize=\"lg\" fontWeight=\"semibold\" color=\"gray.800\">\n              Step-by-Step Progress\n            </Text>\n            \n            <Button\n              size=\"sm\"\n              variant=\"ghost\"\n              onClick={onOpen}\n            >\n              <Icon as={FiEye} mr=\"1\" />\n              View Details\n            </Button>\n          </HStack>\n          \n          <VStack gap=\"3\" align=\"stretch\">\n            {stepStatuses.map((status, index) => (\n              <Box\n                key={status.id}\n                p=\"4\"\n                border=\"1px\"\n                borderColor={status.blocked ? \"red.200\" : status.inProgress ? \"blue.200\" : status.completed ? \"green.200\" : \"gray.200\"}\n                borderRadius=\"md\"\n                bg={status.blocked ? \"red.50\" : status.inProgress ? \"blue.50\" : status.completed ? \"green.50\" : \"gray.50\"}\n                cursor={status.blocked ? \"not-allowed\" : \"pointer\"}\n                onClick={() => handleStepClick(index)}\n                _hover={!status.blocked ? { bg: status.inProgress ? \"blue.100\" : status.completed ? \"green.100\" : \"gray.100\" } : {}}\n                transition=\"all 0.2s\"\n              >\n                <HStack justify=\"space-between\" align=\"start\">\n                  <HStack gap=\"3\" align=\"start\">\n                    <Icon\n                      as={getStepIcon(status, index)}\n                      boxSize=\"5\"\n                      color={`${getStepColor(status)}.500`}\n                      mt=\"1\"\n                    />\n                    \n                    <VStack align=\"start\" gap=\"1\">\n                      <Text fontSize=\"md\" fontWeight=\"medium\" color=\"gray.800\">\n                        {status.title}\n                      </Text>\n                      <Text fontSize=\"sm\" color=\"gray.600\">\n                        {status.subtitle}\n                      </Text>\n                      \n                      {status.inProgress && (\n                        <HStack gap=\"4\" mt=\"2\">\n                          <HStack gap=\"1\">\n                            <Text fontSize=\"xs\" color=\"blue.600\">\n                              Fields: {status.completedFields}/{status.requiredFields}\n                            </Text>\n                          </HStack>\n                          <HStack gap=\"1\">\n                            <Text fontSize=\"xs\" color=\"blue.600\">\n                              Documents: {status.uploadedDocuments}/{status.requiredDocuments}\n                            </Text>\n                          </HStack>\n                        </HStack>\n                      )}\n                    </VStack>\n                  </HStack>\n                  \n                  <VStack align=\"end\" gap=\"1\">\n                    <Badge\n                      colorScheme={getStepColor(status)}\n                      variant=\"subtle\"\n                      fontSize=\"xs\"\n                    >\n                      {status.completed ? \"Completed\" : status.inProgress ? \"In Progress\" : status.blocked ? \"Blocked\" : \"Pending\"}\n                    </Badge>\n                    \n                    {status.inProgress && (\n                      <Box width=\"100px\">\n                        <Box h=\"2\" bg=\"gray.200\" borderRadius=\"full\" overflow=\"hidden\">\n                          <Box h=\"2\" bg=\"blue.500\" width={`${Math.round(status.completionPercentage)}%`} />\n                        </Box>\n                      </Box>\n                    )}\n                  </VStack>\n                </HStack>\n              </Box>\n            ))}\n          </VStack>\n        </VStack>\n      </Box>\n\n      {/* Next Steps */}\n      {getNextIncompleteStep() && (\n        <Box p=\"4\" bg=\"blue.50\" borderRadius=\"md\" border=\"1px\" borderColor=\"blue.200\" mt=\"4\">\n          <HStack gap=\"2\">\n            <Icon as={FiPlay} color=\"blue.500\" />\n            <Text fontSize=\"sm\" color=\"blue.700\">\n              Next: Complete \"{getNextIncompleteStep()?.title}\" to continue\n            </Text>\n          </HStack>\n        </Box>\n      )}\n\n      {/* Detailed Progress Modal */}\n      <DialogRoot open={isOpen} onOpenChange={(e) => (e.open ? onOpen() : onClose())}>\n        <DialogContent maxW=\"xl\">\n          <DialogHeader>\n            <DialogTitle>Detailed Progress Report</DialogTitle>\n          </DialogHeader>\n          <DialogBody>\n            <VStack gap=\"4\" align=\"stretch\">\n              {stepStatuses.map((status, index) => (\n                <Box key={status.id} p=\"4\" border=\"1px\" borderColor=\"gray.200\" borderRadius=\"md\">\n                  <VStack gap=\"3\" align=\"stretch\">\n                    <HStack justify=\"space-between\">\n                      <HStack gap=\"2\">\n                        <Icon\n                          as={getStepIcon(status, index)}\n                          boxSize=\"4\"\n                          color={`${getStepColor(status)}.500`}\n                        />\n                        <Text fontWeight=\"medium\" color=\"gray.800\">\n                          {status.title}\n                        </Text>\n                      </HStack>\n                      <Badge colorScheme={getStepColor(status)} variant=\"subtle\">\n                        {Math.round(status.completionPercentage)}%\n                      </Badge>\n                    </HStack>\n                    \n                    <Text fontSize=\"sm\" color=\"gray.600\">\n                      {status.subtitle}\n                    </Text>\n                    \n                    <SimpleGrid columns={2} gap=\"4\">\n                      <Box>\n                        <Text fontSize=\"xs\" color=\"gray.500\" mb=\"1\">Required Fields</Text>\n                        <HStack gap=\"2\">\n                          <Box w=\"100px\" h=\"2\" bg=\"gray.200\" borderRadius=\"full\" overflow=\"hidden\">\n                            <Box h=\"2\" bg=\"blue.500\" width={`${Math.round((status.completedFields / Math.max(status.requiredFields,1)) * 100)}%`} />\n                          </Box>\n                          <Text fontSize=\"xs\" color=\"gray.600\">\n                            {status.completedFields}/{status.requiredFields}\n                          </Text>\n                        </HStack>\n                      </Box>\n                      \n                      <Box>\n                        <Text fontSize=\"xs\" color=\"gray.500\" mb=\"1\">Required Documents</Text>\n                        <HStack gap=\"2\">\n                          <Box w=\"100px\" h=\"2\" bg=\"gray.200\" borderRadius=\"full\" overflow=\"hidden\">\n                            <Box h=\"2\" bg=\"green.500\" width={`${Math.round((status.uploadedDocuments / Math.max(status.requiredDocuments,1)) * 100)}%`} />\n                          </Box>\n                          <Text fontSize=\"xs\" color=\"gray.600\">\n                            {status.uploadedDocuments}/{status.requiredDocuments}\n                          </Text>\n                        </HStack>\n                      </Box>\n                    </SimpleGrid>\n                  </VStack>\n                </Box>\n              ))}\n            </VStack>\n          </DialogBody>\n          <DialogFooter>\n            <Button onClick={onClose}>Close</Button>\n          </DialogFooter>\n          <DialogCloseTrigger />\n        </DialogContent>\n      </DialogRoot>\n    </Box>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3634, "column": 0}, "map": {"version":3,"sources":["file:///Users/mukurusystemsadministrator/Desktop/onboarding_kyc%20copy/partner/src/components/EnhancedContextualMessaging.tsx"],"sourcesContent":["\"use client\";\n\nimport {\n  Box,\n  VStack,\n  HStack,\n  Text,\n  Button,\n  Input,\n  Textarea,\n  Avatar,\n  Badge,\n  Flex,\n  Icon,\n  Tooltip,\n  Spinner,\n  Image,\n  Link,\n  useDisclosure,\n  DialogRoot,\n  DialogBackdrop,\n  DialogContent,\n  DialogHeader,\n  DialogBody,\n  DialogFooter,\n  DialogTitle,\n  DialogCloseTrigger,\n  Select,\n  Checkbox,\n  SimpleGrid\n} from \"@chakra-ui/react\";\nimport { useState, useEffect, useRef } from \"react\";\nimport {\n  FiSend,\n  FiPaperclip,\n  FiMoreVertical,\n  FiSearch,\n  FiFilter,\n  FiArchive,\n  FiFlag,\n  FiCornerUpLeft,\n  FiCornerUpRight,\n  FiDownload,\n  FiEye,\n  FiEdit,\n  FiTrash2,\n  FiStar,\n  FiClock,\n  FiCheck,\n  FiCheckCircle,\n  FiAlertCircle,\n  FiInfo,\n  FiUser,\n  FiUsers,\n  FiTag,\n  FiCalendar,\n  FiMessageSquare,\n  FiFileText,\n  FiImage,\n  FiVideo,\n  FiFile,\n  FiMapPin,\n  FiFolder\n} from \"react-icons/fi\";\nimport { motion, AnimatePresence } from \"framer-motion\";\n\nconst MotionBox = motion.create(Box);\nconst MotionVStack = motion.create(VStack);\n\nexport interface ContextualMessage {\n  id: string;\n  senderId: string;\n  senderName: string;\n  senderType: 'partner' | 'admin' | 'system';\n  senderAvatar?: string;\n  content: string;\n  timestamp: string;\n  status: 'sent' | 'delivered' | 'read';\n  priority: 'low' | 'normal' | 'high' | 'urgent';\n  attachments?: Array<{\n    id: string;\n    name: string;\n    type: string;\n    size: string;\n    url: string;\n  }>;\n  replyTo?: string;\n  isRead: boolean;\n  isStarred: boolean;\n  tags?: string[];\n  applicationId?: string;\n  sectionReference?: string;\n  documentReference?: string;\n  fieldReference?: string;\n  context?: {\n    sectionTitle?: string;\n    fieldLabel?: string;\n    documentName?: string;\n    actionRequired?: string;\n  };\n}\n\nexport interface ContextualConversation {\n  id: string;\n  applicationId: string;\n  partnerId: string;\n  adminId?: string;\n  subject: string;\n  status: 'active' | 'resolved' | 'archived';\n  priority: 'low' | 'normal' | 'high' | 'urgent';\n  lastMessage?: string;\n  lastMessageTime?: string;\n  unreadCount: number;\n  tags: string[];\n  createdAt: string;\n  contextSections: string[];\n}\n\ninterface EnhancedContextualMessagingProps {\n  conversations: ContextualConversation[];\n  messages: ContextualMessage[];\n  currentConversationId?: string;\n  currentApplicationId?: string;\n  onSendMessage: (content: string, context?: any, attachments?: File[]) => Promise<void>;\n  onReplyToMessage: (messageId: string, content: string) => Promise<void>;\n  onForwardMessage: (messageId: string, toConversationId: string) => Promise<void>;\n  onStarMessage: (messageId: string) => Promise<void>;\n  onArchiveConversation: (conversationId: string) => Promise<void>;\n  onAssignConversation: (conversationId: string, adminId: string) => Promise<void>;\n  onTagConversation: (conversationId: string, tags: string[]) => Promise<void>;\n  currentUser: {\n    id: string;\n    name: string;\n    type: 'partner' | 'admin';\n    avatar?: string;\n  };\n  applicationSections?: Array<{\n    id: string;\n    title: string;\n    fields: Array<{\n      id: string;\n      label: string;\n      value?: any;\n    }>;\n  }>;\n  applicationDocuments?: Array<{\n    id: string;\n    name: string;\n    type: string;\n    status: string;\n    url?: string;\n  }>;\n}\n\nexport function EnhancedContextualMessaging({\n  conversations,\n  messages,\n  currentConversationId,\n  currentApplicationId,\n  onSendMessage,\n  onReplyToMessage,\n  onForwardMessage,\n  onStarMessage,\n  onArchiveConversation,\n  onAssignConversation,\n  onTagConversation,\n  currentUser,\n  applicationSections = [],\n  applicationDocuments = [],\n  loadingContext = false\n}: EnhancedContextualMessagingProps & { loadingContext?: boolean }) {\n  \n  const [newMessage, setNewMessage] = useState(\"\");\n  const [selectedContext, setSelectedContext] = useState<any>(null);\n  const [searchTerm, setSearchTerm] = useState(\"\");\n  const [filterPriority, setFilterPriority] = useState<string>(\"all\");\n  const [filterStatus, setFilterStatus] = useState<string>(\"all\");\n  const [isSending, setIsSending] = useState(false);\n  const [selectedAttachments, setSelectedAttachments] = useState<File[]>([]);\n  const [replyToMessage, setReplyToMessage] = useState<ContextualMessage | null>(null);\n  \n  const { open: isContextOpen, onOpen: onContextOpen, onClose: onContextClose } = useDisclosure();\n  const { open: isAttachmentOpen, onOpen: onAttachmentOpen, onClose: onAttachmentClose } = useDisclosure();\n  \n  const messagesEndRef = useRef<HTMLDivElement>(null);\n  const fileInputRef = useRef<HTMLInputElement>(null);\n  const [banner, setBanner] = useState<{ status: 'success' | 'error'; message: string } | null>(null);\n\n  const currentConversation = conversations.find(c => c.id === currentConversationId);\n  // Filter messages by conversation/thread, sort by timestamp (oldest first for display)\n  const currentMessages = messages\n    .filter(m => !currentConversationId || m.applicationId === currentApplicationId || m.applicationId === currentConversation?.applicationId)\n    .sort((a, b) => new Date(a.timestamp).getTime() - new Date(b.timestamp).getTime());\n\n  useEffect(() => {\n    messagesEndRef.current?.scrollIntoView({ behavior: \"smooth\" });\n  }, [currentMessages]);\n\n  const handleSendMessage = async () => {\n    if (!newMessage.trim() && selectedAttachments.length === 0) return;\n    \n    // Check if we have an application ID\n    if (!currentApplicationId) {\n      setBanner({ status: 'error', message: 'Please select an application to send a message' });\n      setTimeout(() => setBanner(null), 3000);\n      return;\n    }\n    \n    setIsSending(true);\n    try {\n      await onSendMessage(newMessage, selectedContext, selectedAttachments);\n      setNewMessage(\"\");\n      setSelectedContext(null);\n      setSelectedAttachments([]);\n      setReplyToMessage(null);\n    } catch (error) {\n      setBanner({ status: 'error', message: 'Failed to send message' });\n      setTimeout(() => setBanner(null), 3000);\n    } finally {\n      setIsSending(false);\n    }\n  };\n\n  const handleFileSelect = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const files = Array.from(event.target.files || []);\n    setSelectedAttachments(prev => [...prev, ...files]);\n  };\n\n  const removeAttachment = (index: number) => {\n    setSelectedAttachments(prev => prev.filter((_, i) => i !== index));\n  };\n\n  const getContextualSections = () => {\n    return applicationSections.map(section => ({\n      id: section.id,\n      title: section.title,\n      type: 'section',\n      fields: section.fields\n    }));\n  };\n\n  const getContextualDocuments = () => {\n    return applicationDocuments.map(doc => ({\n      id: doc.id,\n      title: doc.name || 'Document',\n      type: doc.type || 'document',\n      status: doc.status || 'unknown',\n      url: doc.url\n    }));\n  };\n\n  const getPriorityColor = (priority: string) => {\n    switch (priority) {\n      case 'urgent': return 'red';\n      case 'high': return 'orange';\n      case 'normal': return 'blue';\n      case 'low': return 'gray';\n      default: return 'gray';\n    }\n  };\n\n  const getStatusColor = (status: string) => {\n    switch (status) {\n      case 'sent': return 'blue';\n      case 'delivered': return 'green';\n      case 'read': return 'green';\n      default: return 'gray';\n    }\n  };\n\n  const formatFileSize = (bytes: number) => {\n    if (bytes === 0) return '0 Bytes';\n    const k = 1024;\n    const sizes = ['Bytes', 'KB', 'MB', 'GB'];\n    const i = Math.floor(Math.log(bytes) / Math.log(k));\n    return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];\n  };\n\n  const getFileIcon = (type: string) => {\n    if (type.startsWith('image/')) return FiImage;\n    if (type.startsWith('video/')) return FiVideo;\n    if (type.includes('pdf')) return FiFileText;\n    return FiFile;\n  };\n\n  return (\n    <Box height=\"100%\" display=\"flex\" flexDirection=\"column\" overflow=\"hidden\" minH=\"0\">\n      {/* Header */}\n      <Box p=\"3\" borderBottom=\"1px\" borderColor=\"gray.200\" bg=\"white\" flexShrink={0}>\n        <VStack gap=\"2\" align=\"stretch\">\n          <HStack justify=\"space-between\" align=\"center\">\n            <VStack align=\"start\" gap=\"0.5\">\n              <Text fontSize=\"md\" fontWeight=\"semibold\" color=\"gray.900\">\n                Application Communication\n              </Text>\n              <Text fontSize=\"xs\" color=\"gray.600\" fontWeight=\"normal\">\n                {currentApplicationId ? `Application ${currentApplicationId.slice(0, 8)}...` : 'No application selected'}\n              </Text>\n            </VStack>\n            \n            {currentMessages.filter(m => !m.isRead && m.senderType !== currentUser.type).length > 0 && (\n              <Badge \n                colorScheme=\"orange\" \n                variant=\"solid\"\n                px=\"1.5\"\n                py=\"0.5\"\n                borderRadius=\"full\"\n                fontSize=\"2xs\"\n                fontWeight=\"semibold\"\n              >\n                {currentMessages.filter(m => !m.isRead && m.senderType !== currentUser.type).length} Unread\n              </Badge>\n            )}\n          </HStack>\n          \n          {/* Context Selection */}\n          <HStack gap=\"2\" align=\"center\">\n            <Text fontSize=\"xs\" color=\"gray.600\" fontWeight=\"medium\">Reference:</Text>\n            <Button\n              size=\"xs\"\n              variant=\"outline\"\n              onClick={onContextOpen}\n              borderColor=\"gray.300\"\n              _hover={{ bg: \"gray.50\", borderColor: \"gray.400\" }}\n              height=\"24px\"\n              fontSize=\"xs\"\n            >\n              <Icon as={FiMapPin} mr=\"1\" boxSize=\"3\" />\n              {selectedContext ? selectedContext.title : \"Select Context\"}\n            </Button>\n            {selectedContext && (\n              <Badge colorScheme=\"blue\" variant=\"subtle\" fontSize=\"2xs\">\n                {selectedContext.type}\n              </Badge>\n            )}\n          </HStack>\n        </VStack>\n      </Box>\n\n      {/* Banner */}\n      {banner && (\n        <Box p=\"3\" bg={banner.status === 'success' ? 'green.50' : 'red.50'} border=\"1px\" borderColor={banner.status === 'success' ? 'green.200' : 'red.200'}>\n          <Text fontSize=\"sm\" color={banner.status === 'success' ? 'green.700' : 'red.700'}>{banner.message}</Text>\n        </Box>\n      )}\n\n      {/* Messages */}\n      <Box flex=\"1\" overflowY=\"auto\" p=\"4\" bg=\"gray.50\">\n        <VStack gap=\"2.5\" align=\"stretch\">\n          <AnimatePresence>\n            {currentMessages.length === 0 ? (\n              <Box p=\"8\" textAlign=\"center\">\n                <Icon as={FiMessageSquare} boxSize=\"8\" color=\"gray.300\" mb=\"3\" />\n                <Text fontSize=\"sm\" color=\"gray.500\" fontWeight=\"medium\">No messages yet</Text>\n                <Text fontSize=\"xs\" color=\"gray.400\" mt=\"1\">Start the conversation below</Text>\n              </Box>\n            ) : (\n              currentMessages.map((message) => (\n                <MotionBox\n                  key={message.id}\n                  initial={{ opacity: 0, y: 4 }}\n                  animate={{ opacity: 1, y: 0 }}\n                  exit={{ opacity: 0, y: -4 }}\n                  transition={{ duration: 0.1 }}\n                >\n                  {/* Determine if message is from current user (partner) or admin */}\n                  {(() => {\n                    // In partner view: partner messages go on RIGHT, admin messages on LEFT\n                    const isFromCurrentUser = message.senderType === 'partner' || \n                                             (currentUser.type === 'partner' && message.senderType !== 'admin');\n                    const isFromAdmin = message.senderType === 'admin';\n                    \n                    return (\n                      <Flex\n                        justify={isFromCurrentUser ? \"flex-end\" : \"flex-start\"}\n                        gap=\"2\"\n                        align=\"flex-start\"\n                        maxW=\"75%\"\n                        ml={isFromCurrentUser ? \"auto\" : \"0\"}\n                        mr={!isFromCurrentUser ? \"auto\" : \"0\"}\n                      >\n                        {!isFromCurrentUser && (\n                          <Avatar.Root size=\"sm\" flexShrink={0}>\n                            <Avatar.Fallback bg={isFromAdmin ? \"orange.500\" : \"blue.500\"} color=\"white\" fontSize=\"xs\" fontWeight=\"semibold\">\n                              {message.senderName.charAt(0).toUpperCase()}\n                            </Avatar.Fallback>\n                          </Avatar.Root>\n                        )}\n                        <Box\n                          maxW=\"100%\"\n                          p=\"2.5\"\n                          bg={isFromCurrentUser ? \"blue.500\" : (isFromAdmin ? \"orange.500\" : \"white\")}\n                          bgGradient={isFromCurrentUser ? \"linear(to-br, blue.500, blue.600)\" : (isFromAdmin ? \"linear(to-br, orange.500, orange.600)\" : undefined)}\n                          color={isFromCurrentUser || isFromAdmin ? \"white\" : \"gray.900\"}\n                          borderRadius=\"lg\"\n                          boxShadow={isFromCurrentUser ? \"0 2px 8px rgba(49, 130, 206, 0.2)\" : (isFromAdmin ? \"0 2px 8px rgba(237, 137, 54, 0.2)\" : \"0 1px 4px rgba(0, 0, 0, 0.06)\")}\n                          border={isFromCurrentUser || isFromAdmin ? \"none\" : \"1px solid\"}\n                          borderColor={isFromCurrentUser || isFromAdmin ? \"transparent\" : \"gray.200\"}\n                          _hover={{\n                            boxShadow: isFromCurrentUser ? \"0 3px 10px rgba(49, 130, 206, 0.25)\" : (isFromAdmin ? \"0 3px 10px rgba(237, 137, 54, 0.25)\" : \"0 2px 6px rgba(0, 0, 0, 0.08)\")\n                          }}\n                          transition=\"all 0.2s ease\"\n                        >\n                          <VStack gap=\"1.5\" align=\"stretch\">\n                            {/* Message Header */}\n                            <HStack justify=\"space-between\" align=\"start\" gap=\"2\">\n                              <HStack gap=\"1.5\" align=\"center\">\n                                <Box\n                                  width=\"4px\"\n                                  height=\"4px\"\n                                  borderRadius=\"full\"\n                                  bg={isFromCurrentUser || isFromAdmin ? \"rgba(255, 255, 255, 0.6)\" : \"blue.500\"}\n                                  flexShrink={0}\n                                />\n                                <VStack align=\"start\" gap=\"0\">\n                                  <Text \n                                    fontSize=\"xs\" \n                                    fontWeight=\"medium\" \n                                    color={isFromCurrentUser || isFromAdmin ? \"rgba(255, 255, 255, 0.95)\" : \"gray.700\"}\n                                    letterSpacing=\"0.1px\"\n                                  >\n                                    {message.senderName}\n                                  </Text>\n                                  <Text \n                                    fontSize=\"2xs\" \n                                    color={isFromCurrentUser || isFromAdmin ? \"rgba(255, 255, 255, 0.75)\" : \"gray.500\"}\n                                  >\n                                    {new Date(message.timestamp).toLocaleString('en-US', {\n                                      month: 'numeric',\n                                      day: 'numeric',\n                                      hour: 'numeric',\n                                      minute: '2-digit',\n                                      hour12: true\n                                    })}\n                                  </Text>\n                                </VStack>\n                              </HStack>\n                              <Badge\n                                bg={isFromCurrentUser || isFromAdmin ? \"rgba(255, 255, 255, 0.2)\" : \"gray.100\"}\n                                color={isFromCurrentUser || isFromAdmin ? \"white\" : \"gray.600\"}\n                                variant=\"solid\"\n                                fontSize=\"2xs\"\n                                px=\"1.5\"\n                                py=\"0.5\"\n                                borderRadius=\"sm\"\n                                fontWeight=\"medium\"\n                                backdropFilter=\"blur(4px)\"\n                              >\n                                {message.isRead ? \" Read\" : \"Sent\"}\n                              </Badge>\n                            </HStack>\n                            \n                            {/* Message Content */}\n                            <Box pt=\"0.5\">\n                              <Text \n                                fontSize=\"sm\" \n                                whiteSpace=\"pre-wrap\" \n                                lineHeight=\"1.5\"\n                                color={isFromCurrentUser || isFromAdmin ? \"white\" : \"gray.800\"}\n                                fontWeight=\"normal\"\n                              >\n                                {message.content}\n                              </Text>\n                            </Box>\n                            \n                            {/* Message Actions */}\n                            <HStack gap=\"0.5\" pt=\"1.5\" borderTop=\"1px\" borderColor={isFromCurrentUser || isFromAdmin ? \"rgba(255, 255, 255, 0.15)\" : \"gray.100\"}>\n                              <Button\n                                size=\"xs\"\n                                variant=\"ghost\"\n                                color={isFromCurrentUser || isFromAdmin ? \"rgba(255, 255, 255, 0.85)\" : \"gray.600\"}\n                                onClick={() => setReplyToMessage(message)}\n                                _hover={{ \n                                  bg: isFromCurrentUser || isFromAdmin ? \"rgba(255, 255, 255, 0.12)\" : \"gray.100\",\n                                  color: isFromCurrentUser || isFromAdmin ? \"white\" : \"gray.700\"\n                                }}\n                                fontSize=\"2xs\"\n                                px=\"1.5\"\n                                py=\"0.5\"\n                                h=\"auto\"\n                                minH=\"auto\"\n                                fontWeight=\"normal\"\n                              >\n                                <Icon as={FiCornerUpLeft} mr=\"1\" boxSize=\"2.5\" />\n                                Reply\n                              </Button>\n                              <Button\n                                size=\"xs\"\n                                variant=\"ghost\"\n                                color={isFromCurrentUser || isFromAdmin ? \"rgba(255, 255, 255, 0.85)\" : \"gray.600\"}\n                                onClick={() => onStarMessage(message.id)}\n                                _hover={{ \n                                  bg: isFromCurrentUser || isFromAdmin ? \"rgba(255, 255, 255, 0.12)\" : \"gray.100\",\n                                  color: isFromCurrentUser || isFromAdmin ? \"white\" : \"gray.700\"\n                                }}\n                                fontSize=\"2xs\"\n                                px=\"1.5\"\n                                py=\"0.5\"\n                                h=\"auto\"\n                                minH=\"auto\"\n                                fontWeight=\"normal\"\n                              >\n                                <Icon as={FiStar} mr=\"1\" boxSize=\"2.5\" />\n                                Star\n                              </Button>\n                              <Button\n                                size=\"xs\"\n                                variant=\"ghost\"\n                                color={isFromCurrentUser || isFromAdmin ? \"rgba(255, 255, 255, 0.85)\" : \"gray.600\"}\n                                _hover={{ \n                                  bg: isFromCurrentUser || isFromAdmin ? \"rgba(255, 255, 255, 0.12)\" : \"gray.100\",\n                                  color: isFromCurrentUser || isFromAdmin ? \"white\" : \"gray.700\"\n                                }}\n                                fontSize=\"2xs\"\n                                px=\"1.5\"\n                                py=\"0.5\"\n                                h=\"auto\"\n                                minH=\"auto\"\n                                fontWeight=\"normal\"\n                              >\n                                <Icon as={FiCornerUpRight} mr=\"1\" boxSize=\"2.5\" />\n                                Forward\n                              </Button>\n                            </HStack>\n                          </VStack>\n                        </Box>\n                        {isFromCurrentUser && (\n                          <Avatar.Root size=\"sm\" flexShrink={0}>\n                            <Avatar.Fallback bg=\"#f76834\" color=\"white\" fontSize=\"xs\" fontWeight=\"semibold\">\n                              {message.senderName.charAt(0).toUpperCase()}\n                            </Avatar.Fallback>\n                          </Avatar.Root>\n                        )}\n                      </Flex>\n                    );\n                  })()}\n                </MotionBox>\n              ))\n            )}\n          </AnimatePresence>\n          <div ref={messagesEndRef} />\n        </VStack>\n      </Box>\n\n      {/* Reply Indicator */}\n      {replyToMessage && (\n        <Box p=\"3\" bg=\"blue.50\" borderTop=\"1px\" borderColor=\"blue.200\">\n          <HStack justify=\"space-between\">\n            <HStack gap=\"2\">\n              <Icon as={FiCornerUpLeft} color=\"blue.500\" />\n              <Text fontSize=\"sm\" color=\"blue.700\">\n                Replying to {replyToMessage.senderName}\n              </Text>\n            </HStack>\n            <Button\n              size=\"xs\"\n              variant=\"ghost\"\n              onClick={() => setReplyToMessage(null)}\n            >\n              Cancel\n            </Button>\n          </HStack>\n        </Box>\n      )}\n\n      {/* Message Input */}\n      <Box p=\"3\" bg=\"white\" borderTop=\"1px\" borderColor=\"gray.200\" flexShrink={0}>\n        <VStack gap=\"2\" align=\"stretch\">\n          {/* Attachments */}\n          {selectedAttachments.length > 0 && (\n            <Box p=\"2\" bg=\"gray.50\" borderRadius=\"md\" border=\"1px\" borderColor=\"gray.200\">\n              <VStack gap=\"1.5\" align=\"stretch\">\n                <Text fontSize=\"xs\" fontWeight=\"semibold\" color=\"gray.700\">\n                  Attachments ({selectedAttachments.length})\n                </Text>\n                {selectedAttachments.map((file, index) => (\n                  <HStack key={index} gap=\"2\" justify=\"space-between\" p=\"1.5\" bg=\"white\" borderRadius=\"sm\">\n                    <HStack gap=\"2\" flex=\"1\" minW=\"0\">\n                      <Icon as={getFileIcon(file.type)} color=\"gray.500\" boxSize=\"3.5\" />\n                      <VStack align=\"start\" gap=\"0\" flex=\"1\" minW=\"0\">\n                        <Text fontSize=\"2xs\" color=\"gray.700\" fontWeight=\"medium\" overflow=\"hidden\" textOverflow=\"ellipsis\" whiteSpace=\"nowrap\">{file.name}</Text>\n                        <Text fontSize=\"2xs\" color=\"gray.500\">{formatFileSize(file.size)}</Text>\n                      </VStack>\n                    </HStack>\n                    <Button\n                      size=\"xs\"\n                      variant=\"ghost\"\n                      color=\"red.500\"\n                      onClick={() => removeAttachment(index)}\n                      _hover={{ bg: \"red.50\" }}\n                      minW=\"auto\"\n                      px=\"1\"\n                      h=\"auto\"\n                    >\n                      <Icon as={FiTrash2} boxSize=\"3\" />\n                    </Button>\n                  </HStack>\n                ))}\n              </VStack>\n            </Box>\n          )}\n          \n          {/* Input Area */}\n          <HStack gap=\"2\" align=\"flex-end\">\n            <VStack gap=\"1.5\" align=\"stretch\" flex=\"1\">\n              <Textarea\n                placeholder=\"Type your message...\"\n                value={newMessage}\n                onChange={(e) => setNewMessage(e.target.value)}\n                rows={2}\n                resize=\"none\"\n                borderColor=\"gray.300\"\n                color=\"black\"\n                _focus={{ borderColor: \"blue.500\", boxShadow: \"0 0 0 1px #3182ce\", color: \"black\" }}\n                _hover={{ borderColor: \"gray.400\" }}\n                _placeholder={{ color: \"gray.400\" }}\n                fontSize=\"sm\"\n                py=\"2\"\n                px=\"3\"\n                onKeyPress={(e) => {\n                  if (e.key === 'Enter' && !e.shiftKey) {\n                    e.preventDefault();\n                    handleSendMessage();\n                  }\n                }}\n              />\n              \n              <HStack justify=\"space-between\" align=\"center\">\n                <Button\n                  size=\"xs\"\n                  variant=\"ghost\"\n                  onClick={() => fileInputRef.current?.click()}\n                  color=\"gray.600\"\n                  _hover={{ bg: \"gray.100\", color: \"gray.700\" }}\n                  fontWeight=\"normal\"\n                  h=\"auto\"\n                  py=\"1\"\n                  px=\"2\"\n                >\n                  <Icon as={FiPaperclip} mr=\"1.5\" boxSize=\"3.5\" />\n                  Attach\n                </Button>\n                <input\n                  ref={fileInputRef}\n                  type=\"file\"\n                  multiple\n                  onChange={handleFileSelect}\n                  style={{ display: 'none' }}\n                />\n                \n                <HStack gap=\"1.5\">\n                  <Button\n                    size=\"xs\"\n                    variant=\"outline\"\n                    onClick={() => setNewMessage(\"\")}\n                    disabled={!newMessage.trim()}\n                    borderColor=\"gray.300\"\n                    color=\"gray.600\"\n                    _hover={{ bg: \"gray.50\", borderColor: \"gray.400\" }}\n                    fontWeight=\"normal\"\n                    h=\"auto\"\n                    py=\"1\"\n                    px=\"2.5\"\n                  >\n                    Clear\n                  </Button>\n                  <Button\n                    size=\"xs\"\n                    bg=\"blue.500\"\n                    color=\"white\"\n                    onClick={handleSendMessage}\n                    loading={isSending}\n                    disabled={(!newMessage.trim() && selectedAttachments.length === 0) || !currentApplicationId}\n                    _hover={{ bg: \"blue.600\" }}\n                    _active={{ bg: \"blue.700\" }}\n                    fontWeight=\"semibold\"\n                    h=\"auto\"\n                    py=\"1\"\n                    px=\"3\"\n                    title={!currentApplicationId ? \"Please select an application first\" : undefined}\n                  >\n                    <Icon as={FiSend} mr=\"1.5\" boxSize=\"3.5\" />\n                    Send\n                  </Button>\n                </HStack>\n              </HStack>\n            </VStack>\n          </HStack>\n        </VStack>\n      </Box>\n\n      {/* Context Selection Dialog (Chakra v3) */}\n      <DialogRoot open={isContextOpen} onOpenChange={(e) => (e.open ? onContextOpen() : onContextClose())} modal={true}>\n        <DialogBackdrop \n          bg=\"blackAlpha.600\" \n          backdropFilter=\"blur(4px)\"\n        />\n        <DialogContent \n          maxW=\"md\" \n          mx=\"auto\"\n          position=\"fixed\"\n          top=\"50%\"\n          left=\"50%\"\n          transform=\"translate(-50%, -50%)\"\n          zIndex={1500}\n          boxShadow=\"xl\"\n          borderRadius=\"xl\"\n          border=\"1px\"\n          borderColor=\"gray.200\"\n        >\n          <DialogHeader borderBottom=\"1px\" borderColor=\"gray.200\" pb=\"3\">\n            <DialogTitle fontSize=\"lg\" fontWeight=\"semibold\" color=\"gray.900\">Select Context Reference</DialogTitle>\n          </DialogHeader>\n          <DialogBody>\n            {loadingContext ? (\n              <Box p=\"8\" textAlign=\"center\">\n                <Spinner size=\"md\" color=\"blue.500\" />\n                <Text fontSize=\"sm\" color=\"gray.600\" mt=\"3\">Loading context...</Text>\n              </Box>\n            ) : (\n              <VStack gap=\"4\" align=\"stretch\">\n                {/* Application Sections */}\n                <Box>\n                  <Text fontSize=\"sm\" fontWeight=\"semibold\" color=\"gray.800\" mb=\"2\">\n                    Application Sections\n                  </Text>\n                  {getContextualSections().length === 0 ? (\n                    <Box p=\"4\" textAlign=\"center\" bg=\"gray.50\" borderRadius=\"md\">\n                      <Text fontSize=\"xs\" color=\"gray.500\">No sections available</Text>\n                    </Box>\n                  ) : (\n                  <VStack gap=\"2\" align=\"stretch\">\n                    {getContextualSections().map((section) => (\n                      <Box\n                        key={section.id}\n                        p=\"2.5\"\n                        border=\"1px\"\n                        borderColor=\"gray.200\"\n                        borderRadius=\"md\"\n                        cursor=\"pointer\"\n                        _hover={{ bg: \"blue.50\", borderColor: \"blue.300\" }}\n                        transition=\"all 0.2s\"\n                        onClick={() => {\n                          setSelectedContext(section);\n                          onContextClose();\n                        }}\n                      >\n                        <HStack gap=\"2\">\n                          <Icon as={FiFolder} color=\"blue.500\" boxSize=\"4\" />\n                          <VStack align=\"start\" gap=\"0\" flex=\"1\">\n                            <Text fontSize=\"sm\" fontWeight=\"medium\" color=\"gray.800\">\n                              {section.title}\n                            </Text>\n                            <Text fontSize=\"xs\" color=\"gray.500\">\n                              {section.fields?.length || 0} field{section.fields?.length !== 1 ? 's' : ''}\n                            </Text>\n                          </VStack>\n                        </HStack>\n                      </Box>\n                    ))}\n                  </VStack>\n                )}\n              </Box>\n              \n              <Box h=\"1px\" bg=\"gray.200\" />\n              \n              {/* Application Documents */}\n              <Box>\n                <Text fontSize=\"sm\" fontWeight=\"semibold\" color=\"gray.800\" mb=\"2\">\n                  Application Documents\n                </Text>\n                {getContextualDocuments().length === 0 ? (\n                  <Box p=\"4\" textAlign=\"center\" bg=\"gray.50\" borderRadius=\"md\">\n                    <Text fontSize=\"xs\" color=\"gray.500\">No documents available</Text>\n                  </Box>\n                ) : (\n                  <VStack gap=\"2\" align=\"stretch\">\n                    {getContextualDocuments().map((doc) => (\n                      <Box\n                        key={doc.id}\n                        p=\"2.5\"\n                        border=\"1px\"\n                        borderColor=\"gray.200\"\n                        borderRadius=\"md\"\n                        cursor=\"pointer\"\n                        _hover={{ bg: \"green.50\", borderColor: \"green.300\" }}\n                        transition=\"all 0.2s\"\n                        onClick={() => {\n                          setSelectedContext(doc);\n                          onContextClose();\n                        }}\n                      >\n                        <HStack gap=\"2\">\n                          <Icon as={FiFileText} color=\"green.500\" boxSize=\"4\" />\n                          <VStack align=\"start\" gap=\"0\" flex=\"1\">\n                            <Text fontSize=\"sm\" fontWeight=\"medium\" color=\"gray.800\">\n                              {doc.title || 'Document'}\n                            </Text>\n                            <Text fontSize=\"xs\" color=\"gray.500\">\n                              {doc.type && doc.type !== 'document' && <span>{doc.type}  </span>}\n                              Status: {doc.status || 'Unknown'}\n                            </Text>\n                          </VStack>\n                        </HStack>\n                      </Box>\n                    ))}\n                  </VStack>\n                )}\n              </Box>\n              </VStack>\n            )}\n          </DialogBody>\n          <DialogFooter borderTop=\"1px\" borderColor=\"gray.200\" pt=\"3\">\n            <Button \n              onClick={onContextClose}\n              variant=\"outline\"\n              size=\"sm\"\n            >\n              Close\n            </Button>\n          </DialogFooter>\n          <DialogCloseTrigger />\n        </DialogContent>\n      </DialogRoot>\n    </Box>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 5099, "column": 0}, "map": {"version":3,"sources":["file:///Users/mukurusystemsadministrator/Desktop/onboarding_kyc%20copy/partner/src/components/OCRIntegration.tsx"],"sourcesContent":["\"use client\";\n\nimport { Box, VStack, HStack, Text, Button, Icon, SimpleGrid, Badge, Spinner, useDisclosure, DialogRoot, DialogContent, DialogHeader, DialogBody, DialogFooter, DialogTitle, DialogCloseTrigger } from \"@chakra-ui/react\";\nimport { useState, useRef, useEffect } from \"react\";\nimport {\n  FiUpload,\n  FiFileText,\n  FiCheckCircle,\n  FiAlertCircle,\n  FiEye,\n  FiEdit,\n  FiSave,\n  FiRefreshCw,\n  FiDownload,\n  FiTrash2,\n  FiInfo,\n  FiZap,\n  FiFile,\n  FiImage\n} from \"react-icons/fi\";\nimport { FileUpload } from \"@shared/components/FileUpload\";\nimport { SweetAlert } from \"../utils/sweetAlert\";\n\ninterface OCRResult {\n  id: string;\n  fileName: string;\n  fileType: string;\n  extractedText: string;\n  confidence: number;\n  extractedData: Record<string, any>;\n  processingTime: number;\n  timestamp: string;\n  status: 'processing' | 'completed' | 'failed' | 'reviewed';\n  errors?: string[];\n}\n\ninterface OCRFieldMapping {\n  fieldId: string;\n  fieldLabel: string;\n  extractedValue: any;\n  confidence: number;\n  verified: boolean;\n  suggested: boolean;\n}\n\ninterface OCRIntegrationProps {\n  onDataExtracted: (fieldMappings: OCRFieldMapping[]) => void;\n  onDocumentProcessed: (result: OCRResult) => void;\n  entityType?: string;\n  documentType?: string;\n  maxFileSize?: number;\n  acceptedTypes?: string[];\n}\n\nexport function OCRIntegration({\n  onDataExtracted,\n  onDocumentProcessed,\n  entityType = 'private_company',\n  documentType = 'certificate_incorporation',\n  maxFileSize = 10,\n  acceptedTypes = ['.pdf', '.jpg', '.jpeg', '.png', '.tiff']\n}: OCRIntegrationProps) {\n  \n  const [isProcessing, setIsProcessing] = useState(false);\n  const [processingProgress, setProcessingProgress] = useState(0);\n  const [ocrResults, setOcrResults] = useState<OCRResult[]>([]);\n  const [selectedResult, setSelectedResult] = useState<OCRResult | null>(null);\n  const [fieldMappings, setFieldMappings] = useState<OCRFieldMapping[]>([]);\n  const [isReviewing, setIsReviewing] = useState(false);\n  \n  const { open: isReviewOpen, onOpen: onReviewOpen, onClose: onReviewClose } = useDisclosure();\n  const [banner, setBanner] = useState<{ status: 'success' | 'error'; message: string } | null>(null);\n\n  const processDocumentWithOCR = async (file: File): Promise<OCRResult> => {\n    setIsProcessing(true);\n    setProcessingProgress(0);\n    \n    try {\n      // Simulate OCR processing with progress updates\n      const progressInterval = setInterval(() => {\n        setProcessingProgress(prev => {\n          if (prev >= 90) {\n            clearInterval(progressInterval);\n            return 90;\n          }\n          return prev + Math.random() * 10;\n        });\n      }, 200);\n      \n      // Mock OCR processing time\n      await new Promise(resolve => setTimeout(resolve, 3000));\n      \n      clearInterval(progressInterval);\n      setProcessingProgress(100);\n      \n      // Simulate OCR extraction based on document type\n      const extractedData = await extractDataFromDocument(file, documentType);\n      \n      const result: OCRResult = {\n        id: `ocr_${Date.now()}`,\n        fileName: file.name,\n        fileType: file.type,\n        extractedText: extractedData.fullText,\n        confidence: extractedData.confidence,\n        extractedData: extractedData.fields,\n        processingTime: 3.2,\n        timestamp: new Date().toISOString(),\n        status: 'completed'\n      };\n      \n      setOcrResults(prev => [result, ...prev]);\n      setSelectedResult(result);\n      \n      // Auto-generate field mappings\n      const mappings = generateFieldMappings(result, entityType);\n      setFieldMappings(mappings);\n      \n      setBanner({ status: 'success', message: `Extracted data from ${file.name} with ${Math.round(result.confidence * 100)}% confidence` });\n      setTimeout(() => setBanner(null), 4000);\n      \n      return result;\n      \n    } catch (error) {\n      const errorResult: OCRResult = {\n        id: `ocr_error_${Date.now()}`,\n        fileName: file.name,\n        fileType: file.type,\n        extractedText: '',\n        confidence: 0,\n        extractedData: {},\n        processingTime: 0,\n        timestamp: new Date().toISOString(),\n        status: 'failed',\n        errors: ['OCR processing failed: ' + (error as Error).message]\n      };\n      \n      setOcrResults(prev => [errorResult, ...prev]);\n      \n      setBanner({ status: 'error', message: 'Failed to extract data from document' });\n      setTimeout(() => setBanner(null), 4000);\n      \n      return errorResult;\n      \n    } finally {\n      setIsProcessing(false);\n      setProcessingProgress(0);\n    }\n  };\n\n  const extractDataFromDocument = async (file: File, docType: string): Promise<any> => {\n    // Mock OCR extraction based on document type\n    const mockExtractions: Record<string, any> = {\n      'certificate_incorporation': {\n        fullText: 'CERTIFICATE OF INCORPORATION\\n\\nCompany Name: TechCorp Solutions Ltd\\nRegistration Number: 2020/123456/07\\nDate of Incorporation: 15 January 2020\\nPlace of Incorporation: Johannesburg, South Africa\\nAuthorized Capital: R1,000,000\\nIssued Capital: R500,000',\n        confidence: 0.92,\n        fields: {\n          companyName: 'TechCorp Solutions Ltd',\n          registrationNumber: '2020/123456/07',\n          dateOfIncorporation: '2020-01-15',\n          placeOfIncorporation: 'Johannesburg, South Africa',\n          authorizedCapital: 'R1,000,000',\n          issuedCapital: 'R500,000'\n        }\n      },\n      'memorandum_association': {\n        fullText: 'MEMORANDUM OF ASSOCIATION\\n\\nCompany Name: TechCorp Solutions Ltd\\nRegistration Number: 2020/123456/07\\nMain Business: Software Development and IT Services\\nRegistered Address: 123 Business Street, Johannesburg, 2000',\n        confidence: 0.88,\n        fields: {\n          companyName: 'TechCorp Solutions Ltd',\n          registrationNumber: '2020/123456/07',\n          businessDescription: 'Software Development and IT Services',\n          businessAddress: '123 Business Street, Johannesburg, 2000'\n        }\n      },\n      'npo_certificate': {\n        fullText: 'NPO REGISTRATION CERTIFICATE\\n\\nOrganization Name: Community Development Foundation\\nNPO Number: 123-456\\nRegistration Date: 15 March 2019\\nOrganization Type: Non-Profit Organisation\\nMain Activities: Community Development and Education',\n        confidence: 0.90,\n        fields: {\n          organizationName: 'Community Development Foundation',\n          registrationNumber: '123-456',\n          dateOfRegistration: '2019-03-15',\n          organizationType: 'Non-Profit Organisation',\n          mainActivities: 'Community Development and Education'\n        }\n      },\n      'government_certificate': {\n        fullText: 'GOVERNMENT ENTITY CERTIFICATE\\n\\nEntity Name: Department of Social Development\\nRegistration Number: GOV-2020-001\\nEstablishment Date: 27 April 1994\\nJurisdiction: National\\nEntity Type: Government Department',\n        confidence: 0.95,\n        fields: {\n          entityName: 'Department of Social Development',\n          registrationNumber: 'GOV-2020-001',\n          establishmentDate: '1994-04-27',\n          jurisdiction: 'National',\n          entityType: 'Government Department'\n        }\n      }\n    };\n    \n    return mockExtractions[docType] || {\n      fullText: 'Document processed successfully',\n      confidence: 0.75,\n      fields: {}\n    };\n  };\n\n  const generateFieldMappings = (result: OCRResult, entityType: string): OCRFieldMapping[] => {\n    const mappings: OCRFieldMapping[] = [];\n    \n    // Map extracted data to form fields based on entity type\n    const fieldMappings: Record<string, string> = {\n      'companyName': 'companyName',\n      'organizationName': 'organizationName',\n      'entityName': 'entityName',\n      'registrationNumber': 'registrationNumber',\n      'dateOfIncorporation': 'dateOfIncorporation',\n      'dateOfRegistration': 'dateOfRegistration',\n      'establishmentDate': 'establishmentDate',\n      'placeOfIncorporation': 'placeOfIncorporation',\n      'authorizedCapital': 'authorizedCapital',\n      'issuedCapital': 'issuedCapital',\n      'businessDescription': 'businessDescription',\n      'mainActivities': 'mainActivities',\n      'businessAddress': 'businessAddress',\n      'organizationType': 'organizationType',\n      'entityType': 'entityType',\n      'jurisdiction': 'jurisdiction'\n    };\n    \n    Object.entries(result.extractedData).forEach(([key, value]) => {\n      const fieldId = fieldMappings[key];\n      if (fieldId) {\n        mappings.push({\n          fieldId,\n          fieldLabel: key.replace(/([A-Z])/g, ' $1').replace(/^./, str => str.toUpperCase()),\n          extractedValue: value,\n          confidence: result.confidence,\n          verified: false,\n          suggested: true\n        });\n      }\n    });\n    \n    return mappings;\n  };\n\n  const handleFieldMappingChange = (index: number, field: Partial<OCRFieldMapping>) => {\n    setFieldMappings(prev => prev.map((mapping, i) => \n      i === index ? { ...mapping, ...field } : mapping\n    ));\n  };\n\n  const handleApplyMappings = () => {\n    const verifiedMappings = fieldMappings.filter(mapping => mapping.verified);\n    onDataExtracted(verifiedMappings);\n    \n    setBanner({ status: 'success', message: `Applied ${verifiedMappings.length} field mappings to your form` });\n    setTimeout(() => setBanner(null), 2500);\n    \n    onReviewClose();\n  };\n\n  const getConfidenceColor = (confidence: number) => {\n    if (confidence >= 0.8) return \"green\";\n    if (confidence >= 0.6) return \"yellow\";\n    return \"red\";\n  };\n\n  const getStatusColor = (status: string) => {\n    switch (status) {\n      case 'completed': return \"green\";\n      case 'processing': return \"blue\";\n      case 'failed': return \"red\";\n      case 'reviewed': return \"purple\";\n      default: return \"gray\";\n    }\n  };\n\n  return (\n    <Box>\n      {/* OCR Processing Area */}\n      <Box p=\"6\" bg=\"white\" borderRadius=\"lg\" boxShadow=\"sm\" mb=\"6\">\n        <VStack gap=\"4\" align=\"stretch\">\n          <HStack justify=\"space-between\">\n            <VStack align=\"start\" gap=\"1\">\n              <Text fontSize=\"lg\" fontWeight=\"semibold\" color=\"gray.800\">\n                OCR Document Processing\n              </Text>\n              <Text fontSize=\"sm\" color=\"gray.600\">\n                Extract data automatically from your documents\n              </Text>\n            </VStack>\n            \n            <Badge colorScheme=\"blue\" variant=\"subtle\">\n              {entityType}  {documentType}\n            </Badge>\n          </HStack>\n          \n          {isProcessing ? (\n            <Box>\n              <HStack gap=\"3\" mb=\"3\">\n                <Spinner size=\"sm\" color=\"blue.500\" />\n                <Text fontSize=\"sm\" color=\"blue.600\">\n                  Processing document with OCR...\n                </Text>\n              </HStack>\n              <Box h=\"2\" bg=\"gray.200\" borderRadius=\"full\" overflow=\"hidden\">\n                <Box h=\"2\" bg=\"blue.500\" width={`${Math.round(processingProgress)}%`} />\n              </Box>\n            </Box>\n          ) : (\n            <FileUpload\n              onFileUpload={async (file) => {\n                const result = await processDocumentWithOCR(file);\n                return result.extractedText;\n              }}\n              acceptedTypes={acceptedTypes}\n              maxSize={maxFileSize}\n              label=\"Upload Document for OCR Processing\"\n              description=\"Upload a document to automatically extract form data\"\n              onError={async (message, title) => {\n                await SweetAlert.error(title || 'File Upload Error', message);\n              }}\n            />\n          )}\n        </VStack>\n      </Box>\n\n      {banner && (\n        <Box p=\"3\" bg={banner.status === 'success' ? 'green.50' : 'red.50'} border=\"1px\" borderColor={banner.status === 'success' ? 'green.200' : 'red.200'} borderRadius=\"md\" mb=\"4\">\n          <Text fontSize=\"sm\" color={banner.status === 'success' ? 'green.700' : 'red.700'}>{banner.message}</Text>\n        </Box>\n      )}\n\n      {/* OCR Results */}\n      {ocrResults.length > 0 && (\n        <Box p=\"6\" bg=\"white\" borderRadius=\"lg\" boxShadow=\"sm\" mb=\"6\">\n          <VStack gap=\"4\" align=\"stretch\">\n            <HStack justify=\"space-between\">\n              <Text fontSize=\"lg\" fontWeight=\"semibold\" color=\"gray.800\">\n                OCR Results\n              </Text>\n              <Badge colorScheme=\"blue\" variant=\"subtle\">\n                {ocrResults.length} processed\n              </Badge>\n            </HStack>\n            \n            <SimpleGrid columns={{ base: 1, md: 2, lg: 3 }} gap=\"4\">\n              {ocrResults.map((result) => (\n                <Box\n                  key={result.id}\n                  p=\"4\"\n                  border=\"1px\"\n                  borderColor=\"gray.200\"\n                  borderRadius=\"md\"\n                  bg=\"gray.50\"\n                  cursor=\"pointer\"\n                  _hover={{ bg: \"gray.100\" }}\n                  onClick={() => {\n                    setSelectedResult(result);\n                    const mappings = generateFieldMappings(result, entityType);\n                    setFieldMappings(mappings);\n                    onReviewOpen();\n                  }}\n                >\n                  <VStack gap=\"3\" align=\"stretch\">\n                    <HStack justify=\"space-between\">\n                      <HStack gap=\"2\">\n                        <Icon as={FiFileText} color=\"blue.500\" />\n                        <Text fontSize=\"sm\" fontWeight=\"medium\" color=\"gray.800\">\n                          {result.fileName}\n                        </Text>\n                      </HStack>\n                      <Badge\n                        colorScheme={getStatusColor(result.status)}\n                        variant=\"subtle\"\n                        fontSize=\"xs\"\n                      >\n                        {result.status}\n                      </Badge>\n                    </HStack>\n                    \n                    <HStack justify=\"space-between\">\n                      <Text fontSize=\"xs\" color=\"gray.500\">\n                        Confidence: {Math.round(result.confidence * 100)}%\n                      </Text>\n                      <Badge\n                        colorScheme={getConfidenceColor(result.confidence)}\n                        variant=\"subtle\"\n                        fontSize=\"xs\"\n                      >\n                        {result.confidence >= 0.8 ? \"High\" : result.confidence >= 0.6 ? \"Medium\" : \"Low\"}\n                      </Badge>\n                    </HStack>\n                    \n                    <Text fontSize=\"xs\" color=\"gray.600\">\n                      Processed: {new Date(result.timestamp).toLocaleString()}\n                    </Text>\n                    \n                    <HStack gap=\"2\">\n                      <Button\n                        size=\"xs\"\n                        variant=\"outline\"\n                        onClick={(e) => {\n                          e.stopPropagation();\n                          setSelectedResult(result);\n                          const mappings = generateFieldMappings(result, entityType);\n                          setFieldMappings(mappings);\n                          onReviewOpen();\n                        }}\n                      >\n                        <Icon as={FiEye} mr=\"1\" />\n                        Review\n                      </Button>\n                      <Button\n                        size=\"xs\"\n                        variant=\"outline\"\n                        onClick={(e) => {\n                          e.stopPropagation();\n                          // Download extracted text\n                        }}\n                      >\n                        <Icon as={FiDownload} mr=\"1\" />\n                        Download\n                      </Button>\n                    </HStack>\n                  </VStack>\n                </Box>\n              ))}\n            </SimpleGrid>\n          </VStack>\n        </Box>\n      )}\n\n      {/* OCR Review Modal */}\n      <DialogRoot open={isReviewOpen} onOpenChange={(e) => (e.open ? onReviewOpen() : onReviewClose())}>\n        <DialogContent maxW=\"xl\">\n          <DialogHeader>\n            <DialogTitle>\n              <HStack gap=\"2\">\n                <Icon as={FiEye} color=\"blue.500\" />\n                <Text>Review Extracted Data</Text>\n              </HStack>\n            </DialogTitle>\n          </DialogHeader>\n          <DialogBody>\n            {selectedResult && (\n              <VStack gap=\"6\" align=\"stretch\">\n                {/* Document Info */}\n                <Box p=\"4\" bg=\"blue.50\" borderRadius=\"md\" border=\"1px\" borderColor=\"blue.200\">\n                  <VStack gap=\"2\" align=\"stretch\">\n                    <HStack justify=\"space-between\">\n                      <Text fontSize=\"sm\" fontWeight=\"medium\" color=\"blue.700\">\n                        {selectedResult.fileName}\n                      </Text>\n                      <Badge\n                        colorScheme={getConfidenceColor(selectedResult.confidence)}\n                        variant=\"subtle\"\n                      >\n                        {Math.round(selectedResult.confidence * 100)}% Confidence\n                      </Badge>\n                    </HStack>\n                    <Text fontSize=\"xs\" color=\"blue.600\">\n                      Processing time: {selectedResult.processingTime}s\n                    </Text>\n                  </VStack>\n                </Box>\n                \n                {/* Extracted Text Preview */}\n                <Box>\n                  <Text fontSize=\"sm\" fontWeight=\"medium\" color=\"gray.700\" mb=\"2\">\n                    Extracted Text:\n                  </Text>\n                  <Box\n                    p=\"3\"\n                    bg=\"gray.50\"\n                    borderRadius=\"md\"\n                    border=\"1px\"\n                    borderColor=\"gray.200\"\n                    maxH=\"200px\"\n                    overflowY=\"auto\"\n                  >\n                    <Text fontSize=\"xs\" color=\"gray.600\" whiteSpace=\"pre-wrap\">\n                      {selectedResult.extractedText}\n                    </Text>\n                  </Box>\n                </Box>\n                \n                {/* Field Mappings */}\n                <Box>\n                  <Text fontSize=\"sm\" fontWeight=\"medium\" color=\"gray.700\" mb=\"3\">\n                    Field Mappings:\n                  </Text>\n                  <VStack gap=\"3\" align=\"stretch\">\n                    {fieldMappings.map((mapping, index) => (\n                      <Box\n                        key={index}\n                        p=\"3\"\n                        border=\"1px\"\n                        borderColor=\"gray.200\"\n                        borderRadius=\"md\"\n                        bg=\"white\"\n                      >\n                        <HStack gap=\"3\" align=\"start\">\n                          <input\n                            type=\"checkbox\"\n                            checked={mapping.verified}\n                            onChange={(e) => handleFieldMappingChange(index, { verified: (e.target as HTMLInputElement).checked })}\n                          />\n                          \n                          <VStack align=\"start\" gap=\"1\" flex=\"1\">\n                            <HStack gap=\"2\">\n                              <Text fontSize=\"sm\" fontWeight=\"medium\" color=\"gray.800\">\n                                {mapping.fieldLabel}\n                              </Text>\n                              <Badge\n                                colorScheme={getConfidenceColor(mapping.confidence)}\n                                variant=\"subtle\"\n                                fontSize=\"xs\"\n                              >\n                                {Math.round(mapping.confidence * 100)}%\n                              </Badge>\n                              {mapping.suggested && (\n                                <Badge colorScheme=\"blue\" variant=\"subtle\" fontSize=\"xs\">\n                                  Suggested\n                                </Badge>\n                              )}\n                            </HStack>\n                            \n                            <input\n                              value={mapping.extractedValue as any}\n                              onChange={(e) => handleFieldMappingChange(index, { extractedValue: (e.target as HTMLInputElement).value })}\n                              style={{ width: '100%', padding: '6px', borderRadius: 6, border: '1px solid var(--chakra-colors-gray-200)' }}\n                            />\n                          </VStack>\n                        </HStack>\n                      </Box>\n                    ))}\n                  </VStack>\n                </Box>\n              </VStack>\n            )}\n          </DialogBody>\n          <DialogFooter>\n            <HStack gap=\"2\">\n              <Button variant=\"outline\" onClick={onReviewClose}>\n                Cancel\n              </Button>\n              <Button\n                colorScheme=\"blue\"\n                onClick={handleApplyMappings}\n                disabled={fieldMappings.filter(m => m.verified).length === 0}\n              >\n                <Icon as={FiSave} mr=\"2\" />\n                Apply Selected Mappings ({fieldMappings.filter(m => m.verified).length})\n              </Button>\n            </HStack>\n          </DialogFooter>\n          <DialogCloseTrigger />\n        </DialogContent>\n      </DialogRoot>\n    </Box>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 6119, "column": 0}, "map": {"version":3,"sources":["file:///Users/mukurusystemsadministrator/Desktop/onboarding_kyc%20copy/partner/src/lib/auth/session.ts"],"sourcesContent":["// SECURITY: Tokens are now stored server-side in Redis via NextAuth\n// This file provides compatibility functions that use NextAuth session instead of localStorage\n// All token access is handled server-side by the API proxy\n\nimport { signOut } from \"next-auth/react\";\n\nexport type AuthUser = {\n  sub?: string;\n  name: string;\n  email?: string;\n  givenName?: string;\n  familyName?: string;\n};\n\n/**\n * Check if user is authenticated using NextAuth session\n * Note: This is a synchronous check that may not be accurate during initial load\n * For accurate checks, use useSession() hook in React components\n */\nexport function isAuthenticated(): boolean {\n  if (typeof window === 'undefined') return false;\n  \n  // Check if session cookie exists (basic check)\n  // For accurate authentication status, use useSession() hook\n  const cookies = document.cookie.split(';');\n  const hasSessionCookie = cookies.some(cookie => \n    cookie.trim().startsWith('next-auth.session-token=') || \n    cookie.trim().startsWith('__Secure-next-auth.session-token=')\n  );\n  \n  return hasSessionCookie;\n}\n\n/**\n * SECURITY: Tokens are stored server-side in Redis\n * This function returns null - tokens should never be accessed from the frontend\n * The API proxy automatically injects tokens from Redis based on the session cookie\n */\nexport async function getAccessToken(): Promise<string | null> {\n  // SECURITY: Do not return tokens from frontend\n  // Tokens are stored server-side in Redis and injected by the proxy\n  console.warn('[SECURITY] getAccessToken() called - tokens are server-side only. Use API proxy instead.');\n  return null;\n}\n\n/**\n * SECURITY: Token refresh is handled server-side by NextAuth\n * This function is deprecated - NextAuth handles token refresh automatically\n */\nexport async function refreshToken(): Promise<boolean> {\n  // Token refresh is handled server-side by NextAuth\n  // No action needed from frontend\n  console.warn('[SECURITY] refreshToken() called - token refresh is handled server-side by NextAuth');\n  return false;\n}\n\n/**\n * Get authenticated user from NextAuth session\n * Note: This is a synchronous function that may not have accurate data during initial load\n * For accurate user data in React components, use useSession() hook from next-auth/react\n * or useAuth() hook from AuthContext\n */\nexport function getAuthUser(): AuthUser {\n  if (typeof window === 'undefined') {\n    return { name: 'User' };\n  }\n\n  // Try to get user from NextAuth session via fetch (async but we return sync fallback)\n  // For accurate data, components should use useSession() hook\n  try {\n    // Check if session cookie exists\n    const cookies = document.cookie.split(';');\n    const hasSessionCookie = cookies.some(cookie => \n      cookie.trim().startsWith('next-auth.session-token=') || \n      cookie.trim().startsWith('__Secure-next-auth.session-token=')\n    );\n    \n    if (!hasSessionCookie) {\n      return { name: 'User' };\n    }\n    \n    // Try to get cached session data from sessionStorage (if available)\n    // This is a fallback - components should use useSession() hook\n    const sessionData = sessionStorage.getItem('nextauth.session.user');\n    if (sessionData) {\n      try {\n        const user = JSON.parse(sessionData);\n        return {\n          sub: user.id || user.email,\n          name: user.name || user.email || 'User',\n          email: user.email,\n        };\n      } catch {\n        // Invalid session data\n      }\n    }\n  } catch {\n    // Session storage not available or error\n  }\n\n  // Fallback: return default user\n  // Components should use useSession() hook or useAuth() for accurate data\n  return {\n    name: 'User',\n  };\n}\n\n/**\n * Clear session and sign out using NextAuth\n */\nexport function clearSession(): void {\n  if (typeof window === 'undefined') return;\n  \n  // SECURITY: Clear any legacy localStorage tokens (shouldn't exist, but clean up just in case)\n  // Tokens are now stored server-side in Redis, but we clean up localStorage for safety\n  try {\n    localStorage.removeItem('access_token');\n    localStorage.removeItem('refresh_token');\n    localStorage.removeItem('id_token');\n    localStorage.removeItem('token_expires_at');\n  } catch {\n    // Ignore errors if localStorage is not available\n  }\n  \n  // Clear session storage\n  sessionStorage.removeItem('nextauth.session.user');\n  \n  // Sign out using NextAuth (this will clear the session cookie)\n  signOut({ callbackUrl: '/auth/login' });\n}\n\n/**\n * Redirect to login page\n */\nfunction redirectToLogin(): void {\n  if (typeof window === 'undefined') return;\n  \n  // Don't redirect if already on auth pages\n  if (window.location.pathname.startsWith('/auth/')) return;\n  \n  // Use replace to avoid adding to history\n  try {\n    window.location.replace('/auth/login');\n  } catch {\n    window.location.href = '/auth/login';\n  }\n}\n\n/**\n * Build logout URL for Keycloak\n * Note: NextAuth handles logout, but this is kept for compatibility\n */\nexport function buildLogoutUrl(postLogoutRedirectUri: string): string {\n  // NextAuth handles logout, but if needed for Keycloak direct logout:\n  const keycloakIssuer = process.env.NEXT_PUBLIC_KEYCLOAK_ISSUER || 'https://keycloak-staging.app-stg.mukuru.io/realms/mukuru';\n  const base = `${keycloakIssuer}/protocol/openid-connect/logout`;\n  const url = new URL(base);\n  url.searchParams.set('post_logout_redirect_uri', postLogoutRedirectUri);\n  return url.toString();\n}\n\n/**\n * Logout user using NextAuth\n */\nexport function logout(postLogoutRedirectUri: string = '/auth/login') {\n  // Use NextAuth signOut which handles session cleanup\n  signOut({ callbackUrl: postLogoutRedirectUri });\n}\n\n/**\n * Get user initials from name\n */\nexport function getInitials(name: string): string {\n  const parts = name.trim().split(/\\s+/).filter(Boolean);\n  if (parts.length === 0) return \"\";\n  if (parts.length === 1) return parts[0].slice(0, 2).toUpperCase();\n  return (parts[0][0] + parts[1][0]).toUpperCase();\n}\n\n/**\n * DEPRECATED: Token expiration check is handled server-side\n * This function is kept for compatibility but always returns false\n */\nexport function isTokenExpired(bufferSeconds: number = 120): boolean {\n  // Token expiration is handled server-side by NextAuth\n  // This function is deprecated\n  console.warn('[DEPRECATED] isTokenExpired() - token expiration is handled server-side');\n  return false;\n}\n"],"names":[],"mappings":"AAAA,oEAAoE;AACpE,+FAA+F;AAC/F,2DAA2D;;;;;;;;;;;;;;;;;;;;;AAE3D;;AAeO,SAAS;IACd,wCAAmC,OAAO;;;IAE1C,+CAA+C;IAC/C,4DAA4D;IAC5D,MAAM;IACN,MAAM;AAMR;AAOO,eAAe;IACpB,+CAA+C;IAC/C,mEAAmE;IACnE,QAAQ,IAAI,CAAC;IACb,OAAO;AACT;AAMO,eAAe;IACpB,mDAAmD;IACnD,iCAAiC;IACjC,QAAQ,IAAI,CAAC;IACb,OAAO;AACT;AAQO,SAAS;IACd,wCAAmC;QACjC,OAAO;YAAE,MAAM;QAAO;IACxB;;;AAwCF;AAKO,SAAS;IACd,wCAAmC;;;AAkBrC;AAEA;;CAEC,GACD,SAAS;IACP,wCAAmC;;;AAWrC;AAMO,SAAS,eAAe,qBAA6B;IAC1D,qEAAqE;IACrE,MAAM,iBAAiB,QAAQ,GAAG,CAAC,2BAA2B,IAAI;IAClE,MAAM,OAAO,GAAG,eAAe,+BAA+B,CAAC;IAC/D,MAAM,MAAM,IAAI,IAAI;IACpB,IAAI,YAAY,CAAC,GAAG,CAAC,4BAA4B;IACjD,OAAO,IAAI,QAAQ;AACrB;AAKO,SAAS,OAAO,wBAAgC,aAAa;IAClE,qDAAqD;IACrD,IAAA,yJAAO,EAAC;QAAE,aAAa;IAAsB;AAC/C;AAKO,SAAS,YAAY,IAAY;IACtC,MAAM,QAAQ,KAAK,IAAI,GAAG,KAAK,CAAC,OAAO,MAAM,CAAC;IAC9C,IAAI,MAAM,MAAM,KAAK,GAAG,OAAO;IAC/B,IAAI,MAAM,MAAM,KAAK,GAAG,OAAO,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,GAAG,GAAG,WAAW;IAC/D,OAAO,CAAC,KAAK,CAAC,EAAE,CAAC,EAAE,GAAG,KAAK,CAAC,EAAE,CAAC,EAAE,EAAE,WAAW;AAChD;AAMO,SAAS,eAAe,gBAAwB,GAAG;IACxD,sDAAsD;IACtD,8BAA8B;IAC9B,QAAQ,IAAI,CAAC;IACb,OAAO;AACT"}},
    {"offset": {"line": 6216, "column": 0}, "map": {"version":3,"sources":["file:///Users/mukurusystemsadministrator/Desktop/onboarding_kyc%20copy/partner/src/services/entityConfigApi.ts"],"sourcesContent":["// SECURITY: All API calls go through the proxy which injects tokens from Redis\n// Use the proxy endpoint instead of direct API calls\nconst ENTITY_CONFIG_API_BASE_URL = typeof window !== 'undefined' \n  ? '/api/proxy' // Use proxy endpoint in browser (tokens injected server-side)\n  : (process.env.NEXT_PUBLIC_ENTITY_CONFIG_API_BASE_URL || 'http://localhost:8003');\n\n// Types matching the backend DTOs\nexport interface EntityType {\n  id: string;\n  code: string;\n  displayName: string;\n  description: string;\n  icon?: string;\n  isActive: boolean;\n  createdAt: string;\n  updatedAt: string;\n  requirements?: EntityTypeRequirement[];\n}\n\nexport interface EntityTypeRequirement {\n  id: string;\n  requirementId: string;\n  isRequired: boolean;\n  displayOrder: number;\n  requirement?: Requirement;\n}\n\nexport interface Requirement {\n  id: string;\n  code: string;\n  displayName: string;\n  description: string;\n  type: string;\n  fieldType: string;\n  validationRules?: string;\n  helpText?: string;\n  isActive: boolean;\n  createdAt: string;\n  updatedAt: string;\n  options?: RequirementOption[];\n}\n\nexport interface RequirementOption {\n  id: string;\n  value: string;\n  displayText: string;\n  displayOrder: number;\n}\n\n// Helper function to convert snake_case to camelCase\nfunction snakeToCamel(str: string): string {\n  return str.replace(/_([a-z])/g, (_, letter) => letter.toUpperCase());\n}\n\n// Recursively transform object keys from snake_case to camelCase\nfunction transformKeys(obj: any): any {\n  if (obj === null || obj === undefined) {\n    return obj;\n  }\n  \n  if (Array.isArray(obj)) {\n    return obj.map(transformKeys);\n  }\n  \n  if (typeof obj === 'object' && obj.constructor === Object) {\n    const transformed: any = {};\n    for (const [key, value] of Object.entries(obj)) {\n      const camelKey = snakeToCamel(key);\n      transformed[camelKey] = transformKeys(value);\n    }\n    return transformed;\n  }\n  \n  return obj;\n}\n\nclass EntityConfigApiService {\n  private async request<T>(endpoint: string, options?: RequestInit): Promise<T> {\n    // Use direct /api/v1 path - gateway routing can be configured separately if needed\n    // In browser, use proxy endpoint; server-side can use direct URL\n    const basePath = '/api/v1';\n    const url = typeof window !== 'undefined' \n      ? `${ENTITY_CONFIG_API_BASE_URL}${basePath}${endpoint}` // Proxy endpoint\n      : `${ENTITY_CONFIG_API_BASE_URL}${basePath}${endpoint}`; // Direct URL (server-side)\n    \n    const headers: HeadersInit = {\n      'Content-Type': 'application/json',\n    };\n\n    try {\n      // Create a timeout promise\n      const timeoutPromise = new Promise<never>((_, reject) => {\n        setTimeout(() => reject(new Error('Request timeout')), 10000);\n      });\n\n      // SECURITY: Include credentials to send session cookie (browser only)\n      // Proxy will automatically inject Authorization header from Redis\n      const fetchPromise = fetch(url, {\n        ...options,\n        credentials: typeof window !== 'undefined' ? 'include' : undefined, // Include session cookie in browser\n        headers: {\n          ...headers,\n          ...options?.headers,\n        },\n      });\n\n      const response = await Promise.race([fetchPromise, timeoutPromise]);\n\n      if (!response.ok) {\n        const errorText = await response.text();\n        throw new Error(`Entity Config API request failed: ${response.status} ${response.statusText} - ${errorText}`);\n      }\n\n      // Handle 204 No Content responses\n      if (response.status === 204) {\n        return null as T;\n      }\n\n      const json = await response.json();\n      // Transform snake_case keys to camelCase\n      return transformKeys(json) as T;\n    } catch (error) {\n      if (error instanceof TypeError || (error instanceof Error && error.message.includes('timeout'))) {\n        throw new Error('Unable to connect to Entity Configuration service');\n      }\n      throw error;\n    }\n  }\n\n  // Entity Types endpoints\n  async getEntityTypes(includeInactive = false, includeRequirements = false): Promise<EntityType[]> {\n    const params = new URLSearchParams();\n    if (includeInactive) params.append('includeInactive', 'true');\n    if (includeRequirements) params.append('includeRequirements', 'true');\n    \n    const queryString = params.toString();\n    return this.request<EntityType[]>(`/entity-types${queryString ? `?${queryString}` : ''}`);\n  }\n\n  async getEntityType(id: string): Promise<EntityType> {\n    return this.request<EntityType>(`/entity-types/${id}`);\n  }\n\n  async getEntityTypeByCode(code: string, includeRequirements = true): Promise<EntityType | null> {\n    try {\n      const allTypes = await this.getEntityTypes(false, includeRequirements);\n      return allTypes.find(et => et.code.toLowerCase() === code.toLowerCase()) || null;\n    } catch (error) {\n      console.error('Error fetching entity type by code:', error);\n      return null;\n    }\n  }\n\n  // Requirements endpoints\n  async getRequirements(includeInactive = false): Promise<Requirement[]> {\n    const params = includeInactive ? '?includeInactive=true' : '';\n    return this.request<Requirement[]>(`/requirements${params}`);\n  }\n\n  async getRequirement(id: string): Promise<Requirement> {\n    return this.request<Requirement>(`/requirements/${id}`);\n  }\n}\n\nexport const entityConfigApiService = new EntityConfigApiService();\n\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 6327, "column": 0}, "map": {"version":3,"sources":["file:///Users/mukurusystemsadministrator/Desktop/onboarding_kyc%20copy/partner/src/lib/documentUpload.ts"],"sourcesContent":["/**\n * Document Upload Service\n * \n * According to the backend, files should be uploaded to:\n * - Endpoint: /api/v1/documents/upload (or via proxy /api/proxy/api/v1/documents/upload)\n * - Storage: MinIO object storage (not Google Drive)\n * - Required: CaseId, PartnerId, DocumentType, File (multipart form data)\n * \n * Note: Files cannot be uploaded until a case is created, so uploads should happen\n * after case creation, not during form filling.\n */\n\n// Helper to generate PartnerId from email using MD5 (matches backend algorithm)\nfunction generatePartnerIdFromEmail(email: string): string {\n  if (!email) return '';\n  \n  // Normalize email to lowercase (matches backend)\n  const normalizedEmail = email.toLowerCase().trim();\n  \n  // Use Web Crypto API to generate MD5 hash\n  // Note: Web Crypto API doesn't support MD5 directly, so we use a workaround\n  // For production, consider using a library like crypto-js or implementing MD5\n  // For now, we'll use a simple hash that's deterministic\n  let hash = 0;\n  for (let i = 0; i < normalizedEmail.length; i++) {\n    const char = normalizedEmail.charCodeAt(i);\n    hash = ((hash << 5) - hash) + char;\n    hash = hash & hash; // Convert to 32-bit integer\n  }\n  \n  // Convert to GUID format (this is a simplified version)\n  // In production, use proper MD5 implementation\n  const hex = Math.abs(hash).toString(16).padStart(32, '0');\n  return `${hex.substring(0, 8)}-${hex.substring(8, 12)}-${hex.substring(12, 16)}-${hex.substring(16, 20)}-${hex.substring(20, 32)}`;\n}\n\n// Better implementation using crypto.subtle (SHA-256) and converting to GUID format\n// This is more secure but won't match MD5 exactly - for exact match, use crypto-js MD5\nasync function generatePartnerIdFromEmailMD5(email: string): Promise<string> {\n  if (!email) return '';\n  \n  const normalizedEmail = email.toLowerCase().trim();\n  \n  // Use crypto.subtle for hashing (SHA-256, then take first 16 bytes for GUID)\n  const encoder = new TextEncoder();\n  const data = encoder.encode(normalizedEmail);\n  const hashBuffer = await crypto.subtle.digest('SHA-256', data);\n  const hashArray = Array.from(new Uint8Array(hashBuffer));\n  \n  // Take first 16 bytes and format as GUID\n  const guidBytes = hashArray.slice(0, 16);\n  const hex = guidBytes.map(b => b.toString(16).padStart(2, '0')).join('');\n  return `${hex.substring(0, 8)}-${hex.substring(8, 12)}-${hex.substring(12, 16)}-${hex.substring(16, 20)}-${hex.substring(20, 32)}`;\n}\n\nexport enum DocumentType {\n  PassportCopy = 1,\n  DriversLicense = 2,\n  NationalId = 3,\n  ProofOfAddress = 4,\n  BankStatement = 5,\n  TaxDocument = 6,\n  BusinessRegistration = 7,\n  ArticlesOfIncorporation = 8,\n  ShareholderRegistry = 9,\n  FinancialStatements = 10,\n  Other = 99\n}\n\nexport interface FileUploadData {\n  fileName: string;\n  fileSize: number;\n  fileType: string;\n  googleDriveUrl?: string; // Legacy - will be replaced with document service\n  uploadedAt?: string;\n  fileId?: string;\n  // For actual upload, we need the File object\n  file?: File;\n}\n\nexport interface UploadDocumentResult {\n  documentId: string;\n  documentNumber: string;\n  wasDuplicate: boolean;\n  existingDocumentId?: string;\n  storageKey: string;\n}\n\n/**\n * Maps requirement codes to DocumentType enum\n * This helps determine the document type based on the field/requirement code\n */\nexport function mapRequirementCodeToDocumentType(requirementCode: string): DocumentType {\n  const code = requirementCode.toLowerCase();\n  \n  if (code.includes('passport')) return DocumentType.PassportCopy;\n  if (code.includes('drivers') || code.includes('license')) return DocumentType.DriversLicense;\n  if (code.includes('national_id') || code.includes('nationalid') || code.includes('id_number')) return DocumentType.NationalId;\n  if (code.includes('address') || code.includes('proof_of_address')) return DocumentType.ProofOfAddress;\n  if (code.includes('bank') || code.includes('statement')) return DocumentType.BankStatement;\n  if (code.includes('tax')) return DocumentType.TaxDocument;\n  if (code.includes('registration') || code.includes('business_registration')) return DocumentType.BusinessRegistration;\n  if (code.includes('articles') || code.includes('incorporation')) return DocumentType.ArticlesOfIncorporation;\n  if (code.includes('shareholder') || code.includes('share_register')) return DocumentType.ShareholderRegistry;\n  if (code.includes('financial') || code.includes('statement')) return DocumentType.FinancialStatements;\n  \n  return DocumentType.Other;\n}\n\n/**\n * Uploads a file to the Document Service API\n * \n * @param caseId - The case GUID (not case number)\n * @param partnerId - The partner GUID\n * @param file - The File object to upload\n * @param documentType - The document type enum value\n * @param description - Optional description\n * @param uploadedBy - Email of the user uploading (defaults to 'system')\n * @returns Upload result with document ID and storage key\n */\nexport async function uploadFileToDocumentService(\n  caseId: string,\n  partnerId: string,\n  file: File,\n  documentType: DocumentType = DocumentType.Other,\n  description?: string,\n  uploadedBy?: string\n): Promise<UploadDocumentResult> {\n  const formData = new FormData();\n  \n  // Append file\n  formData.append('file', file);\n  \n  // Append required fields\n  formData.append('caseId', caseId);\n  formData.append('partnerId', partnerId);\n  formData.append('type', documentType.toString());\n  \n  // Append optional fields\n  if (description) formData.append('description', description);\n  if (uploadedBy) formData.append('uploadedBy', uploadedBy);\n  \n  // Upload via proxy to document service\n  const response = await fetch('/api/proxy/api/v1/documents/upload', {\n    method: 'POST',\n    body: formData,\n    // Don't set Content-Type header - browser will set it with boundary for multipart/form-data\n    headers: {\n      ...(uploadedBy ? {\n        'X-User-Email': uploadedBy,\n        'X-User-Name': uploadedBy,\n        'X-User-Role': 'Applicant'\n      } : {})\n    }\n  });\n  \n  if (!response.ok) {\n    const errorText = await response.text();\n    throw new Error(`Document upload failed: ${response.status} - ${errorText}`);\n  }\n  \n  const result = await response.json();\n  return {\n    documentId: result.documentId || result.id,\n    documentNumber: result.documentNumber || '',\n    wasDuplicate: result.wasDuplicate || false,\n    existingDocumentId: result.existingDocumentId,\n    storageKey: result.storageKey || ''\n  };\n}\n\n/**\n * Uploads multiple files to the Document Service\n * \n * @param caseId - The case GUID\n * @param partnerId - The partner GUID\n * @param files - Array of files with their metadata\n * @param uploadedBy - Email of the user uploading\n * @returns Array of upload results\n */\nexport async function uploadFilesToDocumentService(\n  caseId: string,\n  partnerId: string,\n  files: Array<{ file: File; requirementCode?: string; description?: string }>,\n  uploadedBy?: string\n): Promise<Array<{ requirementCode?: string; result: UploadDocumentResult; error?: string }>> {\n  const uploadPromises = files.map(async ({ file, requirementCode, description }) => {\n    try {\n      const documentType = requirementCode \n        ? mapRequirementCodeToDocumentType(requirementCode)\n        : DocumentType.Other;\n      \n      const result = await uploadFileToDocumentService(\n        caseId,\n        partnerId,\n        file,\n        documentType,\n        description || file.name,\n        uploadedBy\n      );\n      \n      return { requirementCode, result };\n    } catch (error) {\n      const errorMessage = error instanceof Error ? error.message : 'Unknown error';\n      console.error(`Failed to upload file ${file.name}:`, errorMessage);\n      return { requirementCode, result: {} as UploadDocumentResult, error: errorMessage };\n    }\n  });\n  \n  return Promise.all(uploadPromises);\n}\n\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 6472, "column": 0}, "map": {"version":3,"sources":["file:///Users/mukurusystemsadministrator/Desktop/onboarding_kyc%20copy/partner/src/services/integrationService.ts"],"sourcesContent":["/**\n * Integration Service for syncing application progress with backend services\n * Handles communication with Checklist and Work-Queue services\n * SECURITY: All API calls go through the proxy which injects tokens from Redis\n */\n\nconst CHECKLIST_API_BASE_URL = typeof window !== 'undefined' \n  ? '/api/proxy' // Use proxy endpoint in browser (tokens injected server-side)\n  : (process.env.NEXT_PUBLIC_CHECKLIST_API_BASE_URL || 'http://localhost:8093');\n  \nconst WORK_QUEUE_API_BASE_URL = typeof window !== 'undefined' \n  ? '/api/proxy' // Use proxy endpoint in browser (tokens injected server-side)\n  : (process.env.NEXT_PUBLIC_WORK_QUEUE_API_BASE_URL || 'http://localhost:8094');\n\nexport interface ChecklistItemUpdate {\n  checklistId: string;\n  itemCode: string;\n  notes?: string;\n}\n\nexport interface WorkQueueUpdate {\n  applicationId: string;\n  status?: string;\n  progress?: number;\n  notes?: string;\n}\n\nclass IntegrationService {\n  private async request<T>(\n    baseUrl: string,\n    endpoint: string,\n    options?: RequestInit\n  ): Promise<T> {\n    // In browser, use proxy endpoint; server-side can use direct URL\n    const url = typeof window !== 'undefined' \n      ? `${baseUrl}${endpoint}` // Proxy endpoint\n      : `${baseUrl}${endpoint}`; // Direct URL (server-side)\n    \n    const headers: HeadersInit = {\n      'Content-Type': 'application/json',\n      ...options?.headers,\n    };\n\n    try {\n      // SECURITY: Include credentials to send session cookie (browser only)\n      // Proxy will automatically inject Authorization header from Redis\n      const response = await fetch(url, {\n        ...options,\n        credentials: typeof window !== 'undefined' ? 'include' : undefined, // Include session cookie in browser\n        headers,\n      });\n\n      if (!response.ok) {\n        const errorText = await response.text();\n        throw new Error(\n          `Integration API request failed: ${response.status} ${response.statusText} - ${errorText}`\n        );\n      }\n\n      if (response.status === 204) {\n        return null as T;\n      }\n\n      return response.json();\n    } catch (error) {\n      if (error instanceof TypeError) {\n        throw new Error('Unable to connect to integration service');\n      }\n      throw error;\n    }\n  }\n\n  /**\n   * Mark a checklist item as completed\n   */\n  async completeChecklistItem(\n    checklistId: string,\n    itemId: string,\n    completedBy: string,\n    notes?: string\n  ): Promise<void> {\n    await this.request<void>(\n      CHECKLIST_API_BASE_URL,\n      `/api/v1/checklists/${checklistId}/items/${itemId}/complete`,\n      {\n        method: 'POST',\n        body: JSON.stringify({\n          completedBy,\n          notes,\n        }),\n      }\n    );\n  }\n\n  /**\n   * Get checklist by case ID\n   */\n  async getChecklistByCase(caseId: string): Promise<any> {\n    return this.request<any>(\n      CHECKLIST_API_BASE_URL,\n      `/api/v1/checklists/by-case/${caseId}`\n    );\n  }\n\n  /**\n   * Update work queue item status/progress\n   */\n  async updateWorkQueueItem(\n    applicationId: string,\n    update: Partial<WorkQueueUpdate>\n  ): Promise<void> {\n    await this.request<void>(\n      WORK_QUEUE_API_BASE_URL,\n      `/api/v1/workqueue/items/by-application/${applicationId}`,\n      {\n        method: 'PATCH',\n        body: JSON.stringify(update),\n      }\n    );\n  }\n\n  /**\n   * Get work item by application ID\n   */\n  async getWorkItemByApplication(applicationId: string): Promise<any> {\n    return this.request<any>(\n      WORK_QUEUE_API_BASE_URL,\n      `/api/v1/workqueue/items/by-application/${applicationId}`\n    );\n  }\n}\n\nexport const integrationService = new IntegrationService();\n\n"],"names":[],"mappings":"AAAA;;;;CAIC;;;;AAED,MAAM,yBAAyB,sCAC3B,wBAAa,8DAA8D;GAC1E,QAAQ,GAAG,CAAC,kCAAkC,IAAI;AAEvD,MAAM,0BAA0B,sCAC5B,wBAAa,8DAA8D;GAC1E,QAAQ,GAAG,CAAC,mCAAmC,IAAI;AAexD,MAAM;IACJ,MAAc,QACZ,OAAe,EACf,QAAgB,EAChB,OAAqB,EACT;QACZ,iEAAiE;QACjE,MAAM,MAAM,sCACR,wBAAwB,iBAAiB;WACzC,GAAG,UAAU,UAAU,EAAE,2BAA2B;QAExD,MAAM,UAAuB;YAC3B,gBAAgB;YAChB,GAAG,SAAS,OAAO;QACrB;QAEA,IAAI;YACF,sEAAsE;YACtE,kEAAkE;YAClE,MAAM,WAAW,MAAM,MAAM,KAAK;gBAChC,GAAG,OAAO;gBACV,aAAa,sCAAgC,0BAAY;gBACzD;YACF;YAEA,IAAI,CAAC,SAAS,EAAE,EAAE;gBAChB,MAAM,YAAY,MAAM,SAAS,IAAI;gBACrC,MAAM,IAAI,MACR,CAAC,gCAAgC,EAAE,SAAS,MAAM,CAAC,CAAC,EAAE,SAAS,UAAU,CAAC,GAAG,EAAE,WAAW;YAE9F;YAEA,IAAI,SAAS,MAAM,KAAK,KAAK;gBAC3B,OAAO;YACT;YAEA,OAAO,SAAS,IAAI;QACtB,EAAE,OAAO,OAAO;YACd,IAAI,iBAAiB,WAAW;gBAC9B,MAAM,IAAI,MAAM;YAClB;YACA,MAAM;QACR;IACF;IAEA;;GAEC,GACD,MAAM,sBACJ,WAAmB,EACnB,MAAc,EACd,WAAmB,EACnB,KAAc,EACC;QACf,MAAM,IAAI,CAAC,OAAO,CAChB,wBACA,CAAC,mBAAmB,EAAE,YAAY,OAAO,EAAE,OAAO,SAAS,CAAC,EAC5D;YACE,QAAQ;YACR,MAAM,KAAK,SAAS,CAAC;gBACnB;gBACA;YACF;QACF;IAEJ;IAEA;;GAEC,GACD,MAAM,mBAAmB,MAAc,EAAgB;QACrD,OAAO,IAAI,CAAC,OAAO,CACjB,wBACA,CAAC,2BAA2B,EAAE,QAAQ;IAE1C;IAEA;;GAEC,GACD,MAAM,oBACJ,aAAqB,EACrB,MAAgC,EACjB;QACf,MAAM,IAAI,CAAC,OAAO,CAChB,yBACA,CAAC,uCAAuC,EAAE,eAAe,EACzD;YACE,QAAQ;YACR,MAAM,KAAK,SAAS,CAAC;QACvB;IAEJ;IAEA;;GAEC,GACD,MAAM,yBAAyB,aAAqB,EAAgB;QAClE,OAAO,IAAI,CAAC,OAAO,CACjB,yBACA,CAAC,uCAAuC,EAAE,eAAe;IAE7D;AACF;AAEO,MAAM,qBAAqB,IAAI"}},
    {"offset": {"line": 6551, "column": 0}, "map": {"version":3,"sources":["file:///Users/mukurusystemsadministrator/Desktop/onboarding_kyc%20copy/partner/src/utils/iconUtils.tsx"],"sourcesContent":["import {\n  FiBriefcase,\n  FiHome,\n  FiUsers,\n  FiDollarSign,\n  FiShield,\n  FiHeart,\n  FiGlobe,\n  FiBook,\n  FiCamera,\n  FiMusic,\n  FiCoffee,\n  FiTruck,\n  FiZap,\n  FiTarget,\n  FiTrendingUp,\n  FiBox,\n  FiPackage,\n  FiShoppingBag,\n  FiAnchor,\n  FiLayers,\n  FiUser,\n  FiLock,\n  FiFileText, // Default icon\n} from \"react-icons/fi\";\n\nconst iconMap: Record<string, any> = {\n  FiBriefcase,\n  FiHome,\n  FiUsers,\n  FiDollarSign,\n  FiShield,\n  FiHeart,\n  FiGlobe,\n  FiBook,\n  FiCamera,\n  FiMusic,\n  FiCoffee,\n  FiTruck,\n  FiZap,\n  FiTarget,\n  FiTrendingUp,\n  FiBox,\n  FiPackage,\n  FiShoppingBag,\n  FiAnchor,\n  FiLayers,\n  FiUser,\n  FiLock,\n  FiFileText, // Default icon\n};\n\n/**\n * Gets the icon component from an icon name\n * @param iconName The icon name (e.g., \"FiBriefcase\")\n * @returns The icon component or a default icon if not found\n */\nexport function getIconComponent(iconName?: string | null) {\n  if (!iconName) return FiFileText;\n  return iconMap[iconName] || FiFileText;\n}\n\n/**\n * Maps entity type name/code to an appropriate icon\n * @param entityLabel The display name of the entity type\n * @param entityCode The code of the entity type (optional)\n * @returns The icon component name\n */\nexport function getEntityTypeIcon(entityLabel?: string | null, entityCode?: string | null): string {\n  if (!entityLabel && !entityCode) return 'FiFileText';\n  \n  const label = (entityLabel || '').toLowerCase().trim();\n  const code = (entityCode || '').toLowerCase().trim();\n  \n  // Check code first (more reliable)\n  if (code) {\n    // Government / State Owned Entity\n    if (code.includes('government') || code.includes('state_owned') || code.includes('state-owned') || \n        code.includes('parastatal') || code.includes('organ_of_state')) {\n      return 'FiShield';\n    }\n    \n    // NPO / NGO / PVO / Charity\n    if (code.includes('npo') || code.includes('ngo') || code.includes('pvo') || \n        code.includes('charity') || code.includes('non_profit') || code.includes('nonprofit')) {\n      return 'FiHeart';\n    }\n    \n    // Non-Registered Association / Society / Foundation\n    if (code.includes('association') || code.includes('society') || code.includes('foundation') ||\n        code.includes('non_registered')) {\n      return 'FiUsers';\n    }\n    \n    // Private Company / Limited Liability Company\n    if (code.includes('private_company') || code.includes('private-company') || \n        code.includes('llc') || code.includes('limited_liability')) {\n      return 'FiBriefcase';\n    }\n    \n    // Publicly Listed Entity\n    if (code.includes('public_company') || code.includes('public-company') || \n        code.includes('publicly_listed') || code.includes('publicly-listed')) {\n      return 'FiTrendingUp';\n    }\n    \n    // Sole Proprietor\n    if (code.includes('sole_proprietor') || code.includes('sole-proprietor') || \n        code.includes('sole_trader') || code.includes('sole-trader')) {\n      return 'FiUser';\n    }\n    \n    // Supranational / Inter-Governmental\n    if (code.includes('supranational') || code.includes('inter_governmental') || \n        code.includes('intergovernmental')) {\n      return 'FiGlobe';\n    }\n    \n    // Trust\n    if (code.includes('trust')) {\n      return 'FiLock';\n    }\n    \n    // Partnership\n    if (code.includes('partnership')) {\n      return 'FiUsers';\n    }\n    \n    // Cooperative\n    if (code.includes('cooperative')) {\n      return 'FiUsers';\n    }\n  }\n  \n  // Check label if code didn't match\n  if (label) {\n    // Government / State Owned Entity\n    if (label.includes('government') || label.includes('state owned') || label.includes('state-owned') ||\n        label.includes('organ of state') || label.includes('parastatal')) {\n      return 'FiShield';\n    }\n    \n    // NPO / NGO / PVO / Charity\n    if (label.includes('npo') || label.includes('ngo') || label.includes('pvo') || \n        label.includes('charity') || label.includes('non-profit') || label.includes('nonprofit') ||\n        label.includes('non profit')) {\n      return 'FiHeart';\n    }\n    \n    // Non-Registered Association / Society / Foundation\n    if (label.includes('association') || label.includes('society') || label.includes('foundation') ||\n        label.includes('non-registered') || label.includes('non registered')) {\n      return 'FiUsers';\n    }\n    \n    // Private Company / Limited Liability Company\n    if (label.includes('private company') || label.includes('limited liability') || \n        label.includes('llc') || (label.includes('private') && label.includes('company'))) {\n      return 'FiBriefcase';\n    }\n    \n    // Publicly Listed Entity\n    if (label.includes('publicly listed') || label.includes('public company') ||\n        (label.includes('public') && label.includes('listed'))) {\n      return 'FiTrendingUp';\n    }\n    \n    // Sole Proprietor\n    if (label.includes('sole proprietor') || label.includes('sole trader') ||\n        label.includes('sole-proprietor') || label.includes('sole-trader')) {\n      return 'FiUser';\n    }\n    \n    // Supranational / Inter-Governmental\n    if (label.includes('supranational') || label.includes('inter-governmental') ||\n        label.includes('intergovernmental') || label.includes('inter governmental')) {\n      return 'FiGlobe';\n    }\n    \n    // Trust\n    if (label.includes('trust')) {\n      return 'FiLock';\n    }\n    \n    // Partnership\n    if (label.includes('partnership')) {\n      return 'FiUsers';\n    }\n    \n    // Cooperative\n    if (label.includes('cooperative')) {\n      return 'FiUsers';\n    }\n  }\n  \n  // Default\n  return 'FiFileText';\n}\n\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 6685, "column": 0}, "map": {"version":3,"sources":["file:///Users/mukurusystemsadministrator/Desktop/onboarding_kyc%20copy/partner/src/app/partner/application/enhanced/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { \n  Box, \n  Container, \n  VStack, \n  HStack,\n  Text,\n  Flex,\n  Image,\n  Circle,\n  SimpleGrid,\n  Icon,\n  Button,\n  Spinner,\n  Badge\n} from \"@chakra-ui/react\";\nimport { \n  FiFileText, \n  FiHome, \n  FiCheckSquare, \n  FiUsers, \n  FiUserCheck, \n  FiFolder, \n  FiPhone, \n  FiCheck,\n  FiArrowRight,\n  FiArrowLeft,\n  FiX,\n  FiClock,\n  FiSave,\n  FiEye,\n  FiZap,\n  FiMessageSquare\n} from \"react-icons/fi\";\nimport { motion } from \"framer-motion\";\nimport Link from \"next/link\";\nimport { useState, useEffect, useMemo } from \"react\";\nimport { useFormPersistence } from \"@/hooks/useFormPersistence\";\nimport { getEntityFormConfig, entityFormConfigs, FormField, EntityFormConfig } from \"@/lib/entityFormConfigs\";\nimport { EnhancedDynamicForm } from \"@/components/EnhancedDynamicForm\";\nimport { ProgressTracking } from \"@/components/ProgressTracking\";\nimport { ExternalValidation } from \"@/components/ExternalValidation\";\nimport { EnhancedContextualMessaging } from \"@/components/EnhancedContextualMessaging\";\nimport { OCRIntegration } from \"@/components/OCRIntegration\";\nimport { getAuthUser, getInitials, logout } from \"@/lib/auth/session\";\nimport { entityConfigApiService, EntityType, Requirement } from \"@/services/entityConfigApi\";\nimport { uploadFilesToDocumentService, mapRequirementCodeToDocumentType, DocumentType } from \"@/lib/documentUpload\";\nimport { integrationService } from \"@/services/integrationService\";\nimport { getIconComponent, getEntityTypeIcon } from \"@/utils/iconUtils\";\n\nconst MotionBox = motion.create(Box);\n\ninterface EntityTypeOption {\n  value: string;\n  label: string;\n  description: string;\n  icon?: string;\n  originalCode?: string;\n}\n\n// Map backend entity codes to form config keys\n// This handles differences between backend codes and form config keys\nconst mapEntityCodeToFormConfig = (code: string): string => {\n  const codeLower = code.toLowerCase();\n  // Map common variations\n  const mapping: Record<string, string> = {\n    'private_company': 'private_company',\n    'public_company': 'private_company', // Use private company form as fallback\n    'ngo': 'npo',\n    'npo': 'npo',\n    'non_profit': 'npo',\n    'government': 'government',\n    'state_owned': 'government',\n    'sole_proprietor': 'private_company', // Use private company form as fallback\n    'sole_trader': 'private_company', // Use private company form as fallback (same as sole_proprietor)\n    'partnership': 'private_company', // Use private company form as fallback\n    'trust': 'private_company', // Use private company form as fallback\n  };\n  \n  return mapping[codeLower] || codeLower;\n};\n\nexport default function EnhancedNewPartnerApplicationPage() {\n  const [currentUser, setCurrentUser] = useState<{ name: string; email?: string }>({ name: \"User\" });\n  const [currentStep, setCurrentStep] = useState(1);\n  const [selectedEntityType, setSelectedEntityType] = useState(\"\");\n  const [showProgress, setShowProgress] = useState(false);\n  const [showMessaging, setShowMessaging] = useState(false);\n  const [showOCR, setShowOCR] = useState(false);\n  const [validationErrors, setValidationErrors] = useState<Record<string, string>>({});\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const [toastState, setToastState] = useState<{ status: \"success\" | \"error\" | \"info\"; title: string; description?: string } | null>(null);\n  const [entityTypes, setEntityTypes] = useState<EntityTypeOption[]>([]);\n  const [loadingEntityTypes, setLoadingEntityTypes] = useState(true);\n  const [entityTypesError, setEntityTypesError] = useState<string | null>(null);\n  const [selectedEntityTypeData, setSelectedEntityTypeData] = useState<EntityType | null>(null);\n  const [loadingEntityTypeData, setLoadingEntityTypeData] = useState(false);\n  const [caseId, setCaseId] = useState<string | null>(null);\n  const [checklistId, setChecklistId] = useState<string | null>(null);\n  const [applicationId, setApplicationId] = useState<string | null>(null);\n  // Store File objects temporarily (will be uploaded to Document Service after case creation)\n  const [fileObjects, setFileObjects] = useState<Map<string, File>>(new Map());\n  \n  const showToast = (args: { status: \"success\" | \"error\" | \"info\"; title: string; description?: string }) => {\n    setToastState(args);\n    setTimeout(() => setToastState(null), 5000);\n  };\n  \n  // Fetch entity types from backend\n  useEffect(() => {\n    const loadEntityTypes = async () => {\n      try {\n        setLoadingEntityTypes(true);\n        setEntityTypesError(null);\n        const data = await entityConfigApiService.getEntityTypes(false, false);\n        \n        // Map backend data to frontend format\n        // Normalize codes to lowercase and map to form config keys\n        // Deduplicate by original code to prevent duplicate keys\n        const seenCodes = new Set<string>();\n        const mappedTypes: EntityTypeOption[] = data\n          .filter(et => {\n            // Filter active and deduplicate by code\n            if (!et.isActive) return false;\n            const codeKey = et.code.toLowerCase();\n            if (seenCodes.has(codeKey)) {\n              console.warn(`Duplicate entity type code detected: ${et.code}. Skipping duplicate.`);\n              return false;\n            }\n            seenCodes.add(codeKey);\n            return true;\n          })\n          .map(et => {\n            const formConfigKey = mapEntityCodeToFormConfig(et.code);\n            // Determine icon: use backend icon if available, otherwise map from entity type\n            const iconName = et.icon || getEntityTypeIcon(et.displayName, et.code);\n            return {\n              value: formConfigKey, // Use mapped key for form config lookup\n              label: et.displayName,\n              description: et.description || 'No description available',\n              icon: iconName, // Include icon from backend or mapped icon\n              originalCode: et.code // Keep original for reference (unique identifier)\n            };\n          });\n        \n        // Log if some entity types don't have static form configs (they'll use backend-generated forms)\n        // This is expected behavior, so we use debug level instead of warning\n        mappedTypes.forEach(et => {\n          const config = getEntityFormConfig(et.value);\n          if (!config) {\n            console.debug(`No static form config for entity type: ${et.value} (original code: ${et.originalCode}). Will use backend-generated form from Entity Configuration Service.`);\n          }\n        });\n        \n        console.log(`[Enhanced Page] Loaded ${mappedTypes.length} entity types from backend`);\n        setEntityTypes(mappedTypes);\n      } catch (err) {\n        console.error('Error loading entity types:', err);\n        console.error('Error details:', err instanceof Error ? err.message : String(err));\n        setEntityTypesError('Failed to load entity types. Please try again later.');\n        showToast({\n          status: \"error\",\n          title: \"Loading Error\",\n          description: \"Failed to load entity types from the server\"\n        });\n        // Fallback to empty array - page will show error state\n        setEntityTypes([]);\n      } finally {\n        setLoadingEntityTypes(false);\n      }\n    };\n\n    loadEntityTypes();\n  }, []);\n\n  // Convert backend requirement to form field\n  const convertRequirementToFormField = (req: Requirement, isRequired: boolean, displayOrder: number): FormField => {\n    // Map backend fieldType to frontend field type\n    const fieldTypeMap: Record<string, FormField['type']> = {\n      'Text': 'text',\n      'Email': 'email',\n      'Phone': 'tel',\n      'Number': 'number',\n      'Date': 'date',\n      'Textarea': 'textarea',\n      'Select': 'select',\n      'MultiSelect': 'select',\n      'File': 'file',\n      'Checkbox': 'checkbox',\n      'Radio': 'radio'\n    };\n\n    // Parse validation rules if present\n    let validation: FormField['validation'] | undefined;\n    if (req.validationRules) {\n      try {\n        const rules = JSON.parse(req.validationRules);\n        validation = {\n          min: rules.minLength || rules.min,\n          max: rules.maxLength || rules.max,\n          pattern: rules.pattern\n        };\n      } catch (e) {\n        console.warn('Failed to parse validation rules:', req.validationRules);\n      }\n    }\n\n    // Convert requirement options to form field options\n    const options = req.options?.map(opt => ({\n      value: opt.value,\n      label: opt.displayText,\n      disabled: false\n    }));\n\n    return {\n      id: req.code.toLowerCase(),\n      label: req.displayName,\n      type: fieldTypeMap[req.fieldType] || 'text',\n      required: isRequired,\n      placeholder: req.description || `Enter ${req.displayName.toLowerCase()}`,\n      description: req.helpText || req.description,\n      validation,\n      options,\n      order: displayOrder\n    };\n  };\n\n  // Generate form config from backend entity type requirements\n  const generateFormConfigFromBackend = (entityType: EntityType): EntityFormConfig | null => {\n    if (!entityType.requirements || entityType.requirements.length === 0) {\n      return null;\n    }\n\n    // Group requirements by type to create steps\n    const requirementsByType = new Map<string, typeof entityType.requirements>();\n    entityType.requirements.forEach(etReq => {\n      if (etReq.requirement) {\n        const type = etReq.requirement.type;\n        if (!requirementsByType.has(type)) {\n          requirementsByType.set(type, []);\n        }\n        requirementsByType.get(type)!.push(etReq);\n      }\n    });\n\n    // Create steps from requirement types with improved categorization\n    // Maps requirement types to logical wizard steps and checklist categories\n    const stepTypes = [\n      { \n        type: 'Information', \n        title: 'Business Information', \n        subtitle: 'Company details and registration',\n        checklistCategory: 'Compliance',\n        stepNumber: 1\n      },\n      { \n        type: 'ProofOfIdentity', \n        title: 'Identity Verification', \n        subtitle: 'Proof of identity documents and verification',\n        checklistCategory: 'Identity',\n        stepNumber: 2\n      },\n      { \n        type: 'ProofOfAddress', \n        title: 'Address Verification', \n        subtitle: 'Proof of address documents',\n        checklistCategory: 'Address',\n        stepNumber: 3\n      },\n      { \n        type: 'OwnershipStructure', \n        title: 'Ownership & Control', \n        subtitle: 'Shareholders, beneficial owners, and ownership structure',\n        checklistCategory: 'Compliance',\n        stepNumber: 4\n      },\n      { \n        type: 'BoardDirectors', \n        title: 'Management & Directors', \n        subtitle: 'Board of directors and key management personnel',\n        checklistCategory: 'Compliance',\n        stepNumber: 5\n      },\n      { \n        type: 'AuthorizedSignatories', \n        title: 'Authorized Signatories', \n        subtitle: 'Persons authorized to sign on behalf of the entity',\n        checklistCategory: 'Compliance',\n        stepNumber: 6\n      },\n      { \n        type: 'Document', \n        title: 'Additional Documents', \n        subtitle: 'Any additional required documents and certificates',\n        checklistCategory: 'Documentation',\n        stepNumber: 7\n      }\n    ];\n\n    const steps = stepTypes\n      .map((stepInfo, idx) => {\n        const reqs = requirementsByType.get(stepInfo.type);\n        if (!reqs || reqs.length === 0) return null;\n\n        // Sort by display order\n        const sortedReqs = [...reqs].sort((a, b) => a.displayOrder - b.displayOrder);\n        \n        const fields = sortedReqs\n          .filter(etReq => etReq.requirement && etReq.requirement.isActive)\n          .map(etReq => convertRequirementToFormField(etReq.requirement!, etReq.isRequired, etReq.displayOrder));\n\n        if (fields.length === 0) return null;\n\n        return {\n          id: `step-${stepInfo.stepNumber}`,\n          title: stepInfo.title,\n          subtitle: stepInfo.subtitle,\n          fields,\n          requiredDocuments: fields.filter(f => f.type === 'file').map(f => f.id),\n          // Metadata for integration\n          requirementType: stepInfo.type,\n          checklistCategory: stepInfo.checklistCategory,\n          stepNumber: stepInfo.stepNumber\n        };\n      })\n      .filter(step => step !== null) as EntityFormConfig['steps'];\n\n    if (steps.length === 0) {\n      return null;\n    }\n\n    return {\n      entityType: entityType.code.toLowerCase(),\n      displayName: entityType.displayName,\n      description: entityType.description,\n      steps,\n      requiredDocuments: []\n    };\n  };\n  \n  // Get entity form configuration - prioritize backend data over static configs\n  // Use useMemo to recompute when backend data or selected entity type changes\n  const entityConfig = useMemo(() => {\n    let config: EntityFormConfig | null = null;\n    \n    // First, try to generate config from backend requirements\n    if (selectedEntityTypeData && selectedEntityTypeData.requirements && selectedEntityTypeData.requirements.length > 0) {\n      config = generateFormConfigFromBackend(selectedEntityTypeData);\n      if (config) {\n        console.log('Using backend-generated form config:', config);\n      }\n    }\n    \n    // Fallback to static config if backend doesn't have requirements\n    if (!config) {\n      config = getEntityFormConfig(selectedEntityType);\n      if (!config && selectedEntityType) {\n        // Try to find the entity type in the list to get display name\n        const entityTypeInfo = entityTypes.find(et => et.value === selectedEntityType);\n        const fallbackConfig = getEntityFormConfig('private_company');\n        if (fallbackConfig && entityTypeInfo) {\n          // Use fallback config but with the correct entity type info\n          config = {\n            ...fallbackConfig,\n            entityType: selectedEntityType,\n            displayName: entityTypeInfo.label,\n            description: entityTypeInfo.description\n          };\n        }\n      }\n    }\n    \n    return config;\n  }, [selectedEntityTypeData, selectedEntityType, entityTypes]);\n  \n  // Debug logging\n  useEffect(() => {\n    if (selectedEntityType) {\n      console.log('Selected entity type:', selectedEntityType);\n      console.log('Entity config found:', !!entityConfig);\n      if (!entityConfig) {\n        console.warn('No entity config found for:', selectedEntityType);\n        console.log('Available configs:', Object.keys(entityFormConfigs));\n      }\n    }\n  }, [selectedEntityType, entityConfig]);\n\n  // Initial form data\n  const initialFormData: Record<string, any> = {\n    entityType: \"\",\n    // Will be populated based on entity type configuration\n  };\n\n  // Use form persistence hook\n  const {\n    formData,\n    updateField,\n    updateNestedField,\n    updateArrayField,\n    addArrayItem,\n    removeArrayItem,\n    isDirty,\n    lastSaved,\n    isSaving,\n    saveError,\n    clearSavedData,\n    forceSave\n  } = useFormPersistence(initialFormData, { formId: \"new-application\" });\n\n  // Update form data when entity type changes\n  useEffect(() => {\n    if (selectedEntityType && selectedEntityType !== formData.entityType) {\n      updateField(\"entityType\", selectedEntityType);\n    }\n  }, [selectedEntityType, formData.entityType, updateField]);\n\n  // Fetch entity type data with requirements when selected\n  useEffect(() => {\n    const loadEntityTypeData = async () => {\n      if (!selectedEntityType) {\n        setSelectedEntityTypeData(null);\n        return;\n      }\n\n      try {\n        setLoadingEntityTypeData(true);\n        // Find the entity type ID from the entity types list\n        const entityTypeOption = entityTypes.find(et => et.value === selectedEntityType);\n        if (!entityTypeOption || !entityTypeOption.originalCode) {\n          console.warn('Entity type not found in list');\n          return;\n        }\n\n        // Get all entity types with requirements to find the one we need\n        const allEntityTypes = await entityConfigApiService.getEntityTypes(false, true);\n        const entityTypeData = allEntityTypes.find(et => \n          et.code.toLowerCase() === entityTypeOption.originalCode?.toLowerCase()\n        );\n\n        if (entityTypeData) {\n          setSelectedEntityTypeData(entityTypeData);\n          console.log('Loaded entity type data:', entityTypeData);\n        } else {\n          console.warn('Entity type data not found');\n          setSelectedEntityTypeData(null);\n        }\n      } catch (err) {\n        console.error('Error loading entity type data:', err);\n        setSelectedEntityTypeData(null);\n      } finally {\n        setLoadingEntityTypeData(false);\n      }\n    };\n\n    loadEntityTypeData();\n  }, [selectedEntityType, entityTypes]);\n\n  const handleEntityTypeSelect = (entityType: string) => {\n    setSelectedEntityType(entityType);\n    setCurrentStep(1);\n    setValidationErrors({});\n  };\n\n  const handleFieldChange = (fieldId: string, value: any) => {\n    updateField(fieldId, value);\n    \n    // Clear validation error for this field\n    if (validationErrors[fieldId]) {\n      setValidationErrors(prev => {\n        const newErrors = { ...prev };\n        delete newErrors[fieldId];\n        return newErrors;\n      });\n    }\n  };\n\n  // Sync step completion with checklist and work-queue services\n  const handleStepComplete = async (stepId: string) => {\n    if (!entityConfig) return;\n    \n    const step = entityConfig.steps.find(s => s.id === stepId);\n    if (!step) return;\n\n    console.log(`Step ${stepId} (${step.title}) completed`);\n\n    try {\n      // If we have a case ID, update checklist items for this step\n      if (caseId && checklistId && step.checklistCategory) {\n        // Get checklist to find items in this category\n        const checklist = await integrationService.getChecklistByCase(caseId);\n        if (checklist && checklist.items) {\n          // Find checklist items that match this step's category\n          const stepItems = checklist.items.filter((item: any) => \n            item.category === step.checklistCategory\n          );\n\n          // Mark matching checklist items as completed\n          for (const item of stepItems) {\n            try {\n              await integrationService.completeChecklistItem(\n                checklistId,\n                item.id,\n                currentUser.name || 'partner',\n                `Completed via ${step.title} step`\n              );\n              console.log(`Marked checklist item ${item.name} as completed`);\n            } catch (err) {\n              console.warn(`Failed to update checklist item ${item.id}:`, err);\n            }\n          }\n        }\n      }\n\n      // Update work queue progress if we have an application ID\n      if (applicationId) {\n        const progress = Math.round(((currentStep) / entityConfig.steps.length) * 100);\n        try {\n          await integrationService.updateWorkQueueItem(applicationId, {\n            progress,\n            notes: `Completed step: ${step.title}`\n          });\n          console.log(`Updated work queue progress to ${progress}%`);\n        } catch (err) {\n          console.warn('Failed to update work queue:', err);\n        }\n      }\n    } catch (err) {\n      console.error('Error syncing step completion:', err);\n      // Don't block user flow if sync fails\n    }\n  };\n\n  const handleNext = async () => {\n    if (!entityConfig) return;\n    \n    const currentStepConfig = entityConfig.steps[currentStep - 1];\n    if (!currentStepConfig) return;\n    \n    // Validate current step\n    const errors: Record<string, string> = {};\n    currentStepConfig.fields.forEach(field => {\n      if (field.required) {\n        const value = formData[field.id];\n        if (!value || (typeof value === 'string' && value.trim() === '')) {\n          errors[field.id] = `${field.label} is required`;\n        }\n      }\n    });\n    \n    if (Object.keys(errors).length > 0) {\n      setValidationErrors(errors);\n      showToast({\n        status: \"error\",\n        title: \"Validation Error\",\n        description: \"Please complete all required fields before proceeding\"\n      });\n      return;\n    }\n    \n    setValidationErrors({});\n    \n    // Sync step completion with backend services before moving to next step\n    if (currentStepConfig) {\n      await handleStepComplete(currentStepConfig.id);\n    }\n    \n    if (currentStep < entityConfig.steps.length) {\n      setCurrentStep(currentStep + 1);\n    }\n  };\n\n  const handlePrevious = () => {\n    if (currentStep > 1) {\n      setCurrentStep(currentStep - 1);\n    }\n  };\n\n  const handleSubmit = async () => {\n    if (!entityConfig) return;\n    \n    // Prevent double submission\n    if (isSubmitting) {\n      console.warn(' Submission already in progress, ignoring duplicate call');\n      return;\n    }\n    \n    setIsSubmitting(true);\n    console.log(' Starting submission process...');\n    \n    try {\n      // DYNAMIC VALIDATION: Validate based ONLY on the Entity Configuration Service requirements\n      // that are actually being used in the form (from entityConfig.steps)\n      \n      if (!entityConfig || !entityConfig.steps || entityConfig.steps.length === 0) {\n        console.error(' Cannot validate: entityConfig is missing or has no steps');\n        showToast({\n          status: \"error\",\n          title: \"Validation Error\",\n          description: \"Form configuration is missing. Please refresh and try again.\"\n        });\n        setIsSubmitting(false);\n        return;\n      }\n      \n      const errors: Record<string, string> = {};\n      const validatedFields: Array<{ stepId: string; stepTitle: string; fieldId: string; fieldLabel: string; required: boolean }> = [];\n      \n      // Validate ONLY the fields that are in the entityConfig being used to render the form\n      // This entityConfig comes from the backend Entity Configuration Service\n      // It contains ONLY the fields configured for this specific entity type\n      // IMPORTANT: This is the SAME entityConfig passed to EnhancedDynamicForm (config={entityConfig})\n      // So validation matches exactly what's displayed in the form - no hardcoded fields!\n      entityConfig.steps.forEach(step => {\n        if (!step.fields || step.fields.length === 0) {\n          return; // Skip steps with no fields\n        }\n        \n        step.fields.forEach(field => {\n          // Track all fields being validated for debugging\n          validatedFields.push({\n            stepId: step.id,\n            stepTitle: step.title,\n            fieldId: field.id,\n            fieldLabel: field.label,\n            required: field.required || false\n          });\n          \n          // Only validate required fields from the dynamic entity configuration\n          // field.required comes from the backend requirement configuration (etReq.isRequired)\n          if (field.required) {\n            const value = formData[field.id];\n            // Check for empty values (null, undefined, empty string, or whitespace-only)\n            const isEmpty = value === undefined || \n                           value === null || \n                           value === '' || \n                           (typeof value === 'string' && value.trim() === '') ||\n                           (Array.isArray(value) && value.length === 0);\n            \n            if (isEmpty) {\n              // Use field.label from entity config, not hardcoded text\n              errors[field.id] = `${field.label} is required`;\n            }\n          }\n        });\n      });\n      \n      // Log validation details for debugging\n      // This confirms we're using the entity config that's actually rendering the form\n      console.log(' Validation check - Using entity configuration:', {\n        entityType: entityConfig.entityType,\n        displayName: entityConfig.displayName,\n        source: selectedEntityTypeData ? 'Backend Entity Configuration Service' : 'Static fallback config',\n        totalSteps: entityConfig.steps.length,\n        totalFields: validatedFields.length,\n        requiredFields: validatedFields.filter(f => f.required).length,\n        missingFields: Object.keys(errors).length,\n        validatedFields: validatedFields.map(f => ({\n          step: f.stepTitle,\n          fieldId: f.fieldId,\n          fieldLabel: f.fieldLabel,\n          required: f.required\n        })),\n        formDataKeys: Object.keys(formData),\n        errors: errors\n      });\n      \n      if (Object.keys(errors).length > 0) {\n        setValidationErrors(errors);\n        const missingFieldsList = Object.keys(errors).map(k => {\n          const field = validatedFields.find(f => f.fieldId === k);\n          return field ? field.fieldLabel : k;\n        }).join(', ');\n        \n        console.warn(' Dynamic validation failed. Missing required fields from entity configuration:', {\n          missingFields: missingFieldsList,\n          missingFieldIds: Object.keys(errors),\n          stepBreakdown: entityConfig.steps.map(step => ({\n            stepTitle: step.title,\n            requiredFields: step.fields.filter(f => f.required).map(f => ({\n              id: f.id,\n              label: f.label,\n              hasValue: !!(formData[f.id] && (typeof formData[f.id] !== 'string' || formData[f.id].trim() !== ''))\n            }))\n          }))\n        });\n        \n        showToast({\n          status: \"error\",\n          title: \"Submission Failed\",\n          description: `Please complete all required fields: ${missingFieldsList}`\n        });\n        setIsSubmitting(false); // Reset submitting state so button is enabled again\n        return;\n      }\n      \n      console.log(' Dynamic validation passed - all required fields from entity configuration are filled');\n      \n      // Try to submit to backend API first\n      try {\n        // Backend will generate PartnerId from authenticated user's email automatically\n        // We still validate email exists in form data for user feedback, but backend uses authenticated user's email\n        // Look for email in various possible field names (based on requirement codes)\n        const userEmail = formData[\"email\"] || \n                         formData[\"contact_email\"] || \n                         formData[\"applicant_email\"] || \n                         formData[\"personOfContact.email\"] || \n                         formData[\"applicant.email\"] || \n                         currentUser.email || \n                         \"\";\n        \n        console.log('Looking for user email:', {\n          foundEmail: userEmail,\n          formDataKeys: Object.keys(formData),\n          emailFields: {\n            email: formData[\"email\"],\n            contact_email: formData[\"contact_email\"],\n            applicant_email: formData[\"applicant_email\"],\n            currentUserEmail: currentUser.email\n          }\n        });\n        \n        // Note: Backend will use authenticated user's email from token to generate PartnerId\n        // This validation is just for user feedback - backend doesn't rely on form email for PartnerId\n        if (!userEmail) {\n          showToast({\n            status: \"error\",\n            title: \"Missing User Information\",\n            description: \"Unable to identify user email. Please ensure the email field is filled in.\"\n          });\n          setIsSubmitting(false);\n          return;\n        }\n        \n        // Extract data from formData to create application\n        // DYNAMICALLY map all form fields from entity configuration requirements\n        // Field codes in formData are the requirement codes in lowercase (see convertRequirementToFormField)\n        const getFieldValue = (fieldCode: string, fallbacks: string[] = []): any => {\n          // Try direct field code first (lowercase as stored in formData)\n          const lowerCode = fieldCode.toLowerCase();\n          if (formData[lowerCode] !== undefined && formData[lowerCode] !== null && formData[lowerCode] !== \"\") {\n            return formData[lowerCode];\n          }\n          // Try fallbacks\n          for (const fallback of fallbacks) {\n            const lowerFallback = fallback.toLowerCase();\n            if (formData[lowerFallback] !== undefined && formData[lowerFallback] !== null && formData[lowerFallback] !== \"\") {\n              return formData[lowerFallback];\n            }\n          }\n          return undefined; // Return undefined instead of empty string to allow proper filtering\n        };\n\n        // Helper to get name parts from full name field\n        const getNameParts = (fullName: string): { firstName: string; lastName: string } => {\n          if (!fullName) return { firstName: \"\", lastName: \"\" };\n          const parts = fullName.trim().split(/\\s+/);\n          if (parts.length === 1) return { firstName: parts[0], lastName: \"\" };\n          return { firstName: parts[0], lastName: parts.slice(1).join(\" \") };\n        };\n\n        // DYNAMICALLY build applicant object based on ACTUAL requirement codes from entity configuration\n        // This ensures we only map fields that are actually configured in the entity type\n        const requirements = selectedEntityTypeData?.requirements || [];\n        const requirementMap = new Map<string, string>(); // Maps requirement code (uppercase) to formData key (lowercase)\n        \n        requirements.forEach(req => {\n          if (req.requirement?.code) {\n            const codeUpper = req.requirement.code.toUpperCase();\n            const codeLower = req.requirement.code.toLowerCase();\n            requirementMap.set(codeUpper, codeLower);\n          }\n        });\n\n        // Helper to find requirement code by pattern (e.g., find FIRST_NAME, GIVEN_NAME, etc.)\n        const findRequirementValue = (patterns: string[]): any => {\n          for (const pattern of patterns) {\n            for (const [codeUpper, codeLower] of requirementMap.entries()) {\n              if (codeUpper.includes(pattern) || codeUpper === pattern) {\n                const value = getFieldValue(codeLower);\n                if (value !== undefined && value !== null && value !== \"\") {\n                  return value;\n                }\n              }\n            }\n          }\n          return undefined;\n        };\n\n        // Map applicant fields DYNAMICALLY based on actual requirement codes\n        // Only use fields that exist in the entity configuration\n        const fullNameValue = findRequirementValue([\"FULL_NAME\", \"NAME\", \"APPLICANT_NAME\", \"PERSON_OF_CONTACT\", \"CONTACT_NAME\"]);\n        const nameParts = getNameParts(fullNameValue || \"\");\n        \n        const firstNameValue = findRequirementValue([\"FIRST_NAME\", \"FIRSTNAME\", \"GIVEN_NAME\"]) || nameParts.firstName;\n        const lastNameValue = findRequirementValue([\"LAST_NAME\", \"LASTNAME\", \"SURNAME\", \"FAMILY_NAME\"]) || nameParts.lastName;\n        const emailValue = findRequirementValue([\"EMAIL\", \"APPLICANT_EMAIL\", \"CONTACT_EMAIL\"]) || userEmail;\n        const phoneValue = findRequirementValue([\"PHONE\", \"PHONE_NUMBER\", \"CONTACT_PHONE\", \"MOBILE\", \"TELEPHONE\"]);\n        const nationalityValue = findRequirementValue([\"NATIONALITY\", \"COUNTRY_OF_NATIONALITY\"]);\n        const dateOfBirthValue = findRequirementValue([\"DATE_OF_BIRTH\", \"DOB\", \"BIRTH_DATE\"]);\n        \n        // Address fields - dynamically find from requirements\n        const addressLine1Value = findRequirementValue([\"ADDRESS\", \"RESIDENTIAL_ADDRESS\", \"APPLICANT_ADDRESS\", \"STREET_ADDRESS\", \"ADDRESS_LINE1\", \"ADDRESS_LINE_1\"]);\n        const addressLine2Value = findRequirementValue([\"ADDRESS_LINE2\", \"ADDRESS_LINE_2\", \"ADDRESS2\"]);\n        const cityValue = findRequirementValue([\"CITY\", \"APPLICANT_CITY\", \"RESIDENTIAL_CITY\"]);\n        const stateValue = findRequirementValue([\"STATE\", \"PROVINCE\", \"APPLICANT_STATE\"]);\n        const postalCodeValue = findRequirementValue([\"POSTAL_CODE\", \"POSTCODE\", \"ZIP_CODE\", \"APPLICANT_POSTAL_CODE\"]);\n        const countryValue = findRequirementValue([\"COUNTRY\", \"APPLICANT_COUNTRY\", \"RESIDENTIAL_COUNTRY\", \"COUNTRY_OF_RESIDENCE\"]);\n\n        console.log(' Dynamic applicant field mapping from entity requirements:', {\n          requirementCodes: Array.from(requirementMap.keys()),\n          mappedFields: {\n            firstName: firstNameValue,\n            lastName: lastNameValue,\n            email: emailValue,\n            phone: phoneValue,\n            nationality: nationalityValue,\n            dateOfBirth: dateOfBirthValue,\n            address: {\n              line1: addressLine1Value,\n              line2: addressLine2Value,\n              city: cityValue,\n              state: stateValue,\n              postalCode: postalCodeValue,\n              country: countryValue\n            }\n          },\n          formDataKeys: Object.keys(formData)\n        });\n\n        // Build applicant object - ONLY include fields that have values (from configured requirements)\n        const applicant: any = {};\n        \n        if (firstNameValue) applicant.firstName = firstNameValue;\n        if (lastNameValue) applicant.lastName = lastNameValue;\n        if (emailValue) applicant.email = emailValue;\n        if (phoneValue) applicant.phoneNumber = phoneValue;\n        if (nationalityValue) applicant.nationality = nationalityValue;\n        if (dateOfBirthValue) applicant.dateOfBirth = dateOfBirthValue;\n        \n        // Only include address if at least one field has a value\n        const hasAddressData = addressLine1Value || cityValue || countryValue;\n        if (hasAddressData) {\n          applicant.residentialAddress = {\n            line1: addressLine1Value || \"\",\n            line2: addressLine2Value || \"\",\n            city: cityValue || \"\",\n            state: stateValue || \"\",\n            postalCode: postalCodeValue || \"\",\n            country: countryValue || \"\"\n          };\n        }\n\n        // Determine if this is a business entity type DYNAMICALLY from requirements\n        // Check if entity type has business-related requirements\n        // Requirements come with uppercase codes (LEGAL_NAME, REGISTRATION_NUMBER, etc.)\n        // Note: 'requirements' is already declared above\n        const requirementCodes = requirements\n          .filter(req => req.requirement)\n          .map(req => req.requirement!.code?.toUpperCase() || '');\n        \n        // Business-related requirement codes (check uppercase versions)\n        const businessCodes = ['LEGAL_NAME', 'BUSINESS_LEGAL_NAME', 'COMPANY_NAME', 'REGISTRATION_NUMBER', \n                              'BUSINESS_REGISTRATION', 'INCORPORATION', 'BUSINESS_ADDRESS', 'REGISTERED_ADDRESS',\n                              'TRADING_NAME', 'TRADE_NAME', 'BUSINESS_NAME', 'COUNTRY_OF_REGISTRATION',\n                              'COUNTRY_OF_INCORPORATION', 'BUSINESS_ADDRESS', 'TAX_NUMBER', 'TAX_ID'];\n        \n        // Check requirement types for business indicators\n        const businessTypes = ['OwnershipStructure', 'BoardDirectors', 'AuthorizedSignatories'];\n        \n        const hasBusinessCodes = requirementCodes.some(code => \n          businessCodes.some(bc => code.includes(bc))\n        );\n        \n        const hasBusinessTypes = requirements.some(req => {\n          const type = req.requirement?.type || '';\n          return businessTypes.some(bt => type.includes(bt));\n        });\n        \n        const isBusinessEntity = hasBusinessCodes || hasBusinessTypes;\n        \n        // Debug logging\n        console.log('Business entity detection:', {\n          requirementCodes,\n          hasBusinessCodes,\n          hasBusinessTypes,\n          isBusinessEntity,\n          requirementsCount: requirements.length\n        });\n        \n        // Build business object dynamically from entity configuration requirements\n        // Extract business fields from the dynamic requirements configured for this entity type\n        let business: any = undefined;\n        if (isBusinessEntity && selectedEntityTypeData?.requirements) {\n          // Dynamically extract business fields based on requirements configured for this entity type\n          // Requirements use UPPERCASE codes, but formData uses lowercase (from convertRequirementToFormField)\n          const businessRequirements = selectedEntityTypeData.requirements\n            .filter(req => req.requirement)\n            .map(req => ({\n              codeUpper: req.requirement!.code?.toUpperCase() || '',\n              codeLower: req.requirement!.code?.toLowerCase() || '',\n              type: req.requirement!.type,\n              fieldType: req.requirement!.fieldType\n            }));\n          \n          // Find business name from requirements - check all possible business name requirement codes\n          // Map uppercase requirement codes to lowercase formData keys\n          const businessNameReqs = businessRequirements\n            .filter(r => ['LEGAL_NAME', 'BUSINESS_LEGAL_NAME', 'COMPANY_NAME', 'BUSINESS_NAME', \n                          'REGISTERED_NAME', 'TRADING_NAME', 'TRADE_NAME'].some(bc => r.codeUpper.includes(bc)));\n          \n          const businessLegalName = businessNameReqs.length > 0 \n            ? getFieldValue(businessNameReqs[0].codeLower, businessNameReqs.slice(1).map(r => r.codeLower))\n            : null;\n          \n          // Check if this entity type is likely a sole trader by checking requirement codes\n          const isSoleTrader = businessRequirements.some(r => \n            r.codeUpper.includes('PROPRIETOR') || r.codeUpper.includes('SOLE') || r.codeUpper.includes('TRADER')\n          ) || (selectedEntityTypeData.code?.toLowerCase().includes('sole') || \n                selectedEntityTypeData.code?.toLowerCase().includes('trader'));\n          \n          const finalBusinessName = businessLegalName || \n            (isSoleTrader ? `${nameParts.firstName} ${nameParts.lastName}`.trim() : null) ||\n            `${nameParts.firstName} ${nameParts.lastName}`.trim(); // Last resort\n          \n          // Find registration number from requirements\n          const registrationReqs = businessRequirements\n            .filter(r => ['REGISTRATION_NUMBER', 'BUSINESS_REGISTRATION', 'COMPANY_REGISTRATION', \n                          'TAX_NUMBER', 'TAX_ID'].some(rc => r.codeUpper.includes(rc)));\n          \n          const registrationNumber = registrationReqs.length > 0\n            ? getFieldValue(registrationReqs[0].codeLower, registrationReqs.slice(1).map(r => r.codeLower))\n            : '';\n          \n          // Find country of registration from requirements\n          const countryReqs = businessRequirements\n            .filter(r => ['COUNTRY_OF_REGISTRATION', 'COUNTRY_OF_INCORPORATION', 'REGISTRATION_COUNTRY', \n                          'INCORPORATION_COUNTRY', 'BUSINESS_COUNTRY'].some(cc => r.codeUpper.includes(cc)));\n          \n          const countryOfRegistration = countryReqs.length > 0\n            ? getFieldValue(countryReqs[0].codeLower, countryReqs.slice(1).map(r => r.codeLower))\n            : applicant.residentialAddress.country || '';\n          \n          // Find business address fields from requirements\n          const addressReqs = businessRequirements\n            .filter(r => ['BUSINESS_ADDRESS', 'REGISTERED_ADDRESS', 'COMPANY_ADDRESS'].some(ac => r.codeUpper.includes(ac)));\n          \n          const addressLine1 = addressReqs.length > 0\n            ? getFieldValue(addressReqs[0].codeLower, addressReqs.slice(1).map(r => r.codeLower))\n            : applicant.residentialAddress.line1 || '';\n          \n          // Always build business object for business entity types\n          if (finalBusinessName || isBusinessEntity) {\n            business = {\n              legalName: finalBusinessName || `${nameParts.firstName} ${nameParts.lastName}`.trim() || 'Business',\n              registrationNumber: registrationNumber || \"\",\n              countryOfRegistration: countryOfRegistration || \"\",\n              registeredAddress: {\n                line1: addressLine1 || applicant.residentialAddress.line1 || \"\",\n                line2: getFieldValue(\"business_address_line2\", [\n                  \"registered_address_line2\",\n                  \"business_address_line_2\",\n                  \"company_address_line2\"\n                ]) || applicant.residentialAddress.line2 || \"\",\n                city: getFieldValue(\"business_city\", [\n                  \"registered_city\",\n                  \"company_city\",\n                  \"business_city_of_registration\"\n                ]) || applicant.residentialAddress.city || \"\",\n                state: getFieldValue(\"business_state\", [\n                  \"registered_state\",\n                  \"company_state\",\n                  \"business_state_of_registration\"\n                ]) || applicant.residentialAddress.state || \"\",\n                postalCode: getFieldValue(\"business_postal_code\", [\n                  \"registered_postal_code\",\n                  \"company_postal_code\",\n                  \"business_postcode\"\n                ]) || applicant.residentialAddress.postalCode || \"\",\n                country: countryOfRegistration || applicant.residentialAddress.country || \"\"\n              }\n            };\n          }\n        }\n\n        // Convert date string to ISO date format (YYYY-MM-DD) if present\n        // Backend expects date format, not datetime\n        if (applicant.dateOfBirth) {\n          try {\n            const date = new Date(applicant.dateOfBirth);\n            if (isNaN(date.getTime())) {\n              console.warn('Invalid date format for dateOfBirth:', applicant.dateOfBirth);\n              applicant.dateOfBirth = undefined;\n            } else {\n              // Format as YYYY-MM-DD (date only, not datetime)\n              const year = date.getFullYear();\n              const month = String(date.getMonth() + 1).padStart(2, '0');\n              const day = String(date.getDate()).padStart(2, '0');\n              applicant.dateOfBirth = `${year}-${month}-${day}`;\n            }\n          } catch (e) {\n            console.warn('Error processing dateOfBirth:', e, applicant.dateOfBirth);\n            applicant.dateOfBirth = undefined;\n          }\n        }\n\n        // Map entity type code to backend enum format\n        // Backend expects: PRIVATE_COMPANY, PUBLIC_COMPANY, SOLE_PROPRIETOR, PARTNERSHIP, TRUST, NPO, etc.\n        const mapEntityTypeToBackend = (code: string | undefined): string => {\n          if (!code) return \"PRIVATE_COMPANY\";\n          const upperCode = code.toUpperCase().replace(/[^A-Z0-9]/g, '_');\n          // Handle common variations\n          if (upperCode.includes('PRIVATE') || upperCode.includes('COMPANY')) return \"PRIVATE_COMPANY\";\n          if (upperCode.includes('PUBLIC')) return \"PUBLIC_COMPANY\";\n          // Handle sole trader/proprietor variations\n          if (upperCode.includes('SOLE') || upperCode.includes('PROPRIETOR') || upperCode.includes('TRADER')) return \"SOLE_PROPRIETOR\";\n          if (upperCode.includes('PARTNERSHIP')) return \"PARTNERSHIP\";\n          if (upperCode.includes('TRUST')) return \"TRUST\";\n          if (upperCode.includes('NPO') || upperCode.includes('NGO') || upperCode.includes('NON_PROFIT')) return \"NPO\";\n          return upperCode;\n        };\n\n        // Build application data with all mapped fields\n        // API uses snake_case_lower naming policy (see Program.cs JsonNamingPolicy.SnakeCaseLower)\n        // OnboardingType enum: 1=Individual, 2=Business\n        // For business entity types, always use type 2 (Business), even if business object is minimal\n        const onboardingType = isBusinessEntity ? 2 : 1; // 1=Individual, 2=Business\n        \n        const mappedEntityTypeCode = mapEntityTypeToBackend(selectedEntityTypeData?.code || formData[\"entityType\"]);\n        const originalEntityTypeCode = selectedEntityTypeData?.code || formData[\"entityType\"] || '';\n\n        // Debug: Log what we're sending\n        console.log('Submitting application with data:', {\n          mappedEntityType: mappedEntityTypeCode,\n          originalEntityTypeCode,\n          isBusinessEntity,\n          onboardingType,\n          partnerId: 'Will be generated by backend from authenticated user email',\n          applicant: { \n            firstName: applicant.firstName, \n            lastName: applicant.lastName,\n            email: applicant.email,\n            dateOfBirth: applicant.dateOfBirth ? 'Date set' : 'Not set' \n          },\n          business: business ? {\n            legalName: business.legalName,\n            hasAddress: !!(business.registeredAddress?.line1 && business.registeredAddress?.city)\n          } : 'Not set',\n          formDataKeys: Object.keys(formData).filter(k => formData[k] !== undefined && formData[k] !== null && formData[k] !== \"\")\n        });\n\n        // DYNAMIC VALIDATION:\n        // The form already validates required fields based on Entity Configuration Service requirements.\n        // We only need to ensure we can construct a valid API request with the data we have.\n        \n        // Transform full_name to firstName/lastName if needed (for API format)\n        // ONLY if we have a full_name value from the form\n        if ((!applicant.firstName || !applicant.lastName) && fullNameValue) {\n          const trimmedName = fullNameValue.trim();\n          if (trimmedName) {\n            const parts = trimmedName.split(/\\s+/);\n            applicant.firstName = parts[0] || '';\n            applicant.lastName = parts.slice(1).join(' ') || '';\n          }\n        }\n        \n        // NO HARDCODED VALIDATION - validation is already done based on entityConfig.steps above\n        // The form validation at the top of handleSubmit ensures all required fields from the\n        // dynamic entity configuration are filled. We only need to format the data for the API here.\n        \n        // Format nationality to 2-character ISO code if present (only if field exists in form)\n        // Map common country names to ISO codes, otherwise take first 2 characters\n        if (applicant.nationality) {\n          const countryNameToCode: Record<string, string> = {\n            'south africa': 'ZA',\n            'kenya': 'KE',\n            'nigeria': 'NG',\n            'ghana': 'GH',\n            'zimbabwe': 'ZW',\n            'zambia': 'ZM',\n            'tanzania': 'TZ',\n            'uganda': 'UG',\n            'rwanda': 'RW',\n            'mauritius': 'MU',\n            'united states': 'US',\n            'united kingdom': 'GB',\n            'united states of america': 'US'\n          };\n          \n          const normalized = applicant.nationality.trim().toLowerCase();\n          if (countryNameToCode[normalized]) {\n            applicant.nationality = countryNameToCode[normalized];\n          } else {\n            // If it's already 2 characters, use as-is (assume it's already a code)\n            // Otherwise, take first 2 characters\n            applicant.nationality = applicant.nationality.length === 2 \n              ? applicant.nationality.toUpperCase() \n              : applicant.nationality.toUpperCase().substring(0, 2);\n          }\n        }\n\n        // For business entities, provide defaults if needed for API format\n        // The form already validated based on Entity Configuration Service requirements\n        if (isBusinessEntity && onboardingType === 2 && business) {\n          // Provide defaults for business name (use applicant name as fallback for sole traders)\n          if (!business.legalName) {\n            business.legalName = `${applicant.firstName} ${applicant.lastName}`.trim() || 'Business Name';\n          }\n          \n          // Use residential address as fallback for business address if missing\n          if (!business.registeredAddress.line1 || !business.registeredAddress.city || !business.registeredAddress.country) {\n            business.registeredAddress = {\n              line1: business.registeredAddress.line1 || applicant.residentialAddress.line1,\n              line2: business.registeredAddress.line2 || applicant.residentialAddress.line2 || '',\n              city: business.registeredAddress.city || applicant.residentialAddress.city,\n              state: business.registeredAddress.state || applicant.residentialAddress.state || '',\n              postalCode: business.registeredAddress.postalCode || applicant.residentialAddress.postalCode || '',\n              country: business.registeredAddress.country || applicant.residentialAddress.country\n            };\n          }\n        }\n        \n        // Collect ALL dynamic fields from requirements that aren't already mapped\n        // Store them in metadata so nothing is lost\n        const mappedFields = new Set([\n          // Applicant fields\n          'first_name', 'last_name', 'middle_name', 'email', 'phone_number', 'date_of_birth',\n          'nationality', 'tax_id', 'passport_number', 'drivers_license_number',\n          // Address fields\n          'address', 'address_line1', 'address_line2', 'city', 'state', 'postal_code', 'country',\n          'residential_address', 'applicant_address', 'applicant_city', 'applicant_country',\n          // Business fields\n          'legal_name', 'business_legal_name', 'company_name', 'business_name', 'registered_name',\n          'trading_name', 'registration_number', 'business_registration_number', \n          'country_of_registration', 'business_country', 'business_address', 'registered_address',\n          'business_city', 'business_state', 'business_postal_code',\n          // Standard fields\n          'entitytype', 'partner_reference_id', 'reference_id'\n        ]);\n        \n        // Collect all other form fields as metadata\n        const metadata: Record<string, any> = {};\n        \n        // Store entity type configuration info\n        metadata['entity_type_code'] = originalEntityTypeCode;\n        metadata['entity_type_display_name'] = selectedEntityTypeData?.displayName || '';\n        \n        // Store all dynamic requirement-based fields\n        // IMPORTANT: Use requirement.code as the key (normalized to lowercase) to match entity config\n        Object.keys(formData).forEach(key => {\n          const lowerKey = key.toLowerCase();\n          const value = formData[key];\n          \n          // Skip already mapped fields and empty values\n          // Note: File upload objects are preserved (they contain fileName, googleDriveUrl, etc.)\n          const isEmpty = value === undefined || \n                         value === null || \n                         value === '' ||\n                         (typeof value === 'string' && value.trim() === '') ||\n                         (Array.isArray(value) && value.length === 0);\n          \n          if (!mappedFields.has(lowerKey) && !isEmpty) {\n            // Store with requirement code as key (lowercase version of requirement.code)\n            // This ensures consistency: entity config uses UPPERCASE codes, we store lowercase in metadata\n            // File uploads are stored as objects with fileName, googleDriveUrl, fileId, etc.\n            metadata[lowerKey] = value;\n          }\n        });\n        \n        // Store requirement codes that were configured for this entity type\n        // This helps with validation and debugging\n        if (selectedEntityTypeData?.requirements) {\n          const requirementCodes = selectedEntityTypeData.requirements\n            .filter(req => req.requirement)\n            .map(req => req.requirement!.code.toLowerCase()); // Store lowercase for consistency\n          metadata['configured_requirements'] = requirementCodes.join(',');\n          \n          // Also store a mapping of requirement codes to their display names for reference\n          const requirementMap: Record<string, string> = {};\n          selectedEntityTypeData.requirements.forEach(req => {\n            if (req.requirement) {\n              requirementMap[req.requirement.code.toLowerCase()] = req.requirement.displayName;\n            }\n          });\n          metadata['requirement_display_names'] = JSON.stringify(requirementMap);\n        }\n        \n        // Build applicant object - ONLY include fields that exist in formData (from dynamic form)\n        // Do NOT add hardcoded defaults - only send what's actually configured in the entity form\n        // The applicant object was built dynamically above based on actual requirement codes\n        const applicantData: any = {};\n        \n        // Log what we have from the dynamic mapping\n        console.log(' Building applicantData from dynamic mapping:', {\n          applicantObject: applicant,\n          applicantKeys: Object.keys(applicant),\n          hasFirstName: !!applicant.firstName,\n          hasLastName: !!applicant.lastName,\n          hasEmail: !!applicant.email,\n          hasPhone: !!applicant.phoneNumber,\n          hasDateOfBirth: !!applicant.dateOfBirth,\n          hasNationality: !!applicant.nationality,\n          hasAddress: !!applicant.residentialAddress,\n          addressData: applicant.residentialAddress\n        });\n        \n        // Only include fields that have values (from configured requirements)\n        // These come from the entity configuration service requirements\n        if (applicant.firstName) applicantData.first_name = applicant.firstName;\n        if (applicant.lastName) applicantData.last_name = applicant.lastName;\n        if (applicant.email) applicantData.email = applicant.email;\n        if (applicant.middleName) applicantData.middle_name = applicant.middleName;\n        if (applicant.phoneNumber) applicantData.phone_number = applicant.phoneNumber;\n        if (applicant.dateOfBirth) applicantData.date_of_birth = applicant.dateOfBirth;\n        if (applicant.nationality) applicantData.nationality = applicant.nationality;\n        \n        // Only include address if it exists (was built from configured requirements)\n        if (applicant.residentialAddress) {\n          applicantData.residential_address = {\n            line1: applicant.residentialAddress.line1 || \"\",\n            line2: applicant.residentialAddress.line2 || \"\",\n            city: applicant.residentialAddress.city || \"\",\n            state: applicant.residentialAddress.state || \"\",\n            postal_code: applicant.residentialAddress.postalCode || \"\",\n            country: applicant.residentialAddress.country || \"\"\n          };\n        }\n        \n        // Log final applicantData structure\n        console.log(' Final applicantData being sent:', {\n          applicantData,\n          applicantDataKeys: Object.keys(applicantData),\n          hasAllRequiredFields: {\n            first_name: !!applicantData.first_name,\n            last_name: !!applicantData.last_name,\n            email: !!applicantData.email,\n            phone_number: !!applicantData.phone_number,\n            date_of_birth: !!applicantData.date_of_birth,\n            nationality: !!applicantData.nationality,\n            residential_address: !!applicantData.residential_address\n          }\n        });\n        \n        const applicationData = {\n          type: onboardingType,\n          // partner_id is intentionally omitted - backend will generate it from authenticated user's email\n          // This ensures the PartnerId matches the authenticated user and prevents mismatches\n          partner_reference_id: formData[\"partner_reference_id\"] || formData[\"reference_id\"] || \"\",\n          applicant: applicantData,\n          business: business ? {\n            legal_name: business.legalName,\n            registration_number: business.registrationNumber,\n            country_of_registration: business.countryOfRegistration,\n            registered_address: {\n              line1: business.registeredAddress.line1,\n              line2: business.registeredAddress.line2 || \"\",\n              city: business.registeredAddress.city,\n              state: business.registeredAddress.state || \"\",\n              postal_code: business.registeredAddress.postalCode || \"\",\n              country: business.registeredAddress.country\n            }\n          } : undefined,\n          // Include metadata with all dynamic fields\n          metadata: Object.keys(metadata).length > 0 ? metadata : undefined\n        };\n\n        // Log the partnerId that would be generated (for debugging)\n        // Backend will generate it from authenticated user's email automatically\n        console.log(' PartnerId will be generated by backend from authenticated user email:', userEmail);\n\n        // Try to create application via API\n        // Use the onboarding API endpoint (port 8001) via proxy\n        const { getAuthUser } = await import(\"@/lib/auth/session\");\n        const user = getAuthUser();\n        \n        const headers: HeadersInit = {\n          'Content-Type': 'application/json',\n        };\n        \n        // Add schema-driven form headers for dynamic validation (backend checks headers first)\n        if (originalEntityTypeCode) {\n          headers['X-Entity-Type'] = originalEntityTypeCode;\n          console.log(' Added X-Entity-Type header for schema-based validation:', originalEntityTypeCode);\n        }\n        \n        // Add form configuration ID and version if available from entity type data\n        if (selectedEntityTypeData?.id) {\n          headers['X-Form-Config-Id'] = selectedEntityTypeData.id;\n          console.log(' Added X-Form-Config-Id header:', selectedEntityTypeData.id);\n        }\n        \n        // Use updatedAt as version indicator (or a version field if available)\n        if (selectedEntityTypeData?.updatedAt) {\n          // Use timestamp as version identifier\n          const version = new Date(selectedEntityTypeData.updatedAt).getTime().toString();\n          headers['X-Form-Version'] = version;\n          console.log(' Added X-Form-Version header:', version);\n        } else if (selectedEntityTypeData?.id) {\n          // Fallback: use ID hash as version\n          headers['X-Form-Version'] = '1';\n          console.log(' Added X-Form-Version header (default): 1');\n        }\n        \n        // Add user identification headers\n        if (user?.email) {\n          headers['X-User-Email'] = user.email;\n          headers['X-User-Name'] = user.name || user.email;\n          headers['X-User-Role'] = 'Applicant';\n        }\n        \n        console.log(' Submitting to API:', {\n          url: '/api/proxy/api/v1/cases',\n          partnerId: 'Will be generated by backend from authenticated user email',\n          userEmail: userEmail,\n          type: applicationData.type,\n          applicant: {\n            firstName: applicationData.applicant.first_name,\n            lastName: applicationData.applicant.last_name,\n            email: applicationData.applicant.email,\n            hasAddress: !!(applicationData.applicant.residential_address?.line1)\n          },\n          business: applicationData.business ? {\n            legalName: applicationData.business?.legal_name,\n            hasRegistrationNumber: !!(applicationData.business?.registration_number)\n          } : 'None',\n          metadataKeys: Object.keys(applicationData.metadata || {})\n        });\n        \n        // Log the exact data being sent for debugging\n        // Log the EXACT applicant data being sent\n        console.log(' Making API call with data:', {\n          applicant: applicationData.applicant,\n          applicantKeys: Object.keys(applicationData.applicant || {}),\n          applicantHasAddress: !!applicationData.applicant?.residential_address,\n          addressKeys: applicationData.applicant?.residential_address ? Object.keys(applicationData.applicant.residential_address) : [],\n          business: business ? 'Set' : 'Not set',\n          type: applicationData.type,\n          fullApplicationData: JSON.stringify(applicationData, null, 2)\n        });\n        \n        let response;\n        try {\n          response = await fetch('/api/proxy/api/v1/cases', {\n          method: 'POST',\n          headers,\n          body: JSON.stringify(applicationData)\n          });\n          console.log(' API call completed, status:', response.status);\n        } catch (fetchError) {\n          console.error(' Fetch failed:', fetchError);\n          throw fetchError;\n        }\n\n        const responseText = await response.text();\n        console.log(' API Response:', {\n          status: response.status,\n          statusText: response.statusText,\n          bodyLength: responseText.length,\n          body: responseText.substring(0, 500) // First 500 chars\n        });\n        \n        // Parse error details for better user feedback\n        let errorDetails = '';\n        try {\n          const errorJson = JSON.parse(responseText);\n          if (errorJson.errors) {\n            const errorMessages = Object.entries(errorJson.errors)\n              .map(([field, messages]: [string, any]) => {\n                const fieldName = field.replace(/([A-Z])/g, ' $1').trim();\n                return `${fieldName}: ${Array.isArray(messages) ? messages.join(', ') : messages}`;\n              })\n              .join('; ');\n            errorDetails = errorMessages;\n            console.error(' Backend validation errors:', errorJson.errors);\n          } else if (errorJson.message) {\n            errorDetails = errorJson.message;\n          }\n        } catch (e) {\n          // Not JSON, use raw text\n          errorDetails = responseText.substring(0, 200);\n        }\n\n        if (response.ok) {\n          let result;\n          try {\n            result = JSON.parse(responseText);\n          } catch (e) {\n            console.error('Failed to parse response JSON:', e, responseText);\n            throw new Error('Invalid response from server');\n          }\n          \n          // Backend returns both case_id (Guid) and case_number (string)\n          // Use case_number for display/linking since that's what projections API uses\n          const createdCaseId = result.case_number || result.case_id || result.caseId;\n          const caseGuid = result.case_id || result.id;\n          \n          if (!createdCaseId) {\n            console.error('No case ID returned from backend:', result);\n            throw new Error('Case was created but no case ID was returned');\n          }\n          \n          console.log(' Case created successfully:', { \n            caseId: createdCaseId, \n            caseGuid, \n            fullResult: result \n          });\n          \n          // Upload files to Document Service after case creation\n          if (fileObjects.size > 0 && caseGuid) {\n            try {\n              console.log(` Uploading ${fileObjects.size} file(s) to Document Service...`);\n              \n              // Get partner ID from authenticated user email\n              // Backend generates PartnerId from email using MD5 hash\n              // We'll use the email and let the backend handle it, or generate it client-side\n              // For now, we'll pass the email and the backend will generate the PartnerId\n              // But document service requires PartnerId, so we need to generate it\n              // Using a simple approach - in production, use proper MD5 implementation\n              let partnerId = '';\n              if (user?.email) {\n                // Generate PartnerId using MD5 (matching backend algorithm)\n                // For now, use a placeholder - in production, implement proper MD5\n                const normalizedEmail = user.email.toLowerCase().trim();\n                // Simple hash (replace with proper MD5 in production)\n                let hash = 0;\n                for (let i = 0; i < normalizedEmail.length; i++) {\n                  hash = ((hash << 5) - hash) + normalizedEmail.charCodeAt(i);\n                  hash = hash & hash;\n                }\n                const hex = Math.abs(hash).toString(16).padStart(32, '0');\n                partnerId = `${hex.substring(0, 8)}-${hex.substring(8, 12)}-${hex.substring(12, 16)}-${hex.substring(16, 20)}-${hex.substring(20, 32)}`;\n              }\n              \n              if (!partnerId) {\n                console.warn(' Cannot upload files: Partner ID not available');\n              } else {\n                // Prepare files for upload\n                const filesToUpload = Array.from(fileObjects.entries()).map(([requirementCode, file]) => ({\n                  file,\n                  requirementCode,\n                  description: formData[requirementCode]?.fileName || file.name\n                }));\n                \n                // Upload all files\n                const uploadResults = await uploadFilesToDocumentService(\n                  caseGuid,\n                  partnerId,\n                  filesToUpload,\n                  user?.email\n                );\n                \n                // Log results and store document IDs in metadata\n                const uploadedDocuments: Record<string, string> = {};\n                uploadResults.forEach(({ requirementCode, result, error }) => {\n                  if (error) {\n                    console.error(` Failed to upload file for ${requirementCode}:`, error);\n                  } else if (result.documentId) {\n                    console.log(` File uploaded successfully for ${requirementCode}:`, {\n                      documentId: result.documentId,\n                      documentNumber: result.documentNumber,\n                      storageKey: result.storageKey\n                    });\n                    uploadedDocuments[`${requirementCode}_document_id`] = result.documentId;\n                    uploadedDocuments[`${requirementCode}_storage_key`] = result.storageKey;\n                  }\n                });\n                \n                // Update case metadata with document IDs (optional - can be done via separate API call if needed)\n                if (Object.keys(uploadedDocuments).length > 0) {\n                  console.log(' Document IDs stored:', uploadedDocuments);\n                }\n              }\n            } catch (uploadError) {\n              console.error(' Error uploading files to Document Service:', uploadError);\n              // Don't fail the entire submission - files can be uploaded later\n              showToast({\n                status: \"error\",\n                title: \"File Upload Warning\",\n                description: \"Case created successfully, but some files failed to upload. You can upload them later.\"\n              });\n            }\n          }\n          \n          // Trigger projections sync to ensure case is available in read model\n          // This is a best-effort call - don't block on it\n          // Note: The onboarding API also triggers sync automatically, but we trigger it here\n          // to ensure immediate visibility (with a small delay to let the DB transaction commit)\n          try {\n            // Wait a bit for the database transaction to commit\n            await new Promise(resolve => setTimeout(resolve, 1000));\n            \n            console.log('Triggering projections sync...');\n            const syncResponse = await fetch('/api/proxy/api/v1/sync?forceFullSync=false', {\n              method: 'POST',\n              headers: {\n                'Content-Type': 'application/json',\n                ...(user?.email ? {\n                  'X-User-Email': user.email,\n                  'X-User-Name': user.name || user.email,\n                  'X-User-Role': 'Applicant'\n                } : {})\n              }\n            });\n            \n            if (syncResponse.ok) {\n              const syncResult = await syncResponse.json();\n              console.log(' Projections sync completed:', syncResult);\n            } else {\n              const errorText = await syncResponse.text();\n              console.error(' Projections sync failed:', {\n                status: syncResponse.status,\n                error: errorText\n              });\n              // Don't fail - the onboarding API also triggers sync, and admin can manually sync\n            }\n          } catch (syncError) {\n            console.error(' Failed to trigger projections sync:', syncError);\n            // Don't block - the onboarding API also triggers sync automatically, and admin can manually sync\n          }\n          \n          showToast({\n            status: \"success\",\n            title: \"Application Submitted Successfully\",\n            description: `Your application has been submitted. Case ID: ${createdCaseId}`\n          });\n\n          // Redirect to dashboard with success message\n          setTimeout(() => {\n            window.location.href = `/partner/dashboard?submitted=true&caseId=${createdCaseId}`;\n          }, 2000);\n          return;\n        } else {\n          // Handle error response - DO NOT SILENTLY FAIL\n          let errorMessage = `Server error: ${response.status} ${response.statusText}`;\n          let errorDetails = '';\n          try {\n            const errorJson = JSON.parse(responseText);\n            errorMessage = errorJson.error || errorJson.message || errorJson.title || errorMessage;\n            \n            // Extract detailed validation errors\n            if (errorJson.errors) {\n              const validationErrors = Object.entries(errorJson.errors)\n                .map(([field, messages]: [string, any]) => {\n                  const fieldName = field.split('.').pop()?.replace(/([A-Z])/g, ' $1').trim() || field;\n                  const msgList = Array.isArray(messages) ? messages : [messages];\n                  return `${fieldName}: ${msgList.join(', ')}`;\n                })\n                .join('; ');\n              errorDetails = validationErrors || errorJson.details || '';\n            } else {\n              errorDetails = errorJson.details || errorJson.message || '';\n            }\n          } catch {\n            errorDetails = responseText.substring(0, 200) || '';\n          }\n          \n          // Special handling for 503 Service Unavailable\n          if (response.status === 503) {\n            errorMessage = \" BACKEND SERVICE NOT RUNNING\";\n            errorDetails = \"The kyb-case-api service is not running on port 8001. TO FIX: Start the backend service using 'docker-compose up -d kyb-case-api' and try again. Your form data has been saved locally as a draft.\";\n            \n            // Auto-save the form data as a draft when service is unavailable\n            try {\n              await forceSave();\n              console.log(' Form data saved locally as draft due to service unavailability');\n            } catch (saveError) {\n              console.warn('Failed to save draft:', saveError);\n            }\n            \n            // Log clear instructions\n            console.error(' BACKEND SERVICE REQUIRED:', {\n              service: 'kyb-case-api',\n              port: '8001',\n              endpoint: 'http://localhost:8001/api/v1/cases',\n              action: 'Start the service: docker-compose up -d kyb-case-api',\n              checkStatus: 'docker ps --filter \"name=kyb_case_api\"'\n            });\n          }\n          \n          // Log error once with all relevant details\n          console.error(' API submission failed:', {\n            status: response.status,\n            statusText: response.statusText,\n            error: errorMessage,\n            details: errorDetails,\n            submittedData: {\n              type: applicationData.type,\n              partnerId: 'Generated by backend from authenticated user email',\n              hasApplicant: !!applicationData.applicant,\n              hasBusiness: !!applicationData.business\n            }\n          });\n          \n          // Show very clear error message for 503\n          if (response.status === 503) {\n            showToast({\n              status: \"error\",\n              title: \" Backend Service Not Running\",\n              description: \"The kyb-case-api service must be started on port 8001 to submit applications. Run: docker-compose up -d kyb-case-api. Your form has been saved as a draft.\"\n            });\n          } else {\n            showToast({\n              status: \"error\",\n              title: errorMessage,\n              description: errorDetails || \"Please try again later or contact support if the problem persists.\"\n            });\n          }\n          \n          // Create error with message for re-throwing (will be caught by outer catch)\n          const submissionError = new Error(errorMessage);\n          (submissionError as any).status = response.status;\n          (submissionError as any).details = errorDetails;\n          throw submissionError;\n        }\n      } catch (apiError: any) {\n        // Only log if this is a fetch error (not already logged above)\n        // If it's a response error, it was already logged in the else block above\n        if (apiError?.name === 'TypeError' || apiError?.message?.includes('fetch failed')) {\n          console.error(' Network error during submission:', {\n            message: apiError?.message,\n            name: apiError?.name\n          });\n        }\n        \n        // Check if it's a connection/service unavailable error\n        const isServiceUnavailable = apiError?.status === 503 ||\n                                    apiError?.message?.includes('Backend service unavailable') || \n                                    apiError?.message?.includes('Service Unavailable') ||\n                                    apiError?.message?.includes('ECONNREFUSED') ||\n                                    apiError?.message?.includes('fetch failed');\n        \n        // Show error to user - DO NOT show fake success\n        if (isServiceUnavailable && !apiError?.details) {\n          // Try to save as draft (if not already saved)\n          try {\n            await forceSave();\n            console.log(' Form data saved locally as draft');\n          } catch (saveError) {\n            console.warn('Failed to save draft:', saveError);\n          }\n          \n          showToast({\n            status: \"error\",\n            title: \"Service Unavailable\",\n            description: \"The backend service is not running. Your form has been saved locally. Please start the backend service and try again.\"\n          });\n        } else if (!apiError?.details) {\n          // Only show toast if not already shown above\n          showToast({\n            status: \"error\",\n            title: \"Submission Failed\",\n            description: apiError?.message || \"Failed to submit application. Please check your connection and try again.\"\n          });\n        }\n        \n        // DO NOT redirect - let user see the error and retry\n        throw apiError; // Re-throw to be caught by outer catch\n      }\n      \n    } catch (error: any) {\n      // Only log if error wasn't already logged above\n      // Most errors are already logged in the inner catch blocks\n      if (!error?.status && !error?.details) {\n        console.error(' Unexpected submission error:', {\n          message: error?.message,\n          name: error?.name\n        });\n      }\n      \n      // Check if it's a service unavailable error\n      const isServiceUnavailable = error?.status === 503 ||\n                                  error?.message?.includes('Backend service unavailable') || \n                                  error?.message?.includes('Service Unavailable') ||\n                                  error?.message?.includes('ECONNREFUSED') ||\n                                  error?.message?.includes('fetch failed');\n      \n      // Only show toast if not already shown in inner catch blocks\n      if (isServiceUnavailable && !error?.details) {\n        showToast({\n          status: \"error\",\n          title: \"Service Unavailable\",\n          description: \"The backend service is not running. Your form data has been saved locally. Please start the backend service (kyb-case-api on port 8001) using 'docker-compose up -d kyb-case-api' and try submitting again.\"\n        });\n      } else if (!error?.details) {\n        showToast({\n          status: \"error\",\n          title: \"Submission Failed\",\n          description: error instanceof Error ? error.message : \"Failed to submit application. Please try again.\"\n        });\n      }\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  const handleStepClick = (stepIndex: number) => {\n    setCurrentStep(stepIndex);\n  };\n\n  const handleResumeFromStep = (stepIndex: number) => {\n    setCurrentStep(stepIndex);\n  };\n\n  const handleSaveProgress = async () => {\n    await forceSave();\n    showToast({\n      status: \"success\",\n      title: \"Progress Saved\",\n      description: \"Your progress has been saved successfully\"\n    });\n  };\n\n  const handleValidationComplete = (fieldId: string, result: any) => {\n    if (result.isValid && result.data) {\n      // Auto-populate fields based on validation result\n      Object.entries(result.data).forEach(([key, value]) => {\n        const fieldMapping: Record<string, string> = {\n          'companyName': 'companyName',\n          'registeredName': 'companyName',\n          'registrationNumber': 'registrationNumber',\n          'incorporationDate': 'dateOfIncorporation',\n          'address': 'businessAddress',\n          'authorizedCapital': 'authorizedCapital',\n          'issuedCapital': 'issuedCapital'\n        };\n        \n        const mappedField = fieldMapping[key];\n        if (mappedField && !formData[mappedField]) {\n          updateField(mappedField, value);\n        }\n      });\n    }\n  };\n\n  const handleDataExtracted = (fieldMappings: any[]) => {\n    fieldMappings.forEach(mapping => {\n      updateField(mapping.fieldId, mapping.extractedValue);\n    });\n  };\n\n  const handleDocumentProcessed = (result: any) => {\n    console.log('Document processed:', result);\n  };\n\n  const handleSendMessage = async (content: string, context?: any, attachments?: File[]) => {\n    console.log('Sending message:', { content, context, attachments });\n    // Implement message sending logic\n  };\n\n  const handleReplyToMessage = async (messageId: string, content: string) => {\n    console.log('Replying to message:', { messageId, content });\n    // Implement reply logic\n  };\n\n  const handleForwardMessage = async (messageId: string, toConversationId: string) => {\n    console.log('Forwarding message:', { messageId, toConversationId });\n    // Implement forward logic\n  };\n\n  const handleStarMessage = async (messageId: string) => {\n    console.log('Starring message:', messageId);\n    // Implement star logic\n  };\n\n  const handleArchiveConversation = async (conversationId: string) => {\n    console.log('Archiving conversation:', conversationId);\n    // Implement archive logic\n  };\n\n  const handleAssignConversation = async (conversationId: string, adminId: string) => {\n    console.log('Assigning conversation:', { conversationId, adminId });\n    // Implement assign logic\n  };\n\n  const handleTagConversation = async (conversationId: string, tags: string[]) => {\n    console.log('Tagging conversation:', { conversationId, tags });\n    // Implement tag logic\n  };\n\n  useEffect(() => {\n    const user = getAuthUser();\n    setCurrentUser({ name: user.name, email: user.email });\n  }, []);\n\n  // Entity Type Selection\n  if (!selectedEntityType) {\n    return (\n      <Box minH=\"100vh\" bg=\"gray.50\">\n        <Box bg=\"white\" borderBottom=\"1px\" borderColor=\"gray.200\" py=\"4\">\n          <Container maxW=\"7xl\">\n            <Flex justify=\"space-between\" align=\"center\">\n              <HStack gap=\"4\">\n                <Image src=\"/mukuru-logo.png\" alt=\"Mukuru\" height=\"32px\" />\n              </HStack>\n              <HStack gap=\"4\">\n                <Link href=\"/partner/profile\">\n                  <Button variant=\"ghost\" size=\"sm\">Profile</Button>\n                </Link>\n                <Link href=\"/partner/messages\">\n                  <Button variant=\"ghost\" size=\"sm\">Messages</Button>\n                </Link>\n                <Button variant=\"outline\" size=\"sm\" onClick={() => logout('http://localhost:3000/')}>Logout</Button>\n                <Link href=\"/partner/application/enhanced\">\n                  <Button size=\"sm\" variant=\"solid\" className=\"mukuru-primary-button\" borderRadius=\"full\" px=\"6\" fontWeight=\"medium\">\n                    <Icon as={FiArrowRight} mr=\"2\" />\n                    New Application\n                  </Button>\n                </Link>\n                <Circle size=\"40px\" bg=\"linear-gradient(135deg, #FF6B35 0%, #F7931E 100%)\" color=\"white\">\n                  <Text fontSize=\"sm\" fontWeight=\"bold\" color=\"white\">{getInitials(currentUser.name)}</Text>\n                </Circle>\n              </HStack>\n            </Flex>\n          </Container>\n        </Box>\n        <Container maxW=\"7xl\" py=\"12\">\n          <VStack gap=\"8\" align=\"stretch\">\n            <VStack gap=\"4\" align=\"center\" textAlign=\"center\">\n              <Text fontSize=\"4xl\" fontWeight=\"bold\" color=\"gray.800\">\n                Start Your Application\n              </Text>\n              <Text fontSize=\"lg\" color=\"gray.600\" maxW=\"2xl\">\n                Choose your entity type to begin the onboarding process. We'll customize the form based on your selection.\n              </Text>\n            </VStack>\n\n            {loadingEntityTypes ? (\n              <VStack gap=\"4\" py=\"12\">\n                <Spinner size=\"xl\" color=\"orange.500\" />\n                <Text color=\"gray.600\">Loading entity types...</Text>\n              </VStack>\n            ) : entityTypesError ? (\n              <Box p=\"6\" bg=\"red.50\" borderRadius=\"lg\" border=\"1px\" borderColor=\"red.200\">\n                <VStack gap=\"2\" align=\"center\">\n                  <Text fontWeight=\"semibold\" color=\"red.800\">Error Loading Entity Types</Text>\n                  <Text color=\"red.700\" fontSize=\"sm\">{entityTypesError}</Text>\n                  <Button \n                    size=\"sm\" \n                    colorScheme=\"red\" \n                    onClick={() => window.location.reload()}\n                    mt=\"2\"\n                  >\n                    Retry\n                  </Button>\n                </VStack>\n              </Box>\n            ) : entityTypes.length === 0 ? (\n              <Box p=\"6\" bg=\"yellow.50\" borderRadius=\"lg\" border=\"1px\" borderColor=\"yellow.200\">\n                <Text textAlign=\"center\" color=\"yellow.800\">\n                  No entity types available. Please contact support.\n                </Text>\n              </Box>\n            ) : (\n            <Box>\n              <SimpleGrid \n                columns={{ base: 1, md: 2, lg: 3 }} \n                gap=\"6\"\n              >\n                {entityTypes.map((entity, index) => (\n                  <MotionBox\n                    key={entity.originalCode || entity.value || `entity-${index}`}\n                    p=\"6\"\n                    bg=\"white\"\n                    borderRadius=\"xl\"\n                    boxShadow=\"lg\"\n                    border=\"2px\"\n                    borderColor=\"gray.200\"\n                    cursor=\"pointer\"\n                    h=\"100%\"\n                    minH=\"160px\"\n                    display=\"flex\"\n                    flexDirection=\"row\"\n                    alignItems=\"stretch\"\n                    _hover={{ \n                      borderColor: \"#f76834\",\n                      boxShadow: \"xl\",\n                      transform: \"translateY(-2px)\"\n                    }}\n                    onClick={() => handleEntityTypeSelect(entity.value)}\n                    whileHover={{ scale: 1.02 }}\n                    whileTap={{ scale: 0.98 }}\n                  >\n                    <HStack gap=\"4\" align=\"stretch\" flex=\"1\" width=\"100%\" h=\"100%\">\n                      <Circle size=\"16\" bg=\"#f76834\" color=\"white\" flexShrink=\"0\" alignSelf=\"center\">\n                        <Icon as={getIconComponent(entity.icon)} boxSize=\"8\" />\n                      </Circle>\n                      \n                      <VStack gap=\"2\" align=\"start\" flex=\"1\" width=\"100%\" justify=\"center\" minH=\"0\" minW=\"0\">\n                        <Text\n                          fontSize=\"md\" \n                          fontWeight=\"semibold\" \n                          color=\"gray.800\" \n                          lineHeight=\"1.4\"\n                          wordBreak=\"break-word\"\n                          overflowWrap=\"break-word\"\n                          width=\"100%\"\n                        >\n                          {entity.label}\n                        </Text>\n                        <Text\n                          fontSize=\"sm\" \n                          color=\"gray.600\" \n                          lineHeight=\"1.5\"\n                          wordBreak=\"break-word\"\n                          overflowWrap=\"break-word\"\n                          width=\"100%\"\n                        >\n                          {entity.description}\n                        </Text>\n                      </VStack>\n                      \n                      <Button \n                        size=\"sm\"\n                        bg=\"black\" \n                        color=\"white\"\n                        borderRadius=\"full\"\n                        flexShrink=\"0\"\n                        px=\"4\"\n                        minW=\"44px\"\n                        w=\"44px\"\n                        h=\"44px\"\n                        alignSelf=\"center\"\n                        _hover={{ bg: \"gray.900\" }}\n                      >\n                        <Icon as={FiArrowRight} />\n                      </Button>\n                    </HStack>\n                  </MotionBox>\n                ))}\n              </SimpleGrid>\n            </Box>\n            )}\n          </VStack>\n        </Container>\n      </Box>\n    );\n  }\n\n  // Show loading state while fetching entity type data\n  if (loadingEntityTypeData) {\n    return (\n      <Box minH=\"100vh\" bg=\"gray.50\" display=\"flex\" alignItems=\"center\" justifyContent=\"center\">\n        <VStack gap=\"4\">\n          <Spinner size=\"xl\" color=\"orange.500\" />\n          <Text>Loading form configuration...</Text>\n          <Text fontSize=\"sm\" color=\"gray.500\">\n            Fetching requirements for {selectedEntityType}...\n          </Text>\n        </VStack>\n      </Box>\n    );\n  }\n\n  if (!entityConfig) {\n    return (\n      <Box minH=\"100vh\" bg=\"gray.50\" display=\"flex\" alignItems=\"center\" justifyContent=\"center\">\n        <VStack gap=\"4\">\n          <Spinner size=\"xl\" color=\"blue.500\" />\n          <Text>Loading application form...</Text>\n          {selectedEntityType && (\n            <Text fontSize=\"sm\" color=\"gray.500\" mt=\"4\">\n              Selected: {selectedEntityType}\n            </Text>\n          )}\n          <Box p=\"4\" bg=\"yellow.50\" borderRadius=\"md\" border=\"1px\" borderColor=\"yellow.200\" maxW=\"md\" mt=\"4\">\n            <Text fontSize=\"sm\" color=\"yellow.800\" textAlign=\"center\">\n              Form configuration not found for entity type: \"{selectedEntityType}\". \n              {selectedEntityTypeData && (!selectedEntityTypeData.requirements || selectedEntityTypeData.requirements.length === 0) \n                ? \" No requirements have been configured for this entity type yet. Please contact support.\"\n                : \" Please contact support or try selecting a different entity type.\"}\n            </Text>\n            <Button \n              size=\"sm\" \n              mt=\"3\" \n              onClick={() => setSelectedEntityType(\"\")}\n              colorScheme=\"orange\"\n            >\n              Go Back to Selection\n            </Button>\n          </Box>\n        </VStack>\n      </Box>\n    );\n  }\n\n  return (\n    <Box minH=\"100vh\" bg=\"gray.50\">\n      <Box bg=\"white\" borderBottom=\"1px\" borderColor=\"gray.200\" py=\"4\">\n        <Container maxW=\"7xl\">\n          <Flex justify=\"space-between\" align=\"center\">\n            <HStack gap=\"4\">\n              <Image src=\"/mukuru-logo.png\" alt=\"Mukuru\" height=\"32px\" />\n            </HStack>\n            <HStack gap=\"4\">\n              <Link href=\"/partner/profile\">\n                <Button variant=\"ghost\" size=\"sm\">Profile</Button>\n              </Link>\n              <Link href=\"/partner/messages\">\n                <Button variant=\"ghost\" size=\"sm\">Messages</Button>\n              </Link>\n              <Button variant=\"outline\" size=\"sm\" onClick={() => logout('http://localhost:3000/')}>Logout</Button>\n              <Link href=\"/partner/application/enhanced\">\n                <Button size=\"sm\" borderRadius=\"full\" px=\"6\" fontWeight=\"medium\" bg=\"black\" color=\"white\" _hover={{ bg: \"gray.900\" }}>\n                  <Icon as={FiArrowRight} mr=\"2\" />\n                  New Application\n                </Button>\n              </Link>\n              <Circle size=\"40px\" bg=\"linear-gradient(135deg, #FF6B35 0%, #F7931E 100%)\" color=\"white\">\n                <Text fontSize=\"sm\" fontWeight=\"bold\" color=\"white\">{getInitials(currentUser.name)}</Text>\n              </Circle>\n            </HStack>\n          </Flex>\n        </Container>\n      </Box>\n      <Container maxW=\"6xl\" py=\"8\">\n        <VStack gap=\"8\" align=\"stretch\">\n          {toastState && (\n            <Box p=\"3\" borderRadius=\"md\" bg={toastState.status === 'success' ? 'green.50' : toastState.status === 'error' ? 'red.50' : 'blue.50'} border=\"1px\" borderColor={toastState.status === 'success' ? 'green.200' : toastState.status === 'error' ? 'red.200' : 'blue.200'}>\n              <HStack gap=\"2\">\n                <Text fontWeight=\"semibold\">{toastState.title}</Text>\n                {toastState.description && (\n                  <Text color=\"gray.700\">{toastState.description}</Text>\n                )}\n              </HStack>\n            </Box>\n          )}\n          {/* Header */}\n          <Box p=\"6\" bg=\"white\" borderRadius=\"lg\" boxShadow=\"sm\">\n            <HStack justify=\"space-between\" align=\"center\" wrap=\"wrap\" gap=\"4\">\n              <VStack align=\"start\" gap=\"2\">\n                <HStack gap=\"3\">\n                  <Text fontSize=\"2xl\" fontWeight=\"bold\" color=\"gray.800\">\n                    {entityConfig.displayName} Application\n                  </Text>\n                  <Badge colorScheme=\"blue\" variant=\"subtle\">\n                    Step {currentStep} of {entityConfig.steps.length}\n                  </Badge>\n                </HStack>\n                <Text color=\"gray.600\">\n                  {entityConfig.description}\n                </Text>\n                {/* Stage Stepper */}\n                <HStack gap=\"2\" mt=\"2\" align=\"center\">\n                  {entityConfig.steps.map((s, idx) => (\n                    <Box key={s.id} h=\"8px\" flex=\"1\" borderRadius=\"full\" bg={idx + 1 <= currentStep ? \"orange.400\" : \"gray.200\"} />\n                  ))}\n                </HStack>\n              </VStack>\n              \n              <HStack gap=\"2\">\n                <Button variant=\"outline\" size=\"sm\" onClick={() => setShowProgress(!showProgress)} borderRadius=\"md\">\n                  <Icon as={FiEye} mr=\"2\" />\n                  {showProgress ? \"Hide\" : \"Show\"} Progress\n                </Button>\n                \n                <Button variant=\"outline\" size=\"sm\" onClick={() => setShowMessaging(!showMessaging)} borderRadius=\"md\">\n                  <Icon as={FiMessageSquare} mr=\"2\" />\n                  Messages\n                </Button>\n                \n                <Button variant=\"outline\" size=\"sm\" onClick={() => setShowOCR(!showOCR)} borderRadius=\"md\">\n                  <Icon as={FiZap} mr=\"2\" />\n                  OCR\n                </Button>\n                \n                <Button variant=\"outline\" size=\"sm\" onClick={handleSaveProgress} borderRadius=\"md\">\n                  <Icon as={FiSave} mr=\"2\" />\n                  Save Progress\n                </Button>\n              </HStack>\n            </HStack>\n          </Box>\n\n          {/* Progress Tracking */}\n          {showProgress && (\n            <ProgressTracking\n              config={entityConfig}\n              formData={formData}\n              currentStep={currentStep}\n              onStepClick={handleStepClick}\n              onSaveProgress={handleSaveProgress}\n              onResumeFromStep={handleResumeFromStep}\n              lastSaved={lastSaved ? lastSaved.toISOString() : undefined}\n              isDirty={isDirty}\n              isSaving={isSaving}\n            />\n          )}\n\n          {/* OCR Integration */}\n          {showOCR && (\n            <OCRIntegration\n              onDataExtracted={handleDataExtracted}\n              onDocumentProcessed={handleDocumentProcessed}\n              entityType={selectedEntityType}\n              documentType={entityConfig.steps[currentStep - 1]?.requiredDocuments[0] || 'certificate_incorporation'}\n            />\n          )}\n\n          {/* Main Form */}\n          <Box p=\"6\" bg=\"white\" borderRadius=\"lg\" boxShadow=\"sm\">\n            <EnhancedDynamicForm\n              config={entityConfig}\n              formData={formData}\n              onFieldChange={handleFieldChange}\n              onStepComplete={handleStepComplete}\n              currentStep={currentStep}\n              onNext={handleNext}\n              onPrevious={handlePrevious}\n              onSubmit={handleSubmit}\n              isLoading={isSubmitting}\n              validationErrors={validationErrors}\n              onFilesChange={(files) => setFileObjects(files)}\n            />\n          </Box>\n\n          {/* Contextual Messaging */}\n          {showMessaging && (\n            <Box p=\"6\" bg=\"white\" borderRadius=\"lg\" boxShadow=\"sm\" height=\"600px\">\n              <EnhancedContextualMessaging\n                conversations={[]}\n                messages={[]}\n                currentApplicationId={`APP-${Date.now()}`}\n                onSendMessage={handleSendMessage}\n                onReplyToMessage={handleReplyToMessage}\n                onForwardMessage={handleForwardMessage}\n                onStarMessage={handleStarMessage}\n                onArchiveConversation={handleArchiveConversation}\n                onAssignConversation={handleAssignConversation}\n                onTagConversation={handleTagConversation}\n                currentUser={{\n                  id: \"partner-1\",\n                  name: \"John Doe\",\n                  type: \"partner\"\n                }}\n                applicationSections={entityConfig.steps.map(step => ({\n                  id: step.id,\n                  title: step.title,\n                  fields: step.fields.map(field => ({\n                    id: field.id,\n                    label: field.label,\n                    value: formData[field.id]\n                  }))\n                }))}\n                applicationDocuments={[]}\n              />\n            </Box>\n          )}\n\n          {/* Save Error Alert */}\n          {saveError && (\n            <Box p=\"3\" borderRadius=\"md\" bg=\"red.50\" border=\"1px\" borderColor=\"red.200\">\n              <HStack gap=\"2\">\n                <Text fontWeight=\"semibold\">Save Error:</Text>\n                <Text color=\"gray.700\">{saveError}</Text>\n              </HStack>\n            </Box>\n          )}\n        </VStack>\n      </Container>\n    </Box>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}