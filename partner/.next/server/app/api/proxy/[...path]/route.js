"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/proxy/[...path]/route";
exports.ids = ["app/api/proxy/[...path]/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("buffer");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "dns/promises":
/*!*******************************!*\
  !*** external "dns/promises" ***!
  \*******************************/
/***/ ((module) => {

module.exports = require("dns/promises");

/***/ }),

/***/ "events":
/*!*************************!*\
  !*** external "events" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("events");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

module.exports = require("https");

/***/ }),

/***/ "net":
/*!**********************!*\
  !*** external "net" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("net");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stream");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("util");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("zlib");

/***/ }),

/***/ "node:assert":
/*!******************************!*\
  !*** external "node:assert" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("node:assert");

/***/ }),

/***/ "node:crypto":
/*!******************************!*\
  !*** external "node:crypto" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("node:crypto");

/***/ }),

/***/ "node:diagnostics_channel":
/*!*******************************************!*\
  !*** external "node:diagnostics_channel" ***!
  \*******************************************/
/***/ ((module) => {

module.exports = require("node:diagnostics_channel");

/***/ }),

/***/ "node:events":
/*!******************************!*\
  !*** external "node:events" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("node:events");

/***/ }),

/***/ "node:net":
/*!***************************!*\
  !*** external "node:net" ***!
  \***************************/
/***/ ((module) => {

module.exports = require("node:net");

/***/ }),

/***/ "node:timers/promises":
/*!***************************************!*\
  !*** external "node:timers/promises" ***!
  \***************************************/
/***/ ((module) => {

module.exports = require("node:timers/promises");

/***/ }),

/***/ "node:tls":
/*!***************************!*\
  !*** external "node:tls" ***!
  \***************************/
/***/ ((module) => {

module.exports = require("node:tls");

/***/ }),

/***/ "node:url":
/*!***************************!*\
  !*** external "node:url" ***!
  \***************************/
/***/ ((module) => {

module.exports = require("node:url");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fproxy%2F%5B...path%5D%2Froute&page=%2Fapi%2Fproxy%2F%5B...path%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fproxy%2F%5B...path%5D%2Froute.ts&appDir=%2FUsers%2Fmukurusystemsadministrator%2FDesktop%2Fonboarding_kyc%20copy%2Fpartner%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fmukurusystemsadministrator%2FDesktop%2Fonboarding_kyc%20copy%2Fpartner&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D!":
/*!*****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fproxy%2F%5B...path%5D%2Froute&page=%2Fapi%2Fproxy%2F%5B...path%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fproxy%2F%5B...path%5D%2Froute.ts&appDir=%2FUsers%2Fmukurusystemsadministrator%2FDesktop%2Fonboarding_kyc%20copy%2Fpartner%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fmukurusystemsadministrator%2FDesktop%2Fonboarding_kyc%20copy%2Fpartner&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_mukurusystemsadministrator_Desktop_onboarding_kyc_copy_partner_src_app_api_proxy_path_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/proxy/[...path]/route.ts */ \"(rsc)/./src/app/api/proxy/[...path]/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"standalone\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/proxy/[...path]/route\",\n        pathname: \"/api/proxy/[...path]\",\n        filename: \"route\",\n        bundlePath: \"app/api/proxy/[...path]/route\"\n    },\n    resolvedPagePath: \"/Users/mukurusystemsadministrator/Desktop/onboarding_kyc copy/partner/src/app/api/proxy/[...path]/route.ts\",\n    nextConfigOutput,\n    userland: _Users_mukurusystemsadministrator_Desktop_onboarding_kyc_copy_partner_src_app_api_proxy_path_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/proxy/[...path]/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZwcm94eSUyRiU1Qi4uLnBhdGglNUQlMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRnByb3h5JTJGJTVCLi4ucGF0aCU1RCUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRnByb3h5JTJGJTVCLi4ucGF0aCU1RCUyRnJvdXRlLnRzJmFwcERpcj0lMkZVc2VycyUyRm11a3VydXN5c3RlbXNhZG1pbmlzdHJhdG9yJTJGRGVza3RvcCUyRm9uYm9hcmRpbmdfa3ljJTIwY29weSUyRnBhcnRuZXIlMkZzcmMlMkZhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPSUyRlVzZXJzJTJGbXVrdXJ1c3lzdGVtc2FkbWluaXN0cmF0b3IlMkZEZXNrdG9wJTJGb25ib2FyZGluZ19reWMlMjBjb3B5JTJGcGFydG5lciZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD1zdGFuZGFsb25lJnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNjO0FBQzBEO0FBQ3ZJO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixnSEFBbUI7QUFDM0M7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxZQUFZO0FBQ1osQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLFFBQVEsaUVBQWlFO0FBQ3pFO0FBQ0E7QUFDQSxXQUFXLDRFQUFXO0FBQ3RCO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDdUg7O0FBRXZIIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbXVrdXJ1LWFwcC8/MDNjNyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBcHBSb3V0ZVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvYXBwLXJvdXRlL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IHBhdGNoRmV0Y2ggYXMgX3BhdGNoRmV0Y2ggfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvcGF0Y2gtZmV0Y2hcIjtcbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCIvVXNlcnMvbXVrdXJ1c3lzdGVtc2FkbWluaXN0cmF0b3IvRGVza3RvcC9vbmJvYXJkaW5nX2t5YyBjb3B5L3BhcnRuZXIvc3JjL2FwcC9hcGkvcHJveHkvWy4uLnBhdGhdL3JvdXRlLnRzXCI7XG4vLyBXZSBpbmplY3QgdGhlIG5leHRDb25maWdPdXRwdXQgaGVyZSBzbyB0aGF0IHdlIGNhbiB1c2UgdGhlbSBpbiB0aGUgcm91dGVcbi8vIG1vZHVsZS5cbmNvbnN0IG5leHRDb25maWdPdXRwdXQgPSBcInN0YW5kYWxvbmVcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvcHJveHkvWy4uLnBhdGhdL3JvdXRlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvcHJveHkvWy4uLnBhdGhdXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcInJvdXRlXCIsXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiYXBwL2FwaS9wcm94eS9bLi4ucGF0aF0vcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCIvVXNlcnMvbXVrdXJ1c3lzdGVtc2FkbWluaXN0cmF0b3IvRGVza3RvcC9vbmJvYXJkaW5nX2t5YyBjb3B5L3BhcnRuZXIvc3JjL2FwcC9hcGkvcHJveHkvWy4uLnBhdGhdL3JvdXRlLnRzXCIsXG4gICAgbmV4dENvbmZpZ091dHB1dCxcbiAgICB1c2VybGFuZFxufSk7XG4vLyBQdWxsIG91dCB0aGUgZXhwb3J0cyB0aGF0IHdlIG5lZWQgdG8gZXhwb3NlIGZyb20gdGhlIG1vZHVsZS4gVGhpcyBzaG91bGRcbi8vIGJlIGVsaW1pbmF0ZWQgd2hlbiB3ZSd2ZSBtb3ZlZCB0aGUgb3RoZXIgcm91dGVzIHRvIHRoZSBuZXcgZm9ybWF0LiBUaGVzZVxuLy8gYXJlIHVzZWQgdG8gaG9vayBpbnRvIHRoZSByb3V0ZS5cbmNvbnN0IHsgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MgfSA9IHJvdXRlTW9kdWxlO1xuY29uc3Qgb3JpZ2luYWxQYXRobmFtZSA9IFwiL2FwaS9wcm94eS9bLi4ucGF0aF0vcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fproxy%2F%5B...path%5D%2Froute&page=%2Fapi%2Fproxy%2F%5B...path%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fproxy%2F%5B...path%5D%2Froute.ts&appDir=%2FUsers%2Fmukurusystemsadministrator%2FDesktop%2Fonboarding_kyc%20copy%2Fpartner%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fmukurusystemsadministrator%2FDesktop%2Fonboarding_kyc%20copy%2Fpartner&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./src/app/api/proxy/[...path]/route.ts":
/*!**********************************************!*\
  !*** ./src/app/api/proxy/[...path]/route.ts ***!
  \**********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   DELETE: () => (/* binding */ DELETE),\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   OPTIONS: () => (/* binding */ OPTIONS),\n/* harmony export */   PATCH: () => (/* binding */ PATCH),\n/* harmony export */   POST: () => (/* binding */ POST),\n/* harmony export */   PUT: () => (/* binding */ PUT)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var next_auth_jwt__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next-auth/jwt */ \"(rsc)/./node_modules/next-auth/jwt/index.js\");\n/* harmony import */ var next_auth_jwt__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(next_auth_jwt__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _lib_redis_session__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/redis-session */ \"(rsc)/./src/lib/redis-session.ts\");\n\n\n\nconst DEFAULT_TARGET = process.env.PROXY_TARGET || \"http://localhost:8090\";\nconst MESSAGING_TARGET = process.env.PROXY_TARGET_MESSAGING || process.env.MESSAGING_TARGET || \"http://localhost:8087\";\nconst PROJECTIONS_TARGET = process.env.PROXY_TARGET_PROJECTIONS || process.env.PROJECTIONS_TARGET || \"http://localhost:8007\";\nconst ONBOARDING_TARGET = process.env.PROXY_TARGET_ONBOARDING || process.env.ONBOARDING_TARGET || \"http://localhost:8001\";\nconst DOCUMENT_TARGET = process.env.PROXY_TARGET_DOCUMENT || process.env.DOCUMENT_TARGET || \"http://localhost:8008\";\nconst AUTH_TARGET = process.env.PROXY_TARGET_AUTH || process.env.AUTH_TARGET || \"http://localhost:8090\";\nfunction resolveUpstream(pathname, search) {\n    // Supports service-specific proxying by prefixing the path after /api/proxy\n    // Examples:\n    //  - /api/proxy/messaging/api/v1/messages -> PROXY_TARGET_MESSAGING\n    //  - /api/proxy/projections/api/v1/* -> PROXY_TARGET_PROJECTIONS\n    //  - /api/proxy/... -> DEFAULT_TARGET\n    const afterProxy = pathname.split(\"/api/proxy\")[1] || \"\";\n    if (afterProxy.startsWith(\"/messaging\")) {\n        const trimmed = afterProxy.replace(\"/messaging\", \"\");\n        return `${MESSAGING_TARGET}${trimmed}${search}`;\n    }\n    if (afterProxy.startsWith(\"/projections/v1\")) {\n        const trimmed = afterProxy.replace(\"/projections/v1\", \"\");\n        return `${PROJECTIONS_TARGET}${trimmed}${search}`;\n    }\n    if (afterProxy.startsWith(\"/projections\")) {\n        const trimmed = afterProxy.replace(\"/projections\", \"\");\n        return `${PROJECTIONS_TARGET}${trimmed}${search}`;\n    }\n    // Route /api/users/* to authentication service\n    if (afterProxy.startsWith(\"/api/users\")) {\n        return `${AUTH_TARGET}${afterProxy}${search}`;\n    }\n    // Route /api/v1/cases/* to onboarding API\n    if (afterProxy.startsWith(\"/api/v1/cases\")) {\n        return `${ONBOARDING_TARGET}${afterProxy}${search}`;\n    }\n    // Route /api/v1/documents/* to document service\n    if (afterProxy.startsWith(\"/api/v1/documents\")) {\n        return `${DOCUMENT_TARGET}${afterProxy}${search}`;\n    }\n    // Route /api/v1/sync to projections API (for syncing cases)\n    if (afterProxy.startsWith(\"/api/v1/sync\")) {\n        return `${PROJECTIONS_TARGET}${afterProxy}${search}`;\n    }\n    return `${DEFAULT_TARGET}${afterProxy}${search}`;\n}\nasync function forward(req) {\n    const url = resolveUpstream(req.nextUrl.pathname, req.nextUrl.search);\n    // Debug logging for document uploads\n    if (req.nextUrl.pathname.includes(\"/documents/upload\")) {\n        console.log(`[Proxy] Document upload request - routing to: ${url}`);\n    }\n    const headers = {};\n    // Get NextAuth session token from cookie\n    let accessToken = null;\n    try {\n        const token = await (0,next_auth_jwt__WEBPACK_IMPORTED_MODULE_1__.getToken)({\n            req,\n            secret: process.env.NEXTAUTH_SECRET\n        });\n        if (token?.sessionId) {\n            // Fetch tokens from Redis using sessionId\n            const tokenSession = await (0,_lib_redis_session__WEBPACK_IMPORTED_MODULE_2__.getTokenSession)(token.sessionId);\n            if (tokenSession) {\n                // Check if token needs refresh (within 60 seconds of expiry)\n                if (tokenSession.accessTokenExpiryTime && Date.now() < tokenSession.accessTokenExpiryTime - 60 * 1000) {\n                    accessToken = tokenSession.accessToken;\n                } else {\n                    // Token expired or expiring soon - would need refresh logic here\n                    // For now, use the token anyway and let backend handle 401\n                    accessToken = tokenSession.accessToken;\n                }\n            }\n        }\n    } catch (error) {\n        console.warn(\"Failed to get token from session:\", error);\n    // Continue without token - backend will return 401 if auth required\n    }\n    // Inject Authorization header from Redis-stored token (do NOT forward from client)\n    if (accessToken) {\n        headers[\"authorization\"] = `Bearer ${accessToken}`;\n        headers[\"Authorization\"] = `Bearer ${accessToken}`;\n    }\n    const contentType = req.headers.get(\"content-type\") || req.headers.get(\"Content-Type\");\n    if (contentType) {\n        headers[\"content-type\"] = contentType;\n        headers[\"Content-Type\"] = contentType;\n    } else {\n        // Only set default JSON content-type if not multipart/form-data\n        if (!contentType?.includes(\"multipart/form-data\")) {\n            headers[\"content-type\"] = \"application/json\";\n            headers[\"Content-Type\"] = \"application/json\";\n        }\n    }\n    // Forward user identification headers to backend services\n    const userHeaders = [\n        \"X-User-Id\",\n        \"X-User-Email\",\n        \"X-User-Name\",\n        \"X-User-Role\"\n    ];\n    for (const headerName of userHeaders){\n        const value = req.headers.get(headerName) || req.headers.get(headerName.toLowerCase());\n        if (value) {\n            headers[headerName] = value;\n            headers[headerName.toLowerCase()] = value; // Also set lowercase for compatibility\n        }\n    }\n    // Forward schema-driven form headers (CRITICAL for dynamic validation)\n    const schemaHeaders = [\n        \"X-Entity-Type\",\n        \"X-Form-Config-Id\",\n        \"X-Form-Version\"\n    ];\n    for (const headerName of schemaHeaders){\n        const value = req.headers.get(headerName) || req.headers.get(headerName.toLowerCase());\n        if (value) {\n            headers[headerName] = value;\n            headers[headerName.toLowerCase()] = value; // Also set lowercase for compatibility\n            console.log(`[Proxy] Forwarding ${headerName}: ${value}`);\n        }\n    }\n    // Add additional headers for better debugging\n    headers[\"user-agent\"] = \"NextJS-Proxy/1.0\";\n    // Handle request body\n    let body;\n    if ([\n        \"GET\",\n        \"HEAD\"\n    ].includes(req.method)) {\n        body = undefined;\n    } else if (contentType?.includes(\"multipart/form-data\")) {\n        // For file uploads, parse FormData and reconstruct it\n        // This preserves the multipart structure that the backend expects\n        const formData = await req.formData();\n        body = formData;\n        // Remove Content-Type header - fetch will set it with the correct boundary\n        delete headers[\"content-type\"];\n        delete headers[\"Content-Type\"];\n    } else {\n        // For JSON and other text-based content, read as text\n        body = await req.text();\n    }\n    const init = {\n        method: req.method,\n        headers,\n        body,\n        redirect: \"manual\"\n    };\n    try {\n        const res = await fetch(url, init);\n        const body = await res.arrayBuffer();\n        const respHeaders = new Headers();\n        res.headers.forEach((v, k)=>respHeaders.set(k, v));\n        // ensure CORS for browser even though this is same-origin\n        respHeaders.set(\"Access-Control-Allow-Origin\", \"*\");\n        respHeaders.set(\"Access-Control-Allow-Methods\", \"GET, POST, PUT, DELETE, OPTIONS, PATCH\");\n        respHeaders.set(\"Access-Control-Allow-Headers\", \"Content-Type, Authorization, X-User-Id, X-User-Email, X-User-Name, X-User-Role, X-Entity-Type, X-Form-Config-Id, X-Form-Version, X-Request-Id\");\n        return new next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse(body, {\n            status: res.status,\n            headers: respHeaders\n        });\n    } catch (error) {\n        console.error(\"[Proxy] Error:\", error, \"URL:\", url);\n        const errorMessage = error instanceof Error ? error.message : \"Unknown error\";\n        // If it's a connection error, provide more helpful message\n        if (errorMessage.includes(\"ECONNREFUSED\") || errorMessage.includes(\"fetch failed\") || errorMessage.includes(\"ECONNREFUSED\")) {\n            console.error(`[Proxy] Connection failed to ${url} - service may not be running`);\n            return new next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse(JSON.stringify({\n                error: \"Backend service unavailable\",\n                details: `Cannot connect to ${url}. Please ensure the backend service is running.`,\n                originalError: errorMessage\n            }), {\n                status: 503,\n                headers: {\n                    \"Content-Type\": \"application/json\"\n                }\n            });\n        }\n        return new next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse(JSON.stringify({\n            error: \"Proxy request failed\",\n            details: errorMessage\n        }), {\n            status: 502,\n            headers: {\n                \"Content-Type\": \"application/json\"\n            }\n        });\n    }\n}\nconst GET = forward;\nconst POST = forward;\nconst PUT = forward;\nconst PATCH = forward;\nconst DELETE = forward;\nconst OPTIONS = forward;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYXBwL2FwaS9wcm94eS9bLi4ucGF0aF0vcm91dGUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7OztBQUF3RDtBQUNmO0FBQ2E7QUFFdEQsTUFBTUcsaUJBQWlCQyxRQUFRQyxHQUFHLENBQUNDLFlBQVksSUFBSTtBQUNuRCxNQUFNQyxtQkFBbUJILFFBQVFDLEdBQUcsQ0FBQ0csc0JBQXNCLElBQUlKLFFBQVFDLEdBQUcsQ0FBQ0UsZ0JBQWdCLElBQUk7QUFDL0YsTUFBTUUscUJBQXFCTCxRQUFRQyxHQUFHLENBQUNLLHdCQUF3QixJQUFJTixRQUFRQyxHQUFHLENBQUNJLGtCQUFrQixJQUFJO0FBQ3JHLE1BQU1FLG9CQUFvQlAsUUFBUUMsR0FBRyxDQUFDTyx1QkFBdUIsSUFBSVIsUUFBUUMsR0FBRyxDQUFDTSxpQkFBaUIsSUFBSTtBQUNsRyxNQUFNRSxrQkFBa0JULFFBQVFDLEdBQUcsQ0FBQ1MscUJBQXFCLElBQUlWLFFBQVFDLEdBQUcsQ0FBQ1EsZUFBZSxJQUFJO0FBQzVGLE1BQU1FLGNBQWNYLFFBQVFDLEdBQUcsQ0FBQ1csaUJBQWlCLElBQUlaLFFBQVFDLEdBQUcsQ0FBQ1UsV0FBVyxJQUFJO0FBRWhGLFNBQVNFLGdCQUFnQkMsUUFBZ0IsRUFBRUMsTUFBYztJQUN2RCw0RUFBNEU7SUFDNUUsWUFBWTtJQUNaLG9FQUFvRTtJQUNwRSxpRUFBaUU7SUFDakUsc0NBQXNDO0lBQ3RDLE1BQU1DLGFBQWFGLFNBQVNHLEtBQUssQ0FBQyxhQUFhLENBQUMsRUFBRSxJQUFJO0lBRXRELElBQUlELFdBQVdFLFVBQVUsQ0FBQyxlQUFlO1FBQ3ZDLE1BQU1DLFVBQVVILFdBQVdJLE9BQU8sQ0FBQyxjQUFjO1FBQ2pELE9BQU8sQ0FBQyxFQUFFakIsaUJBQWlCLEVBQUVnQixRQUFRLEVBQUVKLE9BQU8sQ0FBQztJQUNqRDtJQUVBLElBQUlDLFdBQVdFLFVBQVUsQ0FBQyxvQkFBb0I7UUFDNUMsTUFBTUMsVUFBVUgsV0FBV0ksT0FBTyxDQUFD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QU8sSUFBSTNCLHFEQUFZQSxDQUFDdUUsS0FBS0MsU0FBUyxDQUFDO2dCQUNyQzlCLE9BQU87Z0JBQ1ArQixTQUFTLENBQUMsa0JBQWtCLEVBQUU5QyxJQUFJLCtDQUErQyxDQUFDO2dCQUNsRitDLGVBQWVOO1lBQ2pCLElBQUk7Z0JBQ0ZELFFBQVE7Z0JBQ1JuQyxTQUFTO29CQUFFLGdCQUFnQjtnQkFBbUI7WUFDaEQ7UUFDRjtRQUVBLE9BQU8sSUFBSWhDLHFEQUFZQSxDQUFDdUUsS0FBS0MsU0FBUyxDQUFDO1lBQUU5QixPQUFPO1lBQXdCK0IsU0FBU0w7UUFBYSxJQUFJO1lBQ2hHRCxRQUFRO1lBQ1JuQyxTQUFTO2dCQUFFLGdCQUFnQjtZQUFtQjtRQUNoRDtJQUNGO0FBQ0Y7QUFFTyxNQUFNMkMsTUFBTWxELFFBQVE7QUFDcEIsTUFBTW1ELE9BQU9uRCxRQUFRO0FBQ3JCLE1BQU1vRCxNQUFNcEQsUUFBUTtBQUNwQixNQUFNcUQsUUFBUXJELFFBQVE7QUFDdEIsTUFBTXNELFNBQVN0RCxRQUFRO0FBQ3ZCLE1BQU11RCxVQUFVdkQsUUFBUSIsInNvdXJjZXMiOlsid2VicGFjazovL211a3VydS1hcHAvLi9zcmMvYXBwL2FwaS9wcm94eS9bLi4ucGF0aF0vcm91dGUudHM/YjRlMiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0UmVxdWVzdCwgTmV4dFJlc3BvbnNlIH0gZnJvbSAnbmV4dC9zZXJ2ZXInO1xuaW1wb3J0IHsgZ2V0VG9rZW4gfSBmcm9tICduZXh0LWF1dGgvand0JztcbmltcG9ydCB7IGdldFRva2VuU2Vzc2lvbiB9IGZyb20gJ0AvbGliL3JlZGlzLXNlc3Npb24nO1xuXG5jb25zdCBERUZBVUxUX1RBUkdFVCA9IHByb2Nlc3MuZW52LlBST1hZX1RBUkdFVCB8fCAnaHR0cDovL2xvY2FsaG9zdDo4MDkwJztcbmNvbnN0IE1FU1NBR0lOR19UQVJHRVQgPSBwcm9jZXNzLmVudi5QUk9YWV9UQVJHRVRfTUVTU0FHSU5HIHx8IHByb2Nlc3MuZW52Lk1FU1NBR0lOR19UQVJHRVQgfHwgJ2h0dHA6Ly9sb2NhbGhvc3Q6ODA4Nyc7XG5jb25zdCBQUk9KRUNUSU9OU19UQVJHRVQgPSBwcm9jZXNzLmVudi5QUk9YWV9UQVJHRVRfUFJPSkVDVElPTlMgfHwgcHJvY2Vzcy5lbnYuUFJPSkVDVElPTlNfVEFSR0VUIHx8ICdodHRwOi8vbG9jYWxob3N0OjgwMDcnO1xuY29uc3QgT05CT0FSRElOR19UQVJHRVQgPSBwcm9jZXNzLmVudi5QUk9YWV9UQVJHRVRfT05CT0FSRElORyB8fCBwcm9jZXNzLmVudi5PTkJPQVJESU5HX1RBUkdFVCB8fCAnaHR0cDovL2xvY2FsaG9zdDo4MDAxJztcbmNvbnN0IERPQ1VNRU5UX1RBUkdFVCA9IHByb2Nlc3MuZW52LlBST1hZX1RBUkdFVF9ET0NVTUVOVCB8fCBwcm9jZXNzLmVudi5ET0NVTUVOVF9UQVJHRVQgfHwgJ2h0dHA6Ly9sb2NhbGhvc3Q6ODAwOCc7XG5jb25zdCBBVVRIX1RBUkdFVCA9IHByb2Nlc3MuZW52LlBST1hZX1RBUkdFVF9BVVRIIHx8IHByb2Nlc3MuZW52LkFVVEhfVEFSR0VUIHx8ICdodHRwOi8vbG9jYWxob3N0OjgwOTAnO1xuXG5mdW5jdGlvbiByZXNvbHZlVXBzdHJlYW0ocGF0aG5hbWU6IHN0cmluZywgc2VhcmNoOiBzdHJpbmcpIHtcbiAgLy8gU3VwcG9ydHMgc2VydmljZS1zcGVjaWZpYyBwcm94eWluZyBieSBwcmVmaXhpbmcgdGhlIHBhdGggYWZ0ZXIgL2FwaS9wcm94eVxuICAvLyBFeGFtcGxlczpcbiAgLy8gIC0gL2FwaS9wcm94eS9tZXNzYWdpbmcvYXBpL3YxL21lc3NhZ2VzIC0+IFBST1hZX1RBUkdFVF9NRVNTQUdJTkdcbiAgLy8gIC0gL2FwaS9wcm94eS9wcm9qZWN0aW9ucy9hcGkvdjEvKiAtPiBQUk9YWV9UQVJHRVRfUFJPSkVDVElPTlNcbiAgLy8gIC0gL2FwaS9wcm94eS8uLi4gLT4gREVGQVVMVF9UQVJHRVRcbiAgY29uc3QgYWZ0ZXJQcm94eSA9IHBhdGhuYW1lLnNwbGl0KCcvYXBpL3Byb3h5JylbMV0gfHwgJyc7XG5cbiAgaWYgKGFmdGVyUHJveHkuc3RhcnRzV2l0aCgnL21lc3NhZ2luZycpKSB7XG4gICAgY29uc3QgdHJpbW1lZCA9IGFmdGVyUHJveHkucmVwbGFjZSgnL21lc3NhZ2luZycsICcnKTtcbiAgICByZXR1cm4gYCR7TUVTU0FHSU5HX1RBUkdFVH0ke3RyaW1tZWR9JHtzZWFyY2h9YDtcbiAgfVxuXG4gIGlmIChhZnRlclByb3h5LnN0YXJ0c1dpdGgoJy9wcm9qZWN0aW9ucy92MScpKSB7XG4gICAgY29uc3QgdHJpbW1lZCA9IGFmdGVyUHJveHkucmVwbGFjZSgnL3Byb2plY3Rpb25zL3YxJywgJycpO1xuICAgIHJldHVybiBgJHtQUk9KRUNUSU9OU19UQVJHRVR9JHt0cmltbWVkfSR7c2VhcmNofWA7XG4gIH1cbiAgXG4gIGlmIChhZnRlclByb3h5LnN0YXJ0c1dpdGgoJy9wcm9qZWN0aW9ucycpKSB7XG4gICAgY29uc3QgdHJpbW1lZCA9IGFmdGVyUHJveHkucmVwbGFjZSgnL3Byb2plY3Rpb25zJywgJycpO1xuICAgIHJldHVybiBgJHtQUk9KRUNUSU9OU19UQVJHRVR9JHt0cmltbWVkfSR7c2VhcmNofWA7XG4gIH1cblxuICAvLyBSb3V0ZSAvYXBpL3VzZXJzLyogdG8gYXV0aGVudGljYXRpb24gc2VydmljZVxuICBpZiAoYWZ0ZXJQcm94eS5zdGFydHNXaXRoKCcvYXBpL3VzZXJzJykpIHtcbiAgICByZXR1cm4gYCR7QVVUSF9UQVJHRVR9JHthZnRlclByb3h5fSR7c2VhcmNofWA7XG4gIH1cblxuICAvLyBSb3V0ZSAvYXBpL3YxL2Nhc2VzLyogdG8gb25ib2FyZGluZyBBUElcbiAgaWYgKGFmdGVyUHJveHkuc3RhcnRzV2l0aCgnL2FwaS92MS9jYXNlcycpKSB7XG4gICAgcmV0dXJuIGAke09OQk9BUkRJTkdfVEFSR0VUfSR7YWZ0ZXJQcm94eX0ke3NlYXJjaH1gO1xuICB9XG5cbiAgLy8gUm91dGUgL2FwaS92MS9kb2N1bWVudHMvKiB0byBkb2N1bWVudCBzZXJ2aWNlXG4gIGlmIChhZnRlclByb3h5LnN0YXJ0c1dpdGgoJy9hcGkvdjEvZG9jdW1lbnRzJykpIHtcbiAgICByZXR1cm4gYCR7RE9DVU1FTlRfVEFSR0VUfSR7YWZ0ZXJQcm94eX0ke3NlYXJjaH1gO1xuICB9XG5cbiAgLy8gUm91dGUgL2FwaS92MS9zeW5jIHRvIHByb2plY3Rpb25zIEFQSSAoZm9yIHN5bmNpbmcgY2FzZXMpXG4gIGlmIChhZnRlclByb3h5LnN0YXJ0c1dpdGgoJy9hcGkvdjEvc3luYycpKSB7XG4gICAgcmV0dXJuIGAke1BST0pFQ1RJT05TX1RBUkdFVH0ke2FmdGVyUHJveHl9JHtzZWFyY2h9YDtcbiAgfVxuXG4gIHJldHVybiBgJHtERUZBVUxUX1RBUkdFVH0ke2FmdGVyUHJveHl9JHtzZWFyY2h9YDtcbn1cblxuYXN5bmMgZnVuY3Rpb24gZm9yd2FyZChyZXE6IE5leHRSZXF1ZXN0KSB7XG4gIGNvbnN0IHVybCA9IHJlc29sdmVVcHN0cmVhbShyZXEubmV4dFVybC5wYXRobmFtZSwgcmVxLm5leHRVcmwuc2VhcmNoKTtcbiAgXG4gIC8vIERlYnVnIGxvZ2dpbmcgZm9yIGRvY3VtZW50IHVwbG9hZHNcbiAgaWYgKHJlcS5uZXh0VXJsLnBhdGhuYW1lLmluY2x1ZGVzKCcvZG9jdW1lbnRzL3VwbG9hZCcpKSB7XG4gICAgY29uc29sZS5sb2coYFtQcm94eV0gRG9jdW1lbnQgdXBsb2FkIHJlcXVlc3QgLSByb3V0aW5nIHRvOiAke3VybH1gKTtcbiAgfVxuXG4gIGNvbnN0IGhlYWRlcnM6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7fTtcbiAgXG4gIC8vIEdldCBOZXh0QXV0aCBzZXNzaW9uIHRva2VuIGZyb20gY29va2llXG4gIGxldCBhY2Nlc3NUb2tlbjogc3RyaW5nIHwgbnVsbCA9IG51bGw7XG4gIHRyeSB7XG4gICAgY29uc3QgdG9rZW4gPSBhd2FpdCBnZXRUb2tlbih7IHJlcSwgc2VjcmV0OiBwcm9jZXNzLmVudi5ORVhUQVVUSF9TRUNSRVQgfSk7XG4gICAgaWYgKHRva2VuPy5zZXNzaW9uSWQpIHtcbiAgICAgIC8vIEZldGNoIHRva2VucyBmcm9tIFJlZGlzIHVzaW5nIHNlc3Npb25JZFxuICAgICAgY29uc3QgdG9rZW5TZXNzaW9uID0gYXdhaXQgZ2V0VG9rZW5TZXNzaW9uKHRva2VuLnNlc3Npb25JZCBhcyBzdHJpbmcpO1xuICAgICAgaWYgKHRva2VuU2Vzc2lvbikge1xuICAgICAgICAvLyBDaGVjayBpZiB0b2tlbiBuZWVkcyByZWZyZXNoICh3aXRoaW4gNjAgc2Vjb25kcyBvZiBleHBpcnkpXG4gICAgICAgIGlmICh0b2tlblNlc3Npb24uYWNjZXNzVG9rZW5FeHBpcnlUaW1lICYmIERhdGUubm93KCkgPCB0b2tlblNlc3Npb24uYWNjZXNzVG9rZW5FeHBpcnlUaW1lIC0gNjAgKiAxMDAwKSB7XG4gICAgICAgICAgYWNjZXNzVG9rZW4gPSB0b2tlblNlc3Npb24uYWNjZXNzVG9rZW47XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgLy8gVG9rZW4gZXhwaXJlZCBvciBleHBpcmluZyBzb29uIC0gd291bGQgbmVlZCByZWZyZXNoIGxvZ2ljIGhlcmVcbiAgICAgICAgICAvLyBGb3Igbm93LCB1c2UgdGhlIHRva2VuIGFueXdheSBhbmQgbGV0IGJhY2tlbmQgaGFuZGxlIDQwMVxuICAgICAgICAgIGFjY2Vzc1Rva2VuID0gdG9rZW5TZXNzaW9uLmFjY2Vzc1Rva2VuO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUud2FybignRmFpbGVkIHRvIGdldCB0b2tlbiBmcm9tIHNlc3Npb246JywgZXJyb3IpO1xuICAgIC8vIENvbnRpbnVlIHdpdGhvdXQgdG9rZW4gLSBiYWNrZW5kIHdpbGwgcmV0dXJuIDQwMSBpZiBhdXRoIHJlcXVpcmVkXG4gIH1cbiAgXG4gIC8vIEluamVjdCBBdXRob3JpemF0aW9uIGhlYWRlciBmcm9tIFJlZGlzLXN0b3JlZCB0b2tlbiAoZG8gTk9UIGZvcndhcmQgZnJvbSBjbGllbnQpXG4gIGlmIChhY2Nlc3NUb2tlbikge1xuICAgIGhlYWRlcnNbJ2F1dGhvcml6YXRpb24nXSA9IGBCZWFyZXIgJHthY2Nlc3NUb2tlbn1gO1xuICAgIGhlYWRlcnNbJ0F1dGhvcml6YXRpb24nXSA9IGBCZWFyZXIgJHthY2Nlc3NUb2tlbn1gO1xuICB9XG4gIFxuICBjb25zdCBjb250ZW50VHlwZSA9IHJlcS5oZWFkZXJzLmdldCgnY29udGVudC10eXBlJykgfHwgcmVxLmhlYWRlcnMuZ2V0KCdDb250ZW50LVR5cGUnKTtcbiAgaWYgKGNvbnRlbnRUeXBlKSB7XG4gICAgaGVhZGVyc1snY29udGVudC10eXBlJ10gPSBjb250ZW50VHlwZTtcbiAgICBoZWFkZXJzWydDb250ZW50LVR5cGUnXSA9IGNvbnRlbnRUeXBlO1xuICB9IGVsc2Uge1xuICAgIC8vIE9ubHkgc2V0IGRlZmF1bHQgSlNPTiBjb250ZW50LXR5cGUgaWYgbm90IG11bHRpcGFydC9mb3JtLWRhdGFcbiAgICBpZiAoIWNvbnRlbnRUeXBlPy5pbmNsdWRlcygnbXVsdGlwYXJ0L2Zvcm0tZGF0YScpKSB7XG4gICAgICBoZWFkZXJzWydjb250ZW50LXR5cGUnXSA9ICdhcHBsaWNhdGlvbi9qc29uJztcbiAgICAgIGhlYWRlcnNbJ0NvbnRlbnQtVHlwZSddID0gJ2FwcGxpY2F0aW9uL2pzb24nO1xuICAgIH1cbiAgfVxuXG4gIC8vIEZvcndhcmQgdXNlciBpZGVudGlmaWNhdGlvbiBoZWFkZXJzIHRvIGJhY2tlbmQgc2VydmljZXNcbiAgY29uc3QgdXNlckhlYWRlcnMgPSBbJ1gtVXNlci1JZCcsICdYLVVzZXItRW1haWwnLCAnWC1Vc2VyLU5hbWUnLCAnWC1Vc2VyLVJvbGUnXTtcbiAgZm9yIChjb25zdCBoZWFkZXJOYW1lIG9mIHVzZXJIZWFkZXJzKSB7XG4gICAgY29uc3QgdmFsdWUgPSByZXEuaGVhZGVycy5nZXQoaGVhZGVyTmFtZSkgfHwgcmVxLmhlYWRlcnMuZ2V0KGhlYWRlck5hbWUudG9Mb3dlckNhc2UoKSk7XG4gICAgaWYgKHZhbHVlKSB7XG4gICAgICBoZWFkZXJzW2hlYWRlck5hbWVdID0gdmFsdWU7XG4gICAgICBoZWFkZXJzW2hlYWRlck5hbWUudG9Mb3dlckNhc2UoKV0gPSB2YWx1ZTsgLy8gQWxzbyBzZXQgbG93ZXJjYXNlIGZvciBjb21wYXRpYmlsaXR5XG4gICAgfVxuICB9XG5cbiAgLy8gRm9yd2FyZCBzY2hlbWEtZHJpdmVuIGZvcm0gaGVhZGVycyAoQ1JJVElDQUwgZm9yIGR5bmFtaWMgdmFsaWRhdGlvbilcbiAgY29uc3Qgc2NoZW1hSGVhZGVycyA9IFsnWC1FbnRpdHktVHlwZScsICdYLUZvcm0tQ29uZmlnLUlkJywgJ1gtRm9ybS1WZXJzaW9uJ107XG4gIGZvciAoY29uc3QgaGVhZGVyTmFtZSBvZiBzY2hlbWFIZWFkZXJzKSB7XG4gICAgY29uc3QgdmFsdWUgPSByZXEuaGVhZGVycy5nZXQoaGVhZGVyTmFtZSkgfHwgcmVxLmhlYWRlcnMuZ2V0KGhlYWRlck5hbWUudG9Mb3dlckNhc2UoKSk7XG4gICAgaWYgKHZhbHVlKSB7XG4gICAgICBoZWFkZXJzW2hlYWRlck5hbWVdID0gdmFsdWU7XG4gICAgICBoZWFkZXJzW2hlYWRlck5hbWUudG9Mb3dlckNhc2UoKV0gPSB2YWx1ZTsgLy8gQWxzbyBzZXQgbG93ZXJjYXNlIGZvciBjb21wYXRpYmlsaXR5XG4gICAgICBjb25zb2xlLmxvZyhgW1Byb3h5XSBGb3J3YXJkaW5nICR7aGVhZGVyTmFtZX06ICR7dmFsdWV9YCk7XG4gICAgfVxuICB9XG5cbiAgLy8gQWRkIGFkZGl0aW9uYWwgaGVhZGVycyBmb3IgYmV0dGVyIGRlYnVnZ2luZ1xuICBoZWFkZXJzWyd1c2VyLWFnZW50J10gPSAnTmV4dEpTLVByb3h5LzEuMCc7XG5cbiAgLy8gSGFuZGxlIHJlcXVlc3QgYm9keVxuICBsZXQgYm9keTogQm9keUluaXQgfCB1bmRlZmluZWQ7XG4gIGlmIChbJ0dFVCcsICdIRUFEJ10uaW5jbHVkZXMocmVxLm1ldGhvZCkpIHtcbiAgICBib2R5ID0gdW5kZWZpbmVkO1xuICB9IGVsc2UgaWYgKGNvbnRlbnRUeXBlPy5pbmNsdWRlcygnbXVsdGlwYXJ0L2Zvcm0tZGF0YScpKSB7XG4gICAgLy8gRm9yIGZpbGUgdXBsb2FkcywgcGFyc2UgRm9ybURhdGEgYW5kIHJlY29uc3RydWN0IGl0XG4gICAgLy8gVGhpcyBwcmVzZXJ2ZXMgdGhlIG11bHRpcGFydCBzdHJ1Y3R1cmUgdGhhdCB0aGUgYmFja2VuZCBleHBlY3RzXG4gICAgY29uc3QgZm9ybURhdGEgPSBhd2FpdCByZXEuZm9ybURhdGEoKTtcbiAgICBib2R5ID0gZm9ybURhdGE7XG4gICAgLy8gUmVtb3ZlIENvbnRlbnQtVHlwZSBoZWFkZXIgLSBmZXRjaCB3aWxsIHNldCBpdCB3aXRoIHRoZSBjb3JyZWN0IGJvdW5kYXJ5XG4gICAgZGVsZXRlIGhlYWRlcnNbJ2NvbnRlbnQtdHlwZSddO1xuICAgIGRlbGV0ZSBoZWFkZXJzWydDb250ZW50LVR5cGUnXTtcbiAgfSBlbHNlIHtcbiAgICAvLyBGb3IgSlNPTiBhbmQgb3RoZXIgdGV4dC1iYXNlZCBjb250ZW50LCByZWFkIGFzIHRleHRcbiAgICBib2R5ID0gYXdhaXQgcmVxLnRleHQoKTtcbiAgfVxuXG4gIGNvbnN0IGluaXQ6IFJlcXVlc3RJbml0ID0ge1xuICAgIG1ldGhvZDogcmVxLm1ldGhvZCxcbiAgICBoZWFkZXJzLFxuICAgIGJvZHksXG4gICAgcmVkaXJlY3Q6ICdtYW51YWwnXG4gIH07XG5cbiAgdHJ5IHtcbiAgICBjb25zdCByZXMgPSBhd2FpdCBmZXRjaCh1cmwsIGluaXQpO1xuICAgIGNvbnN0IGJvZHkgPSBhd2FpdCByZXMuYXJyYXlCdWZmZXIoKTtcblxuICAgIGNvbnN0IHJlc3BIZWFkZXJzID0gbmV3IEhlYWRlcnMoKTtcbiAgICByZXMuaGVhZGVycy5mb3JFYWNoKCh2LCBrKSA9PiByZXNwSGVhZGVycy5zZXQoaywgdikpO1xuICAgIC8vIGVuc3VyZSBDT1JTIGZvciBicm93c2VyIGV2ZW4gdGhvdWdoIHRoaXMgaXMgc2FtZS1vcmlnaW5cbiAgICByZXNwSGVhZGVycy5zZXQoJ0FjY2Vzcy1Db250cm9sLUFsbG93LU9yaWdpbicsICcqJyk7XG4gICAgcmVzcEhlYWRlcnMuc2V0KCdBY2Nlc3MtQ29udHJvbC1BbGxvdy1NZXRob2RzJywgJ0dFVCwgUE9TVCwgUFVULCBERUxFVEUsIE9QVElPTlMsIFBBVENIJyk7XG4gICAgcmVzcEhlYWRlcnMuc2V0KCdBY2Nlc3MtQ29udHJvbC1BbGxvdy1IZWFkZXJzJywgJ0NvbnRlbnQtVHlwZSwgQXV0aG9yaXphdGlvbiwgWC1Vc2VyLUlkLCBYLVVzZXItRW1haWwsIFgtVXNlci1OYW1lLCBYLVVzZXItUm9sZSwgWC1FbnRpdHktVHlwZSwgWC1Gb3JtLUNvbmZpZy1JZCwgWC1Gb3JtLVZlcnNpb24sIFgtUmVxdWVzdC1JZCcpO1xuXG4gICAgcmV0dXJuIG5ldyBOZXh0UmVzcG9uc2UoYm9keSwgeyBzdGF0dXM6IHJlcy5zdGF0dXMsIGhlYWRlcnM6IHJlc3BIZWFkZXJzIH0pO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ1tQcm94eV0gRXJyb3I6JywgZXJyb3IsICdVUkw6JywgdXJsKTtcbiAgICBjb25zdCBlcnJvck1lc3NhZ2UgPSBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJztcbiAgICBcbiAgICAvLyBJZiBpdCdzIGEgY29ubmVjdGlvbiBlcnJvciwgcHJvdmlkZSBtb3JlIGhlbHBmdWwgbWVzc2FnZVxuICAgIGlmIChlcnJvck1lc3NhZ2UuaW5jbHVkZXMoJ0VDT05OUkVGVVNFRCcpIHx8IGVycm9yTWVzc2FnZS5pbmNsdWRlcygnZmV0Y2ggZmFpbGVkJykgfHwgZXJyb3JNZXNzYWdlLmluY2x1ZGVzKCdFQ09OTlJFRlVTRUQnKSkge1xuICAgICAgY29uc29sZS5lcnJvcihgW1Byb3h5XSBDb25uZWN0aW9uIGZhaWxlZCB0byAke3VybH0gLSBzZXJ2aWNlIG1heSBub3QgYmUgcnVubmluZ2ApO1xuICAgICAgcmV0dXJuIG5ldyBOZXh0UmVzcG9uc2UoSlNPTi5zdHJpbmdpZnkoeyBcbiAgICAgICAgZXJyb3I6ICdCYWNrZW5kIHNlcnZpY2UgdW5hdmFpbGFibGUnLCBcbiAgICAgICAgZGV0YWlsczogYENhbm5vdCBjb25uZWN0IHRvICR7dXJsfS4gUGxlYXNlIGVuc3VyZSB0aGUgYmFja2VuZCBzZXJ2aWNlIGlzIHJ1bm5pbmcuYCxcbiAgICAgICAgb3JpZ2luYWxFcnJvcjogZXJyb3JNZXNzYWdlXG4gICAgICB9KSwgeyBcbiAgICAgICAgc3RhdHVzOiA1MDMsIFxuICAgICAgICBoZWFkZXJzOiB7ICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicgfVxuICAgICAgfSk7XG4gICAgfVxuICAgIFxuICAgIHJldHVybiBuZXcgTmV4dFJlc3BvbnNlKEpTT04uc3RyaW5naWZ5KHsgZXJyb3I6ICdQcm94eSByZXF1ZXN0IGZhaWxlZCcsIGRldGFpbHM6IGVycm9yTWVzc2FnZSB9KSwgeyBcbiAgICAgIHN0YXR1czogNTAyLCBcbiAgICAgIGhlYWRlcnM6IHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyB9XG4gICAgfSk7XG4gIH1cbn1cblxuZXhwb3J0IGNvbnN0IEdFVCA9IGZvcndhcmQ7XG5leHBvcnQgY29uc3QgUE9TVCA9IGZvcndhcmQ7XG5leHBvcnQgY29uc3QgUFVUID0gZm9yd2FyZDtcbmV4cG9ydCBjb25zdCBQQVRDSCA9IGZvcndhcmQ7XG5leHBvcnQgY29uc3QgREVMRVRFID0gZm9yd2FyZDtcbmV4cG9ydCBjb25zdCBPUFRJT05TID0gZm9yd2FyZDtcblxuXG4iXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwiZ2V0VG9rZW4iLCJnZXRUb2tlblNlc3Npb24iLCJERUZBVUxUX1RBUkdFVCIsInByb2Nlc3MiLCJlbnYiLCJQUk9YWV9UQVJHRVQiLCJNRVNTQUdJTkdfVEFSR0VUIiwiUFJPWFlfVEFSR0VUX01FU1NBR0lORyIsIlBST0pFQ1RJT05TX1RBUkdFVCIsIlBST1hZX1RBUkdFVF9QUk9KRUNUSU9OUyIsIk9OQk9BUkRJTkdfVEFSR0VUIiwiUFJPWFlfVEFSR0VUX09OQk9BUkRJTkciLCJET0NVTUVOVF9UQVJHRVQiLCJQUk9YWV9UQVJHRVRfRE9DVU1FTlQiLCJBVVRIX1RBUkdFVCIsIlBST1hZX1RBUkdFVF9BVVRIIiwicmVzb2x2ZVVwc3RyZWFtIiwicGF0aG5hbWUiLCJzZWFyY2giLCJhZnRlclByb3h5Iiwic3BsaXQiLCJzdGFydHNXaXRoIiwidHJpbW1lZCIsInJlcGxhY2UiLCJmb3J3YXJkIiwicmVxIiwidXJsIiwibmV4dFVybCIsImluY2x1ZGVzIiwiY29uc29sZSIsImxvZyIsImhlYWRlcnMiLCJhY2Nlc3NUb2tlbiIsInRva2VuIiwic2VjcmV0IiwiTkVYVEFVVEhfU0VDUkVUIiwic2Vzc2lvbklkIiwidG9rZW5TZXNzaW9uIiwiYWNjZXNzVG9rZW5FeHBpcnlUaW1lIiwiRGF0ZSIsIm5vdyIsImVycm9yIiwid2FybiIsImNvbnRlbnRUeXBlIiwiZ2V0IiwidXNlckhlYWRlcnMiLCJoZWFkZXJOYW1lIiwidmFsdWUiLCJ0b0xvd2VyQ2FzZSIsInNjaGVtYUhlYWRlcnMiLCJib2R5IiwibWV0aG9kIiwidW5kZWZpbmVkIiwiZm9ybURhdGEiLCJ0ZXh0IiwiaW5pdCIsInJlZGlyZWN0IiwicmVzIiwiZmV0Y2giLCJhcnJheUJ1ZmZlciIsInJlc3BIZWFkZXJzIiwiSGVhZGVycyIsImZvckVhY2giLCJ2IiwiayIsInNldCIsInN0YXR1cyIsImVycm9yTWVzc2FnZSIsIkVycm9yIiwibWVzc2FnZSIsIkpTT04iLCJzdHJpbmdpZnkiLCJkZXRhaWxzIiwib3JpZ2luYWxFcnJvciIsIkdFVCIsIlBPU1QiLCJQVVQiLCJQQVRDSCIsIkRFTEVURSIsIk9QVElPTlMiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/proxy/[...path]/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/redis-session.ts":
/*!**********************************!*\
  !*** ./src/lib/redis-session.ts ***!
  \**********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   deleteTokenSession: () => (/* binding */ deleteTokenSession),\n/* harmony export */   getRedisClient: () => (/* binding */ getRedisClient),\n/* harmony export */   getTokenSession: () => (/* binding */ getTokenSession),\n/* harmony export */   storeTokenSession: () => (/* binding */ storeTokenSession),\n/* harmony export */   updateAccessToken: () => (/* binding */ updateAccessToken)\n/* harmony export */ });\n/* harmony import */ var redis__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! redis */ \"(rsc)/./node_modules/redis/dist/index.js\");\n/* harmony import */ var redis__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(redis__WEBPACK_IMPORTED_MODULE_0__);\n\n// Redis client singleton\nlet redisClient = null;\nasync function getRedisClient() {\n    if (redisClient && redisClient.isOpen) {\n        return redisClient;\n    }\n    const redisUrl = process.env.REDIS_URL || \"redis://localhost:6379\";\n    redisClient = (0,redis__WEBPACK_IMPORTED_MODULE_0__.createClient)({\n        url: redisUrl\n    });\n    redisClient.on(\"error\", (err)=>console.error(\"Redis Client Error\", err));\n    redisClient.on(\"connect\", ()=>console.log(\"Redis Client Connected\"));\n    if (!redisClient.isOpen) {\n        await redisClient.connect();\n    }\n    return redisClient;\n}\nconst SESSION_PREFIX = \"session:\";\nconst TTL_SECONDS = 7 * 24 * 60 * 60; // 7 days\n/**\n * Store IdP tokens in Redis, keyed by session ID\n */ async function storeTokenSession(sessionId, tokens) {\n    try {\n        const client = await getRedisClient();\n        const key = `${SESSION_PREFIX}${sessionId}`;\n        await client.setEx(key, TTL_SECONDS, JSON.stringify(tokens));\n        console.log(`[Redis] Stored token session: ${key}`);\n    } catch (error) {\n        console.error(\"[Redis] Failed to store token session:\", error);\n        throw error; // Re-throw so caller knows it failed\n    }\n}\n/**\n * Retrieve IdP tokens from Redis by session ID\n */ async function getTokenSession(sessionId) {\n    try {\n        const client = await getRedisClient();\n        const key = `${SESSION_PREFIX}${sessionId}`;\n        const data = await client.get(key);\n        if (!data) return null;\n        return JSON.parse(data);\n    } catch (error) {\n        console.error(\"[Redis] Failed to get token session:\", error);\n        return null; // Return null instead of throwing\n    }\n}\n/**\n * Delete token session from Redis\n */ async function deleteTokenSession(sessionId) {\n    const client = await getRedisClient();\n    const key = `${SESSION_PREFIX}${sessionId}`;\n    await client.del(key);\n}\n/**\n * Update access token (for refresh scenarios)\n */ async function updateAccessToken(sessionId, accessToken, accessTokenExpiryTime) {\n    const session = await getTokenSession(sessionId);\n    if (!session) {\n        throw new Error(\"Session not found\");\n    }\n    await storeTokenSession(sessionId, {\n        ...session,\n        accessToken,\n        accessTokenExpiryTime\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3JlZGlzLXNlc3Npb24udHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQUFxQztBQUVyQyx5QkFBeUI7QUFDekIsSUFBSUMsY0FBc0Q7QUFFbkQsZUFBZUM7SUFDcEIsSUFBSUQsZUFBZUEsWUFBWUUsTUFBTSxFQUFFO1FBQ3JDLE9BQU9GO0lBQ1Q7SUFFQSxNQUFNRyxXQUFXQyxRQUFRQyxHQUFHLENBQUNDLFNBQVMsSUFBSTtJQUMxQ04sY0FBY0QsbURBQVlBLENBQUM7UUFBRVEsS0FBS0o7SUFBUztJQUUzQ0gsWUFBWVEsRUFBRSxDQUFDLFNBQVMsQ0FBQ0MsTUFBUUMsUUFBUUMsS0FBSyxDQUFDLHNCQUFzQkY7SUFDckVULFlBQVlRLEVBQUUsQ0FBQyxXQUFXLElBQU1FLFFBQVFFLEdBQUcsQ0FBQztJQUU1QyxJQUFJLENBQUNaLFlBQVlFLE1BQU0sRUFBRTtRQUN2QixNQUFNRixZQUFZYSxPQUFPO0lBQzNCO0lBRUEsT0FBT2I7QUFDVDtBQVdBLE1BQU1jLGlCQUFpQjtBQUN2QixNQUFNQyxjQUFjLElBQUksS0FBSyxLQUFLLElBQUksU0FBUztBQUUvQzs7Q0FFQyxHQUNNLGVBQWVDLGtCQUNwQkMsU0FBaUIsRUFDakJDLE1BQW9CO0lBRXBCLElBQUk7UUFDRixNQUFNQyxTQUFTLE1BQU1sQjtRQUNyQixNQUFNbUIsTUFBTSxDQUFDLEVBQUVOLGVBQWUsRUFBRUcsVUFBVSxDQUFDO1FBQzNDLE1BQU1FLE9BQU9FLEtBQUssQ0FBQ0QsS0FBS0wsYUFBYU8sS0FBS0MsU0FBUyxDQUFDTDtRQUNwRFIsUUFBUUUsR0FBRyxDQUFDLENBQUMsOEJBQThCLEVBQUVRLElBQUksQ0FBQztJQUNwRCxFQUFFLE9BQU9ULE9BQU87UUFDZEQsUUFBUUMsS0FBSyxDQUFDLDBDQUEwQ0E7UUFDeEQsTUFBTUEsT0FBTyxxQ0FBcUM7SUFDcEQ7QUFDRjtBQUVBOztDQUVDLEdBQ00sZUFBZWEsZ0JBQ3BCUCxTQUFpQjtJQUVqQixJQUFJO1FBQ0YsTUFBTUUsU0FBUyxNQUFNbEI7UUFDckIsTUFBTW1CLE1BQU0sQ0FBQyxFQUFFTixlQUFlLEVBQUVHLFVBQVUsQ0FBQztRQUMzQyxNQUFNUSxPQUFPLE1BQU1OLE9BQU9PLEdBQUcsQ0FBQ047UUFDOUIsSUFBSSxDQUFDSyxNQUFNLE9BQU87UUFDbEIsT0FBT0gsS0FBS0ssS0FBSyxDQUFDRjtJQUNwQixFQUFFLE9BQU9kLE9BQU87UUFDZEQsUUFBUUMsS0FBSyxDQUFDLHdDQUF3Q0E7UUFDdEQsT0FBTyxNQUFNLGtDQUFrQztJQUNqRDtBQUNGO0FBRUE7O0NBRUMsR0FDTSxlQUFlaUIsbUJBQW1CWCxTQUFpQjtJQUN4RCxNQUFNRSxTQUFTLE1BQU1sQjtJQUNyQixNQUFNbUIsTUFBTSxDQUFDLEVBQUVOLGVBQWUsRUFBRUcsVUFBVSxDQUFDO0lBQzNDLE1BQU1FLE9BQU9VLEdBQUcsQ0FBQ1Q7QUFDbkI7QUFFQTs7Q0FFQyxHQUNNLGVBQWVVLGtCQUNwQmIsU0FBaUIsRUFDakJjLFdBQW1CLEVBQ25CQyxxQkFBNkI7SUFFN0IsTUFBTUMsVUFBVSxNQUFNVCxnQkFBZ0JQO0lBQ3RDLElBQUksQ0FBQ2dCLFNBQVM7UUFDWixNQUFNLElBQUlDLE1BQU07SUFDbEI7SUFDQSxNQUFNbEIsa0JBQWtCQyxXQUFXO1FBQ2pDLEdBQUdnQixPQUFPO1FBQ1ZGO1FBQ0FDO0lBQ0Y7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL211a3VydS1hcHAvLi9zcmMvbGliL3JlZGlzLXNlc3Npb24udHM/M2EzYyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjcmVhdGVDbGllbnQgfSBmcm9tICdyZWRpcyc7XG5cbi8vIFJlZGlzIGNsaWVudCBzaW5nbGV0b25cbmxldCByZWRpc0NsaWVudDogUmV0dXJuVHlwZTx0eXBlb2YgY3JlYXRlQ2xpZW50PiB8IG51bGwgPSBudWxsO1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0UmVkaXNDbGllbnQoKSB7XG4gIGlmIChyZWRpc0NsaWVudCAmJiByZWRpc0NsaWVudC5pc09wZW4pIHtcbiAgICByZXR1cm4gcmVkaXNDbGllbnQ7XG4gIH1cblxuICBjb25zdCByZWRpc1VybCA9IHByb2Nlc3MuZW52LlJFRElTX1VSTCB8fCAncmVkaXM6Ly9sb2NhbGhvc3Q6NjM3OSc7XG4gIHJlZGlzQ2xpZW50ID0gY3JlYXRlQ2xpZW50KHsgdXJsOiByZWRpc1VybCB9KTtcblxuICByZWRpc0NsaWVudC5vbignZXJyb3InLCAoZXJyKSA9PiBjb25zb2xlLmVycm9yKCdSZWRpcyBDbGllbnQgRXJyb3InLCBlcnIpKTtcbiAgcmVkaXNDbGllbnQub24oJ2Nvbm5lY3QnLCAoKSA9PiBjb25zb2xlLmxvZygnUmVkaXMgQ2xpZW50IENvbm5lY3RlZCcpKTtcblxuICBpZiAoIXJlZGlzQ2xpZW50LmlzT3Blbikge1xuICAgIGF3YWl0IHJlZGlzQ2xpZW50LmNvbm5lY3QoKTtcbiAgfVxuXG4gIHJldHVybiByZWRpc0NsaWVudDtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBUb2tlblNlc3Npb24ge1xuICBhY2Nlc3NUb2tlbjogc3RyaW5nO1xuICByZWZyZXNoVG9rZW46IHN0cmluZztcbiAgYWNjZXNzVG9rZW5FeHBpcnlUaW1lOiBudW1iZXI7XG4gIHByb3ZpZGVyOiAnYXp1cmUtYWQnIHwgJ2tleWNsb2FrJztcbiAgdXNlckVtYWlsPzogc3RyaW5nO1xuICB1c2VySWQ/OiBzdHJpbmc7XG59XG5cbmNvbnN0IFNFU1NJT05fUFJFRklYID0gJ3Nlc3Npb246JztcbmNvbnN0IFRUTF9TRUNPTkRTID0gNyAqIDI0ICogNjAgKiA2MDsgLy8gNyBkYXlzXG5cbi8qKlxuICogU3RvcmUgSWRQIHRva2VucyBpbiBSZWRpcywga2V5ZWQgYnkgc2Vzc2lvbiBJRFxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc3RvcmVUb2tlblNlc3Npb24oXG4gIHNlc3Npb25JZDogc3RyaW5nLFxuICB0b2tlbnM6IFRva2VuU2Vzc2lvblxuKTogUHJvbWlzZTx2b2lkPiB7XG4gIHRyeSB7XG4gICAgY29uc3QgY2xpZW50ID0gYXdhaXQgZ2V0UmVkaXNDbGllbnQoKTtcbiAgICBjb25zdCBrZXkgPSBgJHtTRVNTSU9OX1BSRUZJWH0ke3Nlc3Npb25JZH1gO1xuICAgIGF3YWl0IGNsaWVudC5zZXRFeChrZXksIFRUTF9TRUNPTkRTLCBKU09OLnN0cmluZ2lmeSh0b2tlbnMpKTtcbiAgICBjb25zb2xlLmxvZyhgW1JlZGlzXSBTdG9yZWQgdG9rZW4gc2Vzc2lvbjogJHtrZXl9YCk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignW1JlZGlzXSBGYWlsZWQgdG8gc3RvcmUgdG9rZW4gc2Vzc2lvbjonLCBlcnJvcik7XG4gICAgdGhyb3cgZXJyb3I7IC8vIFJlLXRocm93IHNvIGNhbGxlciBrbm93cyBpdCBmYWlsZWRcbiAgfVxufVxuXG4vKipcbiAqIFJldHJpZXZlIElkUCB0b2tlbnMgZnJvbSBSZWRpcyBieSBzZXNzaW9uIElEXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRUb2tlblNlc3Npb24oXG4gIHNlc3Npb25JZDogc3RyaW5nXG4pOiBQcm9taXNlPFRva2VuU2Vzc2lvbiB8IG51bGw+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCBjbGllbnQgPSBhd2FpdCBnZXRSZWRpc0NsaWVudCgpO1xuICAgIGNvbnN0IGtleSA9IGAke1NFU1NJT05fUFJFRklYfSR7c2Vzc2lvbklkfWA7XG4gICAgY29uc3QgZGF0YSA9IGF3YWl0IGNsaWVudC5nZXQoa2V5KTtcbiAgICBpZiAoIWRhdGEpIHJldHVybiBudWxsO1xuICAgIHJldHVybiBKU09OLnBhcnNlKGRhdGEpIGFzIFRva2VuU2Vzc2lvbjtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdbUmVkaXNdIEZhaWxlZCB0byBnZXQgdG9rZW4gc2Vzc2lvbjonLCBlcnJvcik7XG4gICAgcmV0dXJuIG51bGw7IC8vIFJldHVybiBudWxsIGluc3RlYWQgb2YgdGhyb3dpbmdcbiAgfVxufVxuXG4vKipcbiAqIERlbGV0ZSB0b2tlbiBzZXNzaW9uIGZyb20gUmVkaXNcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZVRva2VuU2Vzc2lvbihzZXNzaW9uSWQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICBjb25zdCBjbGllbnQgPSBhd2FpdCBnZXRSZWRpc0NsaWVudCgpO1xuICBjb25zdCBrZXkgPSBgJHtTRVNTSU9OX1BSRUZJWH0ke3Nlc3Npb25JZH1gO1xuICBhd2FpdCBjbGllbnQuZGVsKGtleSk7XG59XG5cbi8qKlxuICogVXBkYXRlIGFjY2VzcyB0b2tlbiAoZm9yIHJlZnJlc2ggc2NlbmFyaW9zKVxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlQWNjZXNzVG9rZW4oXG4gIHNlc3Npb25JZDogc3RyaW5nLFxuICBhY2Nlc3NUb2tlbjogc3RyaW5nLFxuICBhY2Nlc3NUb2tlbkV4cGlyeVRpbWU6IG51bWJlclxuKTogUHJvbWlzZTx2b2lkPiB7XG4gIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBnZXRUb2tlblNlc3Npb24oc2Vzc2lvbklkKTtcbiAgaWYgKCFzZXNzaW9uKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdTZXNzaW9uIG5vdCBmb3VuZCcpO1xuICB9XG4gIGF3YWl0IHN0b3JlVG9rZW5TZXNzaW9uKHNlc3Npb25JZCwge1xuICAgIC4uLnNlc3Npb24sXG4gICAgYWNjZXNzVG9rZW4sXG4gICAgYWNjZXNzVG9rZW5FeHBpcnlUaW1lLFxuICB9KTtcbn1cblxuIl0sIm5hbWVzIjpbImNyZWF0ZUNsaWVudCIsInJlZGlzQ2xpZW50IiwiZ2V0UmVkaXNDbGllbnQiLCJpc09wZW4iLCJyZWRpc1VybCIsInByb2Nlc3MiLCJlbnYiLCJSRURJU19VUkwiLCJ1cmwiLCJvbiIsImVyciIsImNvbnNvbGUiLCJlcnJvciIsImxvZyIsImNvbm5lY3QiLCJTRVNTSU9OX1BSRUZJWCIsIlRUTF9TRUNPTkRTIiwic3RvcmVUb2tlblNlc3Npb24iLCJzZXNzaW9uSWQiLCJ0b2tlbnMiLCJjbGllbnQiLCJrZXkiLCJzZXRFeCIsIkpTT04iLCJzdHJpbmdpZnkiLCJnZXRUb2tlblNlc3Npb24iLCJkYXRhIiwiZ2V0IiwicGFyc2UiLCJkZWxldGVUb2tlblNlc3Npb24iLCJkZWwiLCJ1cGRhdGVBY2Nlc3NUb2tlbiIsImFjY2Vzc1Rva2VuIiwiYWNjZXNzVG9rZW5FeHBpcnlUaW1lIiwic2Vzc2lvbiIsIkVycm9yIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/redis-session.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/next-auth","vendor-chunks/@babel","vendor-chunks/@redis","vendor-chunks/jose","vendor-chunks/uuid","vendor-chunks/cluster-key-slot","vendor-chunks/@panva","vendor-chunks/redis"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fproxy%2F%5B...path%5D%2Froute&page=%2Fapi%2Fproxy%2F%5B...path%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fproxy%2F%5B...path%5D%2Froute.ts&appDir=%2FUsers%2Fmukurusystemsadministrator%2FDesktop%2Fonboarding_kyc%20copy%2Fpartner%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fmukurusystemsadministrator%2FDesktop%2Fonboarding_kyc%20copy%2Fpartner&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();